<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maverlang - Noticias IA en Tiempo Real</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

<style>
        :root {
            --bg-light: #f4f4f5; --text-light: #18181b; --border-light: #e4e4e7;
            --bg-dark: #0A0A0A; --text-dark: #f9fafb; --border-dark: #27272a;
            /* --bg-stars: #000000; (ELIMINADO) */
            --accent-blue: #3b82f6;
            --accent-red: #ef4444;
            --success-color: #22c55e;
            --success-glow: rgba(34, 197, 94, 0.4);
            --warning-color: #f59e0b;
            --bg-active-theme-light: #e4e4e7;
            --bg-active-theme-dark: #27272a;
            --particle-color-1: rgba(59, 130, 246, 0.9);
            --particle-color-2: rgba(96, 165, 250, 0.7);
            --particle-color-3: rgba(255, 255, 255, 0.8);
            --accent-indigo: #6366f1; /* Color para esta página */
            --accent-blue-rgb: 59, 130, 246; /* RGB para opacidad */

            /* (NUEVO) Asignar color de acento de la página */
            --accent-color: var(--accent-indigo);
            --accent-color-rgb: 99, 102, 241;
        }
        html.dark {
            --bg-main: var(--bg-dark); --text-main: var(--text-dark); --border-main: var(--border-dark);
            --success-glow: rgba(34, 197, 94, 0.5);
        }
        html:not(.dark) {
            --bg-main: var(--bg-light); --text-main: var(--text-light); --border-main: var(--border-light);
        }
        /* html.stars-theme { ... } (ELIMINADO) */

        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow-y: auto;
        }
        section.hero-section {
            padding-bottom: 4rem;
            position: relative;
            z-index: 10;
        }

        /* #starfield { ... } (ELIMINADO) */

        .background-logo-text {
            font-size: clamp(8rem, 25vw, 22rem); font-weight: 800; letter-spacing: -0.05em;
            color: rgba(120, 120, 120, 0.05); position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); z-index: 1; pointer-events: none;
        }

        .countdown-box, .form-container, .llm-card-small {
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 1rem;
        }
        html.dark .countdown-box, html.dark .form-container, html.dark .llm-card-small {
            background: rgba(30, 30, 30, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html:not(.dark) .countdown-box, html:not(.dark) .form-container, html:not(.dark) .llm-card-small {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--border-light);
        }

        .theme-main-btn, .theme-dropdown-btn {
            padding: 0.5rem;
            border-radius: 9999px;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex; align-items: center; justify-content: center;
        }
        .theme-main-btn i, .theme-dropdown-btn i { width: 1.25rem; height: 1.25rem; }
        .theme-main-btn:hover, .theme-dropdown-btn:hover { background-color: rgba(120, 120, 120, 0.1); }
        .theme-dropdown-btn.active { background-color: var(--bg-active-theme-light); color: var(--text-main); }
        html.dark .theme-dropdown-btn.active { background-color: var(--bg-active-theme-dark); }

        .countdown-number { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 600; line-height: 1; color: var(--text-main); }
        .countdown-label { font-size: 0.65rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-main); opacity: 0.6; }

        #fomo-counter { font-size: 1rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: -1rem; opacity: 0; transition: opacity 0.5s ease; }
        #fomo-counter.visible { opacity: 1; }
        #whitelist-count { display: inline-block; color: var(--accent-blue); font-weight: 700; padding: 0 0.25rem; min-width: 1em; }

        .modal-content, .feature-card {
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 1rem;
        }
        html.dark .modal-content, html.dark .feature-card {
            background: rgba(30, 30, 30, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html:not(.dark) .modal-content, html:not(.dark) .feature-card {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--border-light);
        }

        #whitelist-modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        #whitelist-modal .modal-content { transition: transform 0.3s ease; }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 12px rgba(var(--accent-color-rgb), 0.4); transform: scale(1); }
            50% { box-shadow: 0 0 20px rgba(var(--accent-color-rgb), 0.8); transform: scale(1.03); }
        }
        .animated-whitelist-btn { 
            animation: pulse-glow 2.5s infinite ease-in-out;
            background-color: var(--accent-color); /* (NUEVO) Usa el acento de la página */
        }
        /* (NUEVO) Botón del header mantiene el azul */
        #header-whitelist-btn {
            background-color: var(--accent-blue);
            animation: none;
            box-shadow: none;
        }
        #header-whitelist-btn:hover { background-color: #2563eb; }


        .nav-dropdown-menu, .theme-dropdown-menu { position: absolute; top: calc(100% + 1rem); left: 0; width: 220px; padding: 0.5rem; border-radius: 1rem; z-index: 100; transition: all 0.2s ease-out; transform-origin: top left; background-color: var(--bg-main); }
        .theme-dropdown-menu { width: auto; min-width: 50px; left: auto; right: 0; transform-origin: top right; display: flex; flex-direction: column; gap: 0.25rem; }
        html.dark .nav-dropdown-menu, html.dark .theme-dropdown-menu { border: 1px solid var(--border-dark); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        html:not(.dark) .nav-dropdown-menu, html:not(.dark) .theme-dropdown-menu { border: 1px solid var(--border-light); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .nav-dropdown-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.75rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.5rem; transition: background-color 0.2s ease; cursor: pointer; }
        .nav-dropdown-item:hover { background-color: rgba(120,120,120,0.1); }
        .nav-dropdown-item i { opacity: 0.7; }

        #nav-portafolio-ai-link { position: relative; overflow: visible; padding: 0.25rem 0.5rem; cursor: pointer; }
        #nav-portafolio-ai-link span { position: relative; z-index: 1; display: inline-block; animation: text-color-slow-pulse 5s ease-in-out infinite; }
        .particles-container { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
        .particle { position: absolute; bottom: 2px; left: 50%; width: 3px; height: 3px; border-radius: 50%; opacity: 0; animation: particle-fall 2.5s ease-out infinite; animation-delay: calc(var(--particle-delay) * 1s); background-color: var(--particle-color); }
        @keyframes text-color-slow-pulse { 0%, 100% { color: inherit; } 40% { color: var(--accent-blue); } 60% { color: var(--accent-blue); } }
        @keyframes particle-fall { 0% { opacity: 0; transform: translate(-50%, 0) scale(0.3); } 50% { opacity: 1; transform: translate(calc(-50% + var(--particle-x)), calc(var(--particle-y) - 5px)) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + var(--particle-x) * 1.2), calc(var(--particle-y) - 15px)) scale(0); } }

        /* == INICIO: ESTILOS PARA MOCKUP DE NOTICIAS == */
        
        .news-feed-container {
            height: 350px; 
            max-width: 768px; 
            margin: 2.5rem auto 0 auto;
            border: 1px solid var(--border-main);
            background-color: var(--bg-main);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
        }
        .news-feed-track {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            animation: scroll-vertical 60s linear infinite; 
        }
        .news-feed-container:hover .news-feed-track {
             animation-play-state: paused;
        }

        @keyframes scroll-vertical {
            0% { transform: translateY(0); }
            100% { transform: translateY(-50%); } 
        }
        
        .news-card-mockup {
            padding: 1rem;
            border: 1px solid var(--border-main);
            background-color: var(--bg-secondary);
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        html.dark .news-card-mockup {
             background-color: rgba(30, 30, 30, 0.7);
             border-color: rgba(255, 255, 255, 0.1);
        }

        .news-card-mockup h3 {
            font-size: 1.125rem; 
            font-weight: 600;
            line-height: 1.4;
            color: var(--text-primary);
        }
        .news-card-footer {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem; 
            color: var(--text-secondary);
        }
        .news-source { font-weight: 500; }
        
        .news-sentiment-tag {
             display: inline-flex;
             align-items: center;
             padding: 0.2rem 0.6rem;
             border-radius: 99px;
             font-size: 0.75rem; /* text-xs */
             font-weight: 600;
         }
         .news-sentiment-positive { background-color: rgba(34, 197, 94, 0.1); color: var(--success-color); }
         .news-sentiment-negative { background-color: rgba(239, 68, 68, 0.1); color: var(--accent-red); }
         .news-sentiment-neutral { background-color: rgba(107, 114, 128, 0.1); color: #6b7280; }
         html.dark .news-sentiment-neutral { color: #9ca3af; }

         .news-entity-tag {
             display: inline-block;
             background-color: rgba(59, 130, 246, 0.1);
             color: var(--accent-blue);
             padding: 0.2rem 0.6rem;
             border-radius: 99px;
             font-size: 0.75rem; /* text-xs */
             font-weight: 600;
         }
         html:not(.dark) .news-entity-tag { color: #2563eb; }
         
         .news-feed-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to top, var(--bg-main) 30%, transparent 100%);
            pointer-events: none;
         }

        .feature-grid-card {
            display: flex; flex-direction: column;
            gap: 0.75rem;
            padding: 1.5rem;
            height: 100%;
        }
        .feature-grid-card .icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px; height: 48px;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
        }
        .icon-alert { background-color: rgba(239, 68, 68, 0.1); color: var(--accent-red); }
        .icon-sentiment { background-color: rgba(34, 197, 94, 0.1); color: var(--success-color); }
        .icon-entity { background-color: rgba(59, 130, 246, 0.1); color: var(--accent-blue); }
        .icon-sources { background-color: rgba(139, 92, 246, 0.1); color: #8b5cf6; }
        .icon-focus { background-color: rgba(234, 179, 8, 0.1); color: var(--warning-color); }
        .icon-connect { background-color: rgba(20, 184, 166, 0.1); color: #0d9488; }
        
        .mockup-alert-input {
            display: flex; gap: 0.5rem;
            margin-top: 1rem;
        }
         .mockup-alert-input input {
            flex-grow: 1;
            font-size: 0.875rem;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            background-color: var(--bg-main);
            border: 1px solid var(--border-main);
            opacity: 0.7;
         }
         .mockup-alert-input button {
             padding: 0.5rem;
             border-radius: 0.375rem;
             background-color: var(--accent-red);
             color: white;
         }
         
         .mockup-source-list {
             display: flex;
             flex-direction: column;
             gap: 0.5rem;
             margin-top: 1rem;
             font-size: 0.875rem;
             opacity: 0.9;
         }
         .mockup-source-item {
             display: flex;
             align-items: center;
             gap: 0.75rem; /* Más espacio */
         }
         .mockup-source-item i { width: 1rem; height: 1rem; flex-shrink: 0; }

        /* == FIN: ESTILOS PARA MOCKUP DE NOTICIAS == */
        
        /* ================================================================== */
        /* == INICIO: ESTILOS PARA DEMO INTERACTIVA DE NOTICIAS == */
        /* ================================================================== */
         .interactive-news-card {
             display: flex;
             gap: 0.75rem;
             padding: 0.75rem;
             border-radius: 0.75rem;
             border: 2px solid transparent;
             transition: all 0.2s ease;
             cursor: pointer;
         }
         .interactive-news-card:hover {
             background-color: rgba(120, 120, 120, 0.05);
             border-color: var(--border-main);
         }
         .interactive-news-card.active {
             background-color: rgba(59, 130, 246, 0.1);
             border-color: var(--accent-blue);
         }
         .interactive-news-card img {
             width: 80px;
             height: 60px;
             object-fit: cover; /* Corrección */
             border-radius: 0.5rem;
             flex-shrink: 0;
             transition: all 0.3s; /* Transición para ocultar */
         }
         .interactive-news-card h4 {
             font-size: 0.9rem;
             font-weight: 600;
             line-height: 1.4;
             margin-bottom: 0.25rem;
         }
         .interactive-news-card .footer {
             font-size: 0.75rem;
             display: flex;
             justify-content: space-between;
             opacity: 0.7;
         }

         #news-list-column {
             height: 500px;
             overflow-y: auto;
             padding-right: 0.5rem; /* Espacio para scrollbar */
         }
         /* Scrollbar personalizado */
        #news-list-column::-webkit-scrollbar { width: 6px; }
        #news-list-column::-webkit-scrollbar-track { background: transparent; }
        #news-list-column::-webkit-scrollbar-thumb { background-color: var(--border-main); border-radius: 3px; }
        html.dark #news-list-column::-webkit-scrollbar-thumb { background-color: var(--border-dark); }
         
         #news-detail-column {
             height: 500px;
             overflow-y: auto;
         }
         
         /* (NUEVO) Estilo para ocultar imágenes */
         .images-hidden .interactive-news-card img,
         .images-hidden #detail-image,
         .images-hidden #focus-image {
             display: none;
         }
         /* (NUEVO) Ajuste para cuando la imagen está oculta */
         .images-hidden .interactive-news-card {
             gap: 0.25rem;
         }

        /* (NUEVO) Estilos para el toggle de ocultar imágenes */
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 22px; }
        .toggle-slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: var(--accent-blue); }
        input:checked + .toggle-slider:before { transform: translateX(18px); }
        html.dark .toggle-slider { background-color: #4b5563; }
         
         /* Estilo Focus Mode */
         #focus-mode-view {
             position: fixed;
             top: 0; left: 0; right: 0; bottom: 0;
             background-color: var(--bg-main);
             color: var(--text-main); /* Heredar color de texto */
             z-index: 100;
             display: flex;
             flex-direction: column;
             opacity: 0;
             visibility: hidden;
             transition: opacity 0.3s ease;
         }
         /* (NUEVO) Aplicar tema oscuro a focus view */
         #focus-mode-view.dark {
             --bg-main: var(--bg-dark);
             --text-main: var(--text-dark);
             --border-main: var(--border-dark);
             background-color: var(--bg-dark);
             color: var(--text-dark);
         }
         /* (ELIMINADO) .stars-theme de focus-mode-view */

          #focus-mode-view.visible {
              opacity: 1;
              visibility: visible;
          }
         .focus-nav-btn {
             position: absolute;
             top: 50%;
             transform: translateY(-50%);
             background-color: rgba(0,0,0,0.3);
             color: white;
             border-radius: 50%;
             width: 44px;
             height: 44px;
             display: flex;
             align-items: center;
             justify-content: center;
             z-index: 110;
             opacity: 0.7;
             transition: opacity 0.2s;
         }
         .focus-nav-btn:hover { opacity: 1; }
         .focus-nav-btn:disabled { opacity: 0.2; cursor: default; }
         
         #focus-header {
             position: absolute;
             top: 0; left: 0; right: 0;
             padding: 1rem;
             display: flex;
             justify-content: space-between;
             align-items: center;
             z-index: 10;
             background: linear-gradient(to bottom, rgba(0,0,0,0.4), transparent);
         }
         
         #focus-content-container {
             flex-grow: 1;
             overflow-y: auto;
             padding: 6rem 1rem 4rem 1rem; /* Más padding superior para header */
         }
         .focus-content {
             max-width: 800px;
             margin: 0 auto;
         }
         .focus-content img {
             width: 100%;
             height: auto;
             max-height: 400px;
             object-fit: cover; /* Corrección */
             border-radius: 0.75rem;
             margin-bottom: 1.5rem;
         }
         .focus-content h1 {
             font-size: 2.25rem; /* text-3xl */
             font-weight: 800;
             line-height: 1.2;
             margin-bottom: 0.75rem;
         }
         .focus-content .meta-info {
             display: flex;
             flex-wrap: wrap;
             align-items: center;
             gap: 1rem;
             font-size: 0.875rem; /* text-sm */
             opacity: 0.8;
             margin-bottom: 1.5rem;
             padding-bottom: 1.5rem;
             border-bottom: 1px solid var(--border-main);
         }
         .focus-content .prose-content {
             font-size: 1.125rem; /* text-lg */
             line-height: 1.7;
             opacity: 0.9;
         }
         .prose-content p { margin-bottom: 1.25rem; }
         
         /* (NUEVO) Estilo para el bloque de Análisis IA */
         .ai-analysis-block {
             background-color: rgba(var(--accent-blue-rgb), 0.05);
             border: 1px solid rgba(var(--accent-blue-rgb), 0.1);
             border-left: 4px solid var(--accent-blue);
             border-radius: 0.5rem;
             padding: 1rem;
             margin-top: 1.5rem;
         }
         .ai-analysis-block h3 {
             font-size: 1.125rem; /* text-lg */
             font-weight: 700;
             display: flex;
             align-items: center;
             gap: 0.5rem;
             color: var(--text-primary);
             margin-bottom: 0.5rem;
         }
         .ai-analysis-block .prose-content {
             font-size: 1rem; /* text-base */
             line-height: 1.6;
             opacity: 0.9;
         }
         .ai-analysis-block .prose-content p {
             margin-bottom: 0.5rem;
         }
         /* Aplicar estilos de tema al bloque de análisis en focus mode */
         #focus-mode-view.dark .ai-analysis-block {
             background-color: rgba(var(--accent-blue-rgb), 0.1);
             border-color: rgba(var(--accent-blue-rgb), 0.2);
         }
         #focus-mode-view.dark .ai-analysis-block h3 {
             color: var(--text-primary);
         }

        /* ================================================================== */
        /* == FIN: ESTILOS PARA DEMO INTERACTIVA DE NOTICIAS == */
        /* ================================================================== */

        /* (NUEVO) ESTILOS PARA EL MENÚ MÓVIL */
        #mobile-menu-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-main);
            z-index: 100;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            padding-top: 5rem; /* Espacio para el header */
        }
        #mobile-menu-panel.open {
            transform: translateX(0);
        }
        .mobile-nav-link {
            font-size: 1.5rem; /* 24px */
            font-weight: 600;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s ease;
        }
        .mobile-nav-link:hover {
            background-color: rgba(120, 120, 120, 0.1);
        }
        .mobile-nav-link.active {
            color: var(--accent-color); /* (NUEVO) Usará el --accent-color (indigo) */
        }
        /* (FIN) ESTILOS PARA EL MENÚ MÓVIL */
</style>
</head>
<body class="overflow-y-auto">
    <!-- <canvas id="starfield"></canvas> (ELIMINADO) -->
    <div id="page-wrapper" class="overflow-x-hidden">
        <div id="main-content">

            <header class="fixed top-0 left-0 right-0 z-[60] p-4 transition-colors duration-300">
                 <div class="container mx-auto flex justify-between items-center bg-white/30 dark:bg-black/30 backdrop-blur-md p-3 rounded-full border border-white/10 shadow-sm">
                     <a href="index.html" class="text-xl font-bold tracking-wider ml-2 flex-shrink-0">MAVERLANG</a>
                     <div class="flex items-center gap-4 lg:gap-6 mx-4">
                         <!-- (CORREGIDO) Navegación oculta en móvil -->
                         <nav class="hidden md:flex items-center gap-4 lg:gap-6">
                             <a href="index.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Inicio</a> 
                             <!-- (CORREGIDO) Link de Noticias Activo con color índigo -->
                             <a href="noticias.html" class="font-bold text-sm text-indigo-500 transition-opacity">Noticias</a> 
                             <a href="mercados.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Mercados</a> 
                             <a href="portafolioAI.html" id="nav-portafolio-ai-link" class="font-semibold text-sm transition-opacity relative"> 
                                 <span>Portafolio AI</span> <div class="particles-container"></div>
                             </a>
                             <div class="relative" id="nav-funciones-dropdown">
                                 <button id="nav-funciones-btn" class="flex items-center gap-1 font-semibold text-sm hover:opacity-70 transition-opacity">
                                     <span>Funciones</span> <i data-lucide="chevron-down" class="w-4 h-4"></i>
                                 </button>
                                 <div id="nav-funciones-menu" class="nav-dropdown-menu invisible opacity-0 scale-95">
                                     <a href="seguimiento.html" class="nav-dropdown-item"><i data-lucide="activity" class="w-4 h-4"></i><span>Seguimiento</span></a> 
                                     <a href="aprendelo.html" class="nav-dropdown-item"><i data-lucide="book-open-check" class="w-4 h-4"></i><span>Apréndelo</span></a> 
                                     <!-- (CORREGIDO) Enlaces estandarizados -->
                                     <a href="portafolio.html" class_DEFAULT="nav-dropdown-item"><i data-lucide="briefcase" class="w-4 h-4"></i><span>Portafolio Virtual</span></a> 
                                     <a href="chats.html" class="nav-dropdown-item"><i data-lucide="message-square" class="w-4 h-4"></i><span>Chats</span></a> 
                                     <a href="mercados.html" class="nav-dropdown-item"><i data-lucide="line-chart" class="w-4 h-4"></i><span>Mercados</span></a> 
                                 </div>
                             </div>
                         </nav>
                         <!-- (CORREGIDO) Botón de acceso oculto en móvil -->
                         <button id="header-whitelist-btn" class="bg-blue-600 text-white font-semibold rounded-full px-4 py-2 text-sm transition-transform hover:scale-105 animated-whitelist-btn whitespace-nowrap hidden md:block">
                             Acceso Prioritario
                         </button>
                         <div class="relative" id="theme-selector">
                             <button id="theme-main-btn" class="theme-main-btn p-1.5 rounded-full border" style="border-color: var(--border-main);"><i data-lucide="sun"></i></button>
                             <div id="theme-dropdown-menu" class="theme-dropdown-menu invisible opacity-0 scale-95 p-1 border" style="border-color: var(--border-main);">
                                  <button data-theme="light" title="Tema Claro" class="theme-dropdown-btn"><i data-lucide="sun"></i></button>
                                  <button data-theme="dark" title="Tema Oscuro" class="theme-dropdown-btn"><i data-lucide="moon"></i></button>
                                  <!-- (ELIMINADO) Botón de tema estrellado -->
                             </div>
                         </div>
                         <!-- (NUEVO) Botón de Menú Móvil -->
                         <button id="mobile-menu-btn" class="p-1.5 rounded-full border md:hidden" style="border-color: var(--border-main);">
                             <i data-lucide="menu" class="w-6 h-6"></i>
                         </button>
                     </div>
                 </div>
            </header>

            <!-- (NUEVO) Panel de Menú Móvil -->
            <div id="mobile-menu-panel" class="z-[55]">
                <nav class="flex flex-col gap-2">
                    <a href="index.html" class="mobile-nav-link">Inicio</a>
                    <a href="noticias.html" class="mobile-nav-link active">Noticias</a>
                    <a href="mercados.html" class="mobile-nav-link">Mercados</a>
                    <a href="portafolioAI.html" class="mobile-nav-link">Portafolio AI</a>
                    <hr class="my-2" style="border-color: var(--border-main);" />
                    <a href="seguimiento.html" class="mobile-nav-link">Seguimiento</a>
                    <a href="aprendelo.html" class="mobile-nav-link">Apréndelo</a>
                    <a href="portafolio.html" class="mobile-nav-link">Portafolio Virtual</a>
                    <a href="chats.html" class="mobile-nav-link">Chats</a>
                </nav>
                <div class="mt-auto pt-6">
                    <button id="mobile-whitelist-btn" class="modal-trigger-btn w-full bg-blue-600 text-white font-semibold rounded-full px-6 py-4 text-lg transition-transform hover:scale-105 whitespace-nowrap">
                        Acceso Prioritario
                    </button>
                </div>
            </div>

            <main class="relative z-10">

                <section class="hero-section relative flex flex-col items-center justify-center text-center p-4 overflow-hidden">
                    <div class="background-logo-text opacity-50">NEWS</div>
                    <div class="relative z-10 pt-[18vh]">
                        <!-- (CAMBIO) Títulos y espaciado actualizados -->
                        <div class="z-10 text-center max-w-6xl"> <!-- max-w-4xl a max-w-6xl -->
                            <span class="text-indigo-500 font-bold uppercase tracking-wider text-base">Información es Poder</span>
                            <h1 class="text-6xl md:text-7xl lg:text-8xl font-extrabold tracking-tight mt-2"> <!-- 50% más grande -->
                                El Mercado Habla.
                            </h1>
                             <h2 class="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-600"> <!-- 50% más grande -->
                                Nosotros Traducimos.
                             </h2>
                            <p class="mt-6 text-xl md:text-2xl opacity-80 max-w-3xl mx-auto"> <!-- 50% más grande -->
                                Nuestro motor de IA escanea **más de 5,000 fuentes globales** en tiempo real para entregarte *solo* las noticias que mueven el mercado, analizadas y clasificadas para ti.
                            </p>
                        </div>
                        
                        <!-- Mockup del Feed de Noticias Animado -->
                        <div class="news-feed-container">
                             <div class="news-feed-track">
                                <!-- 10 items + 10 duplicados = 20 total -->
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Apple anuncia nuevo evento para Septiembre, se esperan iPhones con IA.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Bloomberg</span> | <span>Hace 2m</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">AAPL</span>
                                    </div>
                                </div>
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Reguladores de la UE investigan App Store por prácticas anticompetitivas.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Reuters</span> | <span>Hace 15m</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">AAPL</span>
                                        <span class="news-entity-tag">EU</span>
                                    </div>
                                </div>
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Flujo de ETFs de Bitcoin muestra salidas netas por tercer día consecutivo.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">CoinDesk</span> | <span>Hace 28m</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">BTC</span>
                                        <span class="news-entity-tag">ETF</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">NVIDIA supera expectativas de Q3 gracias a chips H200.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">MarketWatch</span> | <span>Hace 45m</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">NVDA</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Análisis: Cobre muestra signos de consolidación tras rally.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Finnhub</span> | <span>Hace 1h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">Cobre</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">SQM reporta utilidades menores a las esperadas por caída del precio del litio.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Diario Financiero</span> | <span>Hace 1h</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">SQM</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Tesla anuncia "Robotaxi Day" para agosto.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">The Verge</span> | <span>Hace 2h</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">TSLA</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Inflación de EE.UU. (CPI) se mantiene estable, mercado reacciona neutral.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Marketaux</span> | <span>Hace 3h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">CPI</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Amazon Web Services (AWS) anuncia nueva inversión de $10B en centros de datos.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">TechCrunch</span> | <span>Hace 4h</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">AMZN</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Banco Central de Chile decide mantener la Tasa de Política Monetaria (TPM).</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">La Tercera</span> | <span>Hace 5h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">TPM</span>
                                    </div>
                                </div>
                                
                                <!-- Columna 2 (Duplicado) -->
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Apple anuncia nuevo evento para Septiembre, se esperan iPhones con IA.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Bloomberg</span> | <span>Hace 2m</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">AAPL</span>
                                    </div>
                                </div>
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Reguladores de la UE investigan App Store por prácticas anticompetitivas.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Reuters</span> | <span>Hace 15m</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">AAPL</span>
                                        <span class="news-entity-tag">EU</span>
                                    </div>
                                </div>
                                <div class="news-card-mockup">
                                    <h3 class="text-lg">Flujo de ETFs de Bitcoin muestra salidas netas por tercer día consecutivo.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">CoinDesk</span> | <span>Hace 28m</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">BTC</span>
                                        <span class="news-entity-tag">ETF</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">NVIDIA supera expectativas de Q3 gracias a chips H200.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">MarketWatch</span> | <span>Hace 45m</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">NVDA</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Análisis: Cobre muestra signos de consolidación tras rally.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Finnhub</span> | <span>Hace 1h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">Cobre</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">SQM reporta utilidades menores a las esperadas por caída del precio del litio.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Diario Financiero</span> | <span>Hace 1h</span>
                                        <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-0.5"></i>Negativo</span>
                                        <span class="news-entity-tag">SQM</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Tesla anuncia "Robotaxi Day" para agosto.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">The Verge</span> | <span>Hace 2h</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">TSLA</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Inflación de EE.UU. (CPI) se mantiene estable, mercado reacciona neutral.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">Marketaux</span> | <span>Hace 3h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">CPI</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Amazon Web Services (AWS) anuncia nueva inversión de $10B en centros de datos.</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">TechCrunch</span> | <span>Hace 4h</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                        <span class="news-entity-tag">AMZN</span>
                                    </div>
                                </div>
                                 <div class="news-card-mockup">
                                    <h3 class="text-lg">Banco Central de Chile decide mantener la Tasa de Política Monetaria (TPM).</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">La Tercera</span> | <span>Hace 5h</span>
                                        <span class="news-sentiment-tag news-sentiment-neutral"><i data-lucide="minus" class="w-3 h-3 mr-0.5"></i>Neutral</span>
                                        <span class="news-entity-tag">TPM</span>
                                    </div>
                                </div>
                             </div>
                        </div>
                    </div>
                </section>

                <!-- ================================================================== -->
                <!-- == INICIO: NUEVA SECCIÓN DEMO INTERACTIVA DE NOTICIAS == -->
                <!-- ================================================================== -->
                <!-- (CAMBIO) Espaciado pt-16 a pt-10 -->
                <section id="interactive-news-demo" class="relative z-10 w-full pt-10 md:pt-8 pb-16 md:pb-24">
                     <div class="container mx-auto max-w-screen-xl px-4">
                         <div class="text-center mb-10"> <!-- (CAMBIO) mb-16 a mb-10 -->
                             <!-- (CAMBIO) Título 50% más grande -->
                             <h2 class="text-5xl md:text-6xl font-bold tracking-tight mt-2 mb-4">
                                Experimenta la Plataforma
                             </h2>
                             <p class="text-lg opacity-80 max-w-3xl mx-auto">
                                 Haz clic en una noticia para ver cómo nuestra IA la analiza. Activa el "Modo Focus" para una lectura inmersiva.
                             </p>
                        </div>
                        
                        <!-- (NUEVO) Toggle para ocultar imágenes -->
                        <div class="flex justify-center items-center gap-3 mb-4">
                             <span class="text-sm font-medium">Ocultar Imágenes</span>
                             <label class="toggle-switch">
                                 <input type="checkbox" id="hide-images-toggle">
                                 <span class="toggle-slider"></span>
                             </label>
                        </div>

                        
                        <!-- Contenedor de la Demo -->
                        <div class="feature-card p-4 md:p-6">
                            <div class="flex flex-col md:flex-row gap-6">
                                <!-- Columna de Lista de Noticias -->
                                <div id="news-list-column" class="w-full md:w-1/3 lg:w-2/5 flex-shrink-0">
                                    <div class="flex flex-col gap-3">
                                        <!-- Las tarjetas interactivas se cargarán aquí con JS -->
                                    </div>
                                </div>
                                <!-- Columna de Detalle de Noticia -->
                                <div id="news-detail-column" class="w-full md:w-2/3 lg:w-3/5 rounded-lg border" style="border-color: var(--border-main);">
                                    <!-- El contenido del detalle se cargará aquí -->
                                    <div id="news-detail-placeholder" class="flex flex-col items-center justify-center h-full text-center p-10 opacity-60">
                                        <i data-lucide="mouse-pointer-click" class="w-16 h-16 text-blue-500"></i>
                                        <p class="mt-4 font-semibold text-lg">Selecciona una noticia de la izquierda</p>
                                        <p class="text-sm">para ver el análisis detallado de nuestra IA aquí.</p>
                                    </div>
                                    <div id="news-detail-content" class="hidden">
                                        <!-- Header del detalle (para móvil) -->
                                        <div class="p-3 border-b md:hidden flex items-center gap-2" style="border-color: var(--border-main);">
                                            <button id="detail-back-btn" class="p-2 rounded-full hover:bg-gray-500/10">
                                                <i data-lucide="arrow-left" class="w-5 h-5"></i>
                                            </button>
                                            <span class="text-sm font-semibold opacity-80">Volver a la lista</span>
                                        </div>
                                         <!-- Contenido real -->
                                        <div id="detail-scroll-area" class="p-4 md:p-6">
                                            <!-- Botón Focus (solo visible en desktop/tablet) -->
                                            <div class="hidden md:flex justify-end mb-2">
                                                 <button id="detail-focus-btn" class="flex items-center gap-2 px-3 py-1.5 text-xs font-semibold rounded-full hover:bg-gray-500/10" style="border: 1px solid var(--border-main);">
                                                     <i data-lucide="maximize" class="w-3 h-3"></i>Modo Focus
                                                 </button>
                                            </div>
                                            <!-- Contenido del artículo -->
                                            <img id="detail-image" src="" alt="Imagen de Noticia" class="w-full h-48 md:h-64 object-cover rounded-lg mb-4">
                                            <h2 id="detail-title" class="text-2xl md:text-3xl font-bold mb-3"></h2>
                                            <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm mb-4 pb-4 border-b" style="border-color: var(--border-main);">
                                                <span id="detail-source" class="font-semibold"></span>
                                                <span id="detail-date" class="opacity-70"></span>
                                                <span id="detail-sentiment" class="news-sentiment-tag text-sm"></span>
                                            </div>
                                            <!-- (NUEVO) Bloque Análisis IA -->
                                            <div class="ai-analysis-block">
                                                 <h3><i data-lucide="brain-circuit" class="w-5 h-5 text-indigo-500"></i>Análisis de la IA</h3>
                                                 <div id="detail-ai-analysis-content" class="prose-content">
                                                     <!-- Contenido del análisis IA -->
                                                 </div>
                                            </div>
                                            <!-- Contenido Principal -->
                                            <h3 class="text-xl font-bold mt-6 mb-2">Resumen de la Noticia</h3>
                                            <div id="detail-content" class="prose dark:prose-invert max-w-none text-base opacity-90">
                                                <!-- Lorem ipsum... -->
                                            </div>
                                            <a href="#" class="modal-trigger-btn mt-6 inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                                Leer artículo original <i data-lucide="arrow-up-right" class="w-4 h-4"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                     </div>
                </section>
                <!-- ================================================================== -->
                <!-- == FIN: DEMO INTERACTIVA DE NOTICIAS == -->
                <!-- ================================================================== -->


                <!-- ================================================================== -->
                <!-- == INICIO: SECCIÓN DE FEATURES (BASADO EN NEWS.JS) == -->
                <!-- ================================================================== -->
                <!-- (CAMBIO) Espaciado pt-16 a pt-10 -->
                <section id="news-features" class="relative z-10 w-full pt-10 md:pt-8 pb-16 md:pb-24" style="background-color: rgba(120, 120, 120, 0.03);">
                    <div class="container mx-auto max-w-screen-xl px-4">
                        <div class="text-center mb-16">
                             <span class="text-indigo-500 font-bold uppercase tracking-wider text-base">Funcionalidad Completa</span>
                             <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">
                                Filtra el Ruido. Encuentra la Señal.
                             </h2>
                             <p class="text-xl opacity-80 max-w-3xl mx-auto">
                                 Tu plataforma de noticias no es solo un feed, es una herramienta de análisis.
                             </p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            
                            <!-- Feature 1: Alertas por Keyword -->
                            <div class="feature-card feature-grid-card">
                                <div class="icon icon-alert"><i data-lucide="siren" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Alertas por Palabras Clave</h3>
                                <p class="opacity-80 text-sm">
                                    Deja de perseguir las noticias. Define tus palabras clave (ej: "Tesla", "Litio", "IPC Chile") y te notificaremos al instante cuando algo importante ocurra.
                                </p>
                                <div class="flex-grow"></div>
                                <div class="mockup-alert-input">
                                    <input type="text" value="Tesla" disabled>
                                    <button><i data-lucide="plus" class="w-4 h-4"></i></button>
                                </div>
                            </div>

                            <!-- Feature 2: Análisis de Sentimiento IA -->
                            <div class="feature-card feature-grid-card">
                                <div class="icon icon-sentiment"><i data-lucide="scan-face" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Análisis de Sentimiento IA</h3>
                                <p class="opacity-80 text-sm">
                                    Ahorra tiempo. Nuestra IA lee y clasifica cada noticia como <span class="font-bold text-green-500">Positiva</span>, <span class="font-bold text-red-500">Negativa</span> o Neutral, permitiéndote entender el impacto de un vistazo.
                                </p>
                                <div class="flex-grow"></div>
                                <div class="news-card-mockup mt-4">
                                    <h3 class="text-lg">NVIDIA supera expectativas de Q3...</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">MarketWatch</span>
                                        <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-0.5"></i>Positivo</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Feature 3: Detección de Entidades -->
                            <div class="feature-card feature-grid-card">
                                <div class="icon icon-entity"><i data-lucide="tags" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Detección de Entidades</h3>
                                <p class="opacity-80 text-sm">
                                    Identifica al instante qué activos son mencionados. Cada noticia es etiquetada automáticamente con los tickers relevantes (ej: <span class="news-entity-tag">AAPL</span>, <span class="news-entity-tag">BTC</span>) para conectar la información con tu portafolio.
                                </p>
                                <div class="flex-grow"></div>
                                <div class="news-card-mockup mt-4">
                                    <h3 class="text-lg">Flujo de ETFs de Bitcoin...</h3>
                                    <div class="news-card-footer text-sm">
                                        <span class="news-source">CoinDesk</span>
                                        <span class="news-entity-tag">BTC</span>
                                        <span class="news-entity-tag">ETF</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Feature 4: Fuentes Globales Premium -->
                             <div class="feature-card feature-grid-card">
                                <div class="icon icon-sources"><i data-lucide="globe" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Fuentes Globales Premium</h3>
                                <p class="opacity-80 text-sm">
                                   Escaneamos **más de 5,000 sitios de noticias** globales, incluyendo feeds premium de pago y fuentes locales clave para que no te pierdas nada.
                                </p>
                                <div class="flex-grow"></div>
                                <!-- (NUEVO) Lista de fuentes -->
                                <div class="mockup-source-list">
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>The Wall Street Journal (USA)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>Diario Financiero (CL)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>Bloomberg (USA)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>La Tercera (CL)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>Reuters (Global)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i><span>CoinDesk (Cripto)</span></div>
                                    <div class="mockup-source-item"><i data-lucide="plus" class="w-4 h-4 opacity-70"></i><span>+5,000 fuentes globales</span></div>
                                </div>
                            </div>
                            
                             <!-- Feature 5: Modo Focus -->
                             <div class="feature-card feature-grid-card">
                                <div class="icon icon-focus"><i data-lucide="maximize" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Modo "Focus" sin Distracciones</h3>
                                <p class="opacity-80 text-sm">
                                   ¿Encontraste un artículo clave? Entra en "Modo Focus" para una lectura limpia, a pantalla completa y sin distracciones. Desliza para pasar al siguiente artículo, como si fuera una historia.
                                </p>
                                <div class="flex-grow"></div>
                                 <img src="https://placehold.co/400x150/374151/9ca3af?text=Mockup+Modo+Focus+(Pantalla+Completa)" alt="Modo Focus" class="w-full h-auto rounded-lg opacity-70 mt-4">
                            </div>
                            
                             <!-- Feature 6: Conectado a tu Inversión -->
                             <div class="feature-card feature-grid-card">
                                <div class="icon icon-connect"><i data-lucide="link" class="w-6 h-6"></i></div>
                                <h3 class="text-xl font-bold">Conectado a tu Inversión</h3>
                                <p class="opacity-80 text-sm">
                                   Las noticias no están aisladas. Visualiza artículos relevantes directamente en tu **Portafolio** y en tu lista de **Seguimiento**, dándote contexto inmediato sobre *por qué* se mueven tus activos.
                                </p>
                                <div class="flex-grow"></div>
                                 <img src="https://placehold.co/400x150/1f2937/6b7280?text=Mockup+Noticias+en+Portafolio" alt="Noticias en Portafolio" class="w-full h-auto rounded-lg opacity-70 mt-4">
                            </div>

                        </div>
                    </div>
                </section>
                <!-- ================================================================== -->
                <!-- == FIN: SECCIÓN DE FEATURES == -->
                <!-- ================================================================== -->

                 <!-- (CAMBIO) Espaciado pt-16 a pt-10 -->
                 <section id="final-cta" class="relative z-10 w-full pt-10 md:pt-14 pb-20 md:pb-32 text-center">
                    <div class="container mx-auto max-w-3xl px-4">
                        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">
                            La Ventaja Informativa que Necesitas.
                        </h2>
                        <p class="mt-4 text-lg md:text-xl opacity-80">
                           Deja de reaccionar tarde. Regístrate para el acceso prioritario y sé el primero en saber cuándo el mercado se mueve.
                        </p>
                        <button id="footer-whitelist-btn" class="modal-trigger-btn mt-10 text-white font-semibold rounded-full px-8 py-4 text-lg transition-transform hover:scale-105 animated-whitelist-btn whitespace-nowrap" style="background-color: var(--accent-indigo);">
                             Obtener Acceso Prioritario
                        </button>
                    </div>
                </section>

            </main>

            <!-- 
                ============================================================
                INICIO: FOOTER (MODIFICADO)
                ============================================================
            -->
            <footer class="relative z-10 w-full border-t" style="border-color: var(--border-main); background-color: var(--bg-main);">
                <div class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16">
                    
                    <!-- Sección Superior: Logo y Tagline -->
                    <div class="mb-12 text-center md:text-left">
                        <div class="text-xl font-bold tracking-wider inline-block">MAVERLANG</div>
                        <p class="mt-2 text-md opacity-80 max-w-lg mx-auto md:mx-0">
                            Potenciando decisiones financieras con inteligencia artificial avanzada.
                        </p>
                    </div>

                    <!-- Sección Media: Enlaces (MODIFICADA) -->
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-8 mb-12">
                        <!-- Col 1: Navegación (MODIFICADA) -->
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Navegación</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="index.html" class="text-sm opacity-70 hover:opacity-100 hover:text-blue-500 transition-all">Inicio</a>
                                <a href="noticias.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Noticias</a>
                                <a href="mercados.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Mercados</a>
                                <a href="aprendelo.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Apréndelo</a>
                            </nav>
                        </div>
                        <!-- Col 2: Plataforma (NUEVA) -->
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Plataforma</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="portafolioAI.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio AI</a>
                                <a href="seguimiento.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Seguimiento</a>
                                <a href="portafolio.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio Virtual</a>
                                <a href="chats.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Chats</a>
                            </nav>
                        </div>
                        <!-- Col 3: Compañía (Sin cambios) -->
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Compañía</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Sobre Nosotros</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Blog</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Contacto</a>
                            </nav>
                        </div>
                        <!-- Col 4: Legal (Sin cambios) -->
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Legal</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Términos de Servicio</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Política de Privacidad</a>
                            </nav>
                        </div>
                    </div>

                    <!-- Sección Inferior: Copyright y Redes Sociales (MODIFICADA) -->
                    <div class="border-t pt-8 pb-12 flex flex-col md:flex-row justify-between items-center gap-6" style="border-color: var(--border-main);">
                        <p class="text-sm opacity-70 text-center md:text-left">
                            &copy; 2025 Maverlang. Todos los derechos reservados.
                        </p>
                        <div class="flex gap-6">
                            <a href="#" aria-label="LinkedIn" class="opacity-70 hover:opacity-100 hover:text-blue-500 transition-all">
                                <i data-lucide="linkedin" class="w-6 h-6"></i>
                            </a>
                            <a href="#" aria-label="Instagram" class="opacity-70 hover:opacity-100 hover:text-pink-500 transition-all">
                                <i data-lucide="instagram" class="w-6 h-6"></i>
                            </a>
                            <a href="#" aria-label="X (Twitter)" class="opacity-70 hover:opacity-100 transition-all">
                                <!-- SVG para X -->
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                  <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.06l3.51 4.639L12.6.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                                </svg>
                            </a>
                            <a href="#" aria-label="Facebook" class="opacity-70 hover:opacity-100 hover:text-blue-600 transition-all">
                                <i data-lucide="facebook" class="w-6 h-6"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- 
                ============================================================
                FIN: FOOTER
                ============================================================
            -->

        </div>
    </div>

    <!-- Modal de Whitelist -->
    <div id="whitelist-modal" class="fixed inset-0 bg-black/60 z-[101] flex items-center justify-center p-4 opacity-0 invisible">
        <div class="modal-content w-full max-w-md rounded-2xl p-8 text-center scale-95">
            <button id="close-modal-btn" class="absolute top-4 right-4 p-2 rounded-full hover:bg-gray-500/10"><i data-lucide="x"></i></button>
            <i data-lucide="rocket" class="w-12 h-12 mx-auto text-blue-500 mb-4"></i>
            <h2 class="text-2xl font-bold">Únete al Acceso Prioritario</h2>
            <p class="mt-2 text-main/70">Sé el primero en saber cuándo lanzamos y obtén un <span class="font-bold text-blue-500">20% de descuento</span>.</p>
            <div id="fomo-counter" class="text-base font-semibold">
               ¡Únete a <span id="whitelist-count">...</span> analistas en la lista!
            </div>
            <div id="modal-countdown-container" class="flex items-center justify-center gap-3 md:gap-4 my-6">
                <!-- Contenido del countdown -->
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-days" class="countdown-number">00</span><span class="countdown-label">Días</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-hours" class="countdown-number">00</span><span class="countdown-label">Horas</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-minutes" class="countdown-number">00</span><span class="countdown-label">Minutos</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-seconds" class="countdown-number">00</span><span class="countdown-label">Segundos</span></div>
            </div>
            <form id="whitelist-form-modal">
                <div class="flex items-center p-2 rounded-full border" style="border-color: var(--border-main);"><input type="email" id="email-input-modal" placeholder="Tu correo electrónico" required class="w-full bg-transparent px-4 py-2 text-main placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none"><button type="submit" id="submit-btn-modal" class="bg-blue-600 text-white font-semibold px-6 py-2 rounded-full flex-shrink-0 hover:bg-blue-700 transition-colors">Anotarme</button></div>
                <p id="form-message-modal" class="mt-3 text-sm h-5"></p>
            </form>
        </div>
    </div>
    
    <!-- ================================================================== -->
    <!-- == INICIO: HTML PARA MODO FOCUS (Oculto) == -->
    <!-- ================================================================== -->
     <div id="focus-mode-view" class="invisible opacity-0">
         <header id="focus-header">
             <div id="focus-meta" class="flex items-center gap-3">
                <img id="focus-source-img" src="" alt="Source" class="w-6 h-6 rounded-full bg-gray-700">
                <div>
                    <div id="focus-source-name" class="text-sm font-semibold text-white"></div>
                    <div id="focus-date" class="text-xs text-white/70"></div>
                </div>
             </div>
             <button id="focus-close-btn" class="p-2 rounded-full bg-black/30 hover:bg-black/50 text-white">
                 <i data-lucide="x" class="w-6 h-6"></i>
             </button>
         </header>
         
         <button id="focus-prev-btn" class="focus-nav-btn left-4"><i data-lucide="chevron-left" class="w-8 h-8"></i></button>
         <button id="focus-next-btn" class="focus-nav-btn right-4"><i data-lucide="chevron-right" class="w-8 h-8"></i></button>

         <div id="focus-content-container" class="news-custom-scrollbar">
             <div class="focus-content">
                 <img id="focus-image" src="" alt="Imagen de Noticia">
                 <h1 id="focus-title"></h1>
                 <div class="meta-info">
                     <span id="focus-sentiment"></span>
                     <div id="focus-entities" class="flex flex-wrap items-center gap-2">
                         <!-- Entidades se cargan aquí -->
                     </div>
                 </div>
                 <!-- (NUEVO) Bloque Análisis IA en Focus Mode -->
                 <div class="ai-analysis-block">
                      <h3><i data-lucide="brain-circuit" class="w-5 h-5 text-indigo-500"></i>Análisis de la IA</h3>
                      <div id="focus-ai-analysis-content" class="prose-content">
                          <!-- Contenido del análisis IA -->
                      </div>
                 </div>
                 <!-- Contenido Principal -->
                 <h3 class="text-xl font-bold mt-8 mb-3">Resumen de la Noticia</h3>
                 <div id="focus-body" class="prose-content">
                     <!-- Contenido Lorem Ipsum se carga aquí -->
                 </div>
             </div>
         </div>
     </div>
    <!-- ================================================================== -->
    <!-- == FIN: HTML PARA MODO FOCUS == -->
    <!-- ================================================================== -->


    <!-- Script -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        let db, auth;
        let userId = null;
        let isAuthReady = false;
        let whitelistCol;
        let isClickOutsideListenerAdded = false;

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        let modalShown = false;

        const openModal = (e) => {
            if (e) e.preventDefault();
             // No abrir modal si el enlace tiene un href real (que no sea #)
            if (e.currentTarget && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') {
                return; 
            }
            const modal = document.getElementById('whitelist-modal');
            if (!modal || !modal.classList.contains('invisible')) return;
            modalShown = true;
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.remove('invisible', 'opacity-0');
            modalContent.classList.remove('scale-95');
        };
        const closeModal = () => {
             const modal = document.getElementById('whitelist-modal');
            if (!modal) return;
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => modal.classList.add('invisible'), 300);
        };
        
        async function initApp() {
            if (typeof lucide !== 'undefined') { lucide.createIcons(); }
            else { console.warn("Lucide no está listo..."); setTimeout(initApp, 100); return; }

            initTheme();
            await initFirebase();
            initWhitelistModal();
            initWhitelistForms();
            initAnimations();
            initCountdown();
            initHeaderScrollBehavior();
            initNavigation(); // <-- (CORREGIDO) Esta llamada faltaba
            generateParticlesSlow();
            
            // Inicializar la demo interactiva de noticias
            initInteractiveNews();
            
            if (isAuthReady) { listenToWhitelistCount(); }
            else { console.warn("Auth no lista. Whitelist count no iniciará."); }
        }

        async function initFirebase() {
             if (!firebaseConfig.apiKey || firebaseConfig.apiKey === "TU_API_KEY") {
                console.warn("Firebase no está configurado."); isAuthReady = false; return;
            }
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app); auth = getAuth(app); setLogLevel('debug');
                whitelistCol = collection(db, 'artifacts', appId, 'public', 'data', 'whitelist');
                await new Promise((resolve, reject) => {
                    const unsubscribe = onAuthStateChanged(auth, async (user) => {
                        unsubscribe();
                        if (user) { userId = user.uid; isAuthReady = true; console.log("Usuario autenticado:", userId); resolve(); }
                        else {
                            try {
                                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                    await signInWithCustomToken(auth, __initial_auth_token);
                                } else { await signInAnonymously(auth); }
                                if (auth.currentUser) { userId = auth.currentUser.uid; isAuthReady = true; console.log("Auth silenciosa OK:", userId); resolve(); }
                                else { isAuthReady = false; reject(new Error("Fallo en auth silenciosa.")); }
                            } catch (authError) { isAuthReady = false; console.error("Error auth silenciosa:", authError); reject(authError); }
                        }
                    }, (error) => { isAuthReady = false; console.error("Error onAuthStateChanged:", error); reject(error); });
                });
            } catch (e) { console.error("Error Firebase:", e.message); isAuthReady = false; }
        }

        function initTheme() {
            const themeMainBtn = document.getElementById('theme-main-btn');
            const themeDropdownMenu = document.getElementById('theme-dropdown-menu');
            const themeDropdownBtns = themeDropdownMenu ? themeDropdownMenu.querySelectorAll('.theme-dropdown-btn') : [];
            if (!themeMainBtn || !themeDropdownMenu || themeDropdownBtns.length === 0) { console.warn("Elementos tema no encontrados."); return; }
            const currentTheme = localStorage.getItem('maverlang_theme') || 'light';
            applyTheme(currentTheme, true); // True para carga inicial
            themeMainBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const isVisible = !themeDropdownMenu.classList.contains('invisible');
                document.querySelectorAll('.nav-dropdown-menu').forEach(m => m?.classList.add('opacity-0', 'scale-95', 'invisible')); // Cerrar otros
                if (isVisible) { themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible'); }
                else { themeDropdownMenu.classList.remove('opacity-0', 'scale-95', 'invisible'); }
            });
            themeDropdownBtns.forEach(btn => {
                btn.addEventListener('click', () => { applyTheme(btn.dataset.theme); themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible'); });
            });
        }

        function applyTheme(theme, isInitialLoad = false) {
             const html = document.documentElement;
            const themeMainBtn = document.getElementById('theme-main-btn');
            let iconName = 'sun';
            html.classList.remove('dark', 'stars-theme');
            if (theme === 'dark') { html.classList.add('dark'); iconName = 'moon'; }
            /* (ELIMINADO) else if (theme === 'stars') { ... } */
            
            if (!isInitialLoad) {
                 localStorage.setItem('maverlang_theme', theme);
            }

            if (themeMainBtn) { themeMainBtn.innerHTML = `<i data-lucide="${iconName}"></i>`; if (typeof lucide !== 'undefined') { lucide.createIcons(); } }
            document.querySelectorAll('.theme-dropdown-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.theme-dropdown-btn[data-theme="${theme}"]`)?.classList.add('active');
            initAnimations();
            updateHeaderBackground();
        }
        
        function initWhitelistModal() {
             const modal = document.getElementById('whitelist-modal'); if (!modal) return;
             const closeModalBtn = document.getElementById('close-modal-btn');
             const triggerButtons = document.querySelectorAll('#header-whitelist-btn, .animated-whitelist-btn, .modal-trigger-btn, #footer-whitelist-btn, #mobile-whitelist-btn');
             triggerButtons.forEach(btn => { 
                if (btn && btn.dataset.modalListenerAttached !== 'true') { 
                    btn.addEventListener('click', (e) => {
                        if (e.currentTarget.tagName === 'A' && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') {
                             return; 
                        }
                        openModal(e);
                    }); 
                    btn.dataset.modalListenerAttached = 'true'; 
                } 
             });
             if (closeModalBtn && closeModalBtn.dataset.modalListenerAttached !== 'true') { closeModalBtn.addEventListener('click', closeModal); closeModalBtn.dataset.modalListenerAttached = 'true'; }
             if (modal.dataset.modalListenerAttached !== 'true') { modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); }); modal.dataset.modalListenerAttached = 'true'; }
        }
        
        function listenToWhitelistCount() {
             if (!db || !whitelistCol || !isAuthReady) { console.warn("listenToWhitelistCount: DB/Auth no listo."); return; }
             const fomoCounterEl = document.getElementById('fomo-counter'); const countEl = document.getElementById('whitelist-count'); if (!fomoCounterEl || !countEl) { console.error("Contador FOMO no encontrado."); return; }
             try {
                 onSnapshot(whitelistCol, (snapshot) => {
                     const count = snapshot.size; countEl.textContent = count > 0 ? count.toLocaleString('es') : '0'; fomoCounterEl.classList.add('visible');
                 }, (error) => { console.error("Error onSnapshot:", error); fomoCounterEl.classList.add('visible'); countEl.textContent = 'Error'; });
             } catch (error) { console.error("Error setup onSnapshot:", error); fomoCounterEl.classList.add('visible'); countEl.textContent = 'Error'; }
        }
        
        function initWhitelistForms() { const modalForm = document.getElementById('whitelist-form-modal'); if (modalForm) modalForm.addEventListener('submit', handleWhitelistSubmit); }
        
        async function handleWhitelistSubmit(e) {
             e.preventDefault(); if (!db || !whitelistCol || !isAuthReady || !auth.currentUser) { setMessage('Error: Auth/DB no lista.', 'error'); return; }
             const emailInput = document.getElementById('email-input-modal'); const submitBtn = document.getElementById('submit-btn-modal'); const email = emailInput.value.trim(); if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { setMessage('Correo inválido.', 'error'); return; }
             const originalBtnText = submitBtn.textContent; submitBtn.disabled = true; submitBtn.textContent = 'Enviando...'; setMessage('', 'clear');
             try {
                 const q = query(whitelistCol, where("email", "==", email)); const querySnapshot = await getDocs(q); if (!querySnapshot.empty) { throw new Error('Correo ya registrado.'); }
                 await addDoc(whitelistCol, { email: email, timestamp: serverTimestamp(), source: 'modal-noticias' }); // Fuente actualizada
                 setMessage('¡Gracias! Estás en la lista.', 'success'); emailInput.value = ''; setTimeout(closeModal, 2000);
             } catch (error) { console.error("Error whitelist:", error); setMessage(error.message || 'Error al registrar.', 'error'); }
             finally { submitBtn.disabled = false; submitBtn.textContent = originalBtnText; }
        }
        
        function setMessage(message, type) { const messageEl = document.getElementById('form-message-modal'); if (!messageEl) return; messageEl.textContent = message; messageEl.style.color = type === 'success' ? 'var(--success-color)' : (type === 'error' ? 'var(--accent-red)' : 'inherit'); }
        
        function initCountdown() {
             const ids = ['modal']; const labels = ['days', 'hours', 'minutes', 'seconds']; const elements = {};
             ids.forEach(id => { elements[id] = {}; labels.forEach(l => elements[id][l] = document.getElementById(`${id}-${l}`)); });
             if (!elements['modal']['days']) return; // Salir si no hay elementos
             const targetDate = new Date('2025-11-24T00:00:00').getTime();
             const interval = setInterval(() => {
                 const distance = targetDate - new Date().getTime(); if (distance < 0) { clearInterval(interval); ids.forEach(id => { const cont = document.getElementById(`${id}-countdown-container`); if(cont) cont.innerHTML = '<p class="text-xl font-bold text-blue-500">¡Lanzamiento iniciado!</p>'; }); return; }
                 const d=Math.floor(distance/864e5), h=Math.floor((distance%864e5)/36e5), m=Math.floor((distance%36e5)/6e4), s=Math.floor((distance%6e4)/1000);
                 const times = { days: d, hours: h, minutes: m, seconds: s };
                 ids.forEach(id => { labels.forEach(l => { if(elements[id]?.[l]) elements[id][l].textContent = String(times[l]).padStart(2, '0'); }); });
             }, 1000);
        }

        let starfieldAnimationId = null;
        function initAnimations(){
             /* (ELIMINADO) Lógica de Starfield */
        }
        /* (ELIMINADO) function initStarfield() { ... } */
        
        function updateHeaderBackground() { const header = document.querySelector('header'); if (!header) return; const headerContent = header.firstElementChild; if (!headerContent) return; const threshold = 50; const scrolled = window.scrollY > threshold; const isDark = document.documentElement.classList.contains('dark'); const bgColor = scrolled ? (isDark ? 'rgba(10,10,10,0.8)' : 'rgba(255,255,255,0.8)') : (isDark ? 'rgba(0,0,0,0.3)' : 'rgba(255,255,255,0.3)'); headerContent.style.backgroundColor = bgColor; }
        
        function initHeaderScrollBehavior() { window.addEventListener('scroll', updateHeaderBackground, { passive: true }); updateHeaderBackground(); }
        
        function initNavigation() {
            const funcionesBtn = document.getElementById('nav-funciones-btn'); 
            const funcionesMenu = document.getElementById('nav-funciones-menu');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenuPanel = document.getElementById('mobile-menu-panel');
            
            // Lógica Dropdown Escritorio
            if (funcionesBtn && funcionesMenu) {
                const toggleFuncionesDropdown = (e) => { 
                    e.stopPropagation(); 
                    const isVisible = !funcionesMenu.classList.contains('invisible'); 
                    document.getElementById('theme-dropdown-menu')?.classList.add('opacity-0', 'scale-95', 'invisible'); 
                    if (isVisible) { 
                        funcionesMenu.classList.add('opacity-0', 'scale-95', 'invisible'); 
                    } else { 
                        funcionesMenu.classList.remove('opacity-0', 'scale-95', 'invisible'); 
                    } 
                };
                if (funcionesBtn.dataset.navListenerAttached !== 'true') { 
                    funcionesBtn.addEventListener('click', toggleFuncionesDropdown); 
                    funcionesBtn.dataset.navListenerAttached = 'true'; 
                }
            } else { console.warn("Dropdown 'Funciones' no encontrado."); }

            // Lógica Menú Móvil
            if (mobileMenuBtn && mobileMenuPanel) {
                const openMenu = (e) => {
                    e.stopPropagation();
                    mobileMenuPanel.classList.add('open');
                    mobileMenuBtn.innerHTML = `<i data-lucide="x" class="w-6 h-6"></i>`;
                    lucide.createIcons();
                };

                const closeMenu = () => {
                    mobileMenuPanel.classList.remove('open');
                    mobileMenuBtn.innerHTML = `<i data-lucide="menu" class="w-6 h-6"></i>`;
                    lucide.createIcons();
                };
                
                mobileMenuBtn.addEventListener('click', (e) => {
                    if (mobileMenuPanel.classList.contains('open')) {
                        closeMenu();
                    } else {
                        openMenu(e);
                    }
                });
                
                // Cerrar al hacer clic en un enlace
                mobileMenuPanel.querySelectorAll('a, .modal-trigger-btn').forEach(link => {
                    link.addEventListener('click', () => {
                        // No cerrar si el enlace es modal (ya que openModal se encarga)
                        if (!link.classList.contains('modal-trigger-btn')) {
                            closeMenu();
                        }
                    });
                });
            }

            if (!isClickOutsideListenerAdded) {
                document.addEventListener('click', (e) => {
                    // Cerrar ambos menús si se hace clic fuera
                    document.querySelectorAll('.nav-dropdown-menu, .theme-dropdown-menu').forEach(menu => {
                         const btnId = menu.id.replace('-menu', '-btn');
                         const btn = document.getElementById(btnId);
                         if (menu && !menu.classList.contains('invisible') && btn && !btn.contains(e.target) && !menu.contains(e.target)) {
                             menu.classList.add('opacity-0', 'scale-95', 'invisible');
                         }
                    });

                    // Cerrar menú móvil si se hace clic fuera de él
                    if (mobileMenuPanel && mobileMenuPanel.classList.contains('open') && !mobileMenuBtn.contains(e.target) && !mobileMenuPanel.contains(e.target)) {
                         closeMenu();
                    }
                });
                isClickOutsideListenerAdded = true;
            }

            if (funcionesMenu) { funcionesMenu.querySelectorAll('a').forEach(item => { if (item.dataset.navItemListener !== 'true') { item.addEventListener('click', (e) => { if (!item.href || item.href.endsWith('#')) { funcionesMenu.classList.add('opacity-0', 'scale-95', 'invisible'); } }); item.dataset.navItemListener = 'true'; } }); }
        }
        
        function generateParticlesSlow() { const container = document.querySelector('#nav-portafolio-ai-link .particles-container'); if (!container) return; const particleCount = 6; const colors = ['var(--particle-color-1)', 'var(--particle-color-2)', 'var(--particle-color-3)']; const totalDuration = 5; const particleAnimationDuration = 2.5; container.innerHTML = ''; for (let i = 0; i < particleCount; i++) { const particle = document.createElement('div'); particle.classList.add('particle'); const baseStartPercentage = 0.45; const randomOffsetPercentage = Math.random() * 0.1; const startDelay = (baseStartPercentage + randomOffsetPercentage); particle.style.setProperty('--particle-delay', startDelay.toFixed(2)); particle.style.setProperty('--particle-x', `${Math.random() * 30 - 15}px`); particle.style.setProperty('--particle-y', `${Math.random() * -5 - 3}px`); particle.style.setProperty('--particle-color', colors[Math.floor(Math.random() * colors.length)]); particle.style.animationDuration = `${particleAnimationDuration}s`; particle.style.animationDelay = `${startDelay * totalDuration}s`; container.appendChild(particle); } }

        // Funciones vacías de placeholder
        function initTypingAnimation() { /* No aplica aquí */ }
        function initChatInputBehavior() { /* No aplica aquí */ }
        function initFauxChatAndLLM() { /* No aplica aquí */ }
        function initAprendeloTabs() { /* No aplica aquí */ }
        
        // ==================================================================
        // == INICIO: LÓGICA PARA DEMO INTERACTIVA DE NOTICIAS ==
        // ==================================================================
        
        // (NUEVO) Datos de noticias falsas con más info
        const fakeNewsData = [
            {
                id: 'fake-1',
                title: 'Apple (AAPL) anuncia nuevo evento "Wonderlust" para Septiembre.',
                source: 'Bloomberg',
                date: 'Hace 25m',
                sentiment: { text: 'Positivo', class: 'news-sentiment-positive', icon: 'trending-up' },
                entities: [{ text: 'AAPL', class: 'news-entity-tag' }],
                image: 'https://placehold.co/800x450/333/FFF?text=Bloomberg',
                content: '<p>Apple ha enviado invitaciones oficialmente para su evento de otoño, titulado "Wonderlust", programado para el 12 de septiembre. Se espera que la compañía presente la nueva línea de iPhone 15, junto con el Apple Watch Series 9 y potencialmente un Apple Watch Ultra de segunda generación.</p><p>Los analistas están particularmente enfocados en la posible introducción de un puerto USB-C en el iPhone por primera vez, cumpliendo con las regulaciones de la UE. Además, se rumorea que los modelos Pro contarán con un nuevo chasis de titanio y un chip A17 Bionic más rápido...</p>',
                aiAnalysis: '<p><strong>Impacto: Alto (Positivo)</strong></p><p>El anuncio de un nuevo iPhone es el catalizador más fuerte a corto plazo para AAPL. La confirmación de USB-C podría calmar a los reguladores de la UE, y un chasis de titanio podría impulsar un nuevo ciclo de actualización "Super-Cycle". Se espera volatilidad alcista a medida que se acerca la fecha.</p>'
            },
            {
                id: 'fake-2',
                title: 'Salidas netas en ETFs de Bitcoin (BTC) por tercer día consecutivo.',
                source: 'CoinDesk',
                date: 'Hace 1h',
                sentiment: { text: 'Negativo', class: 'news-sentiment-negative', icon: 'trending-down' },
                entities: [{ text: 'BTC', class: 'news-entity-tag' }, { text: 'ETF', class: 'news-entity-tag' }],
                image: 'https://placehold.co/800x450/f7931a/FFFFFF?text=CoinDesk',
                content: '<p>Los fondos cotizados (ETF) de Bitcoin al contado en EE.UU. registraron su tercer día consecutivo de salidas netas, con más de $150 millones retirados el martes. Esta tendencia bajista coincide con una caída en el precio de Bitcoin por debajo de los $60,000.</p><p>Los analistas señalan una menor demanda y una toma de ganancias como las principales razones. El fondo GBTC de Grayscale continúa liderando las salidas, aunque otros fondos como IBIT de BlackRock también han visto disminuir sus entradas diarias...</p>',
                aiAnalysis: '<p><strong>Impacto: Medio (Negativo)</strong></p><p>Las salidas continuas de los ETF indican una débil confianza institucional a corto plazo. Esto podría ejercer más presión a la baja sobre el precio de BTC. Vigilar el nivel de soporte de $58k; una ruptura podría desencadenar liquidaciones adicionales.</p>'
            },
            {
                id: 'fake-3',
                title: 'NVIDIA (NVDA) supera expectativas de ingresos gracias a la demanda de chips IA.',
                source: 'MarketWatch',
                date: 'Hace 3h',
                sentiment: { text: 'Positivo', class: 'news-sentiment-positive', icon: 'trending-up' },
                entities: [{ text: 'NVDA', class: 'news-entity-tag' }],
                image: 'https://placehold.co/800x450/76b900/FFFFFF?text=MarketWatch',
                content: '<p>NVIDIA reportó ingresos trimestrales que superaron ampliamente las estimaciones de Wall Street, impulsados por la venta imparable de sus procesadores gráficos (GPU) para centros de datos de Inteligencia Artificial.</p><p>La compañía también ofreció un pronóstico optimista para el próximo trimestre, indicando que la demanda de su nueva arquitectura "Blackwell" sigue superando la oferta. Las acciones subieron más de un 6% en las operaciones posteriores al cierre...</p>',
                aiAnalysis: '<p><strong>Impacto: Muy Alto (Positivo)</strong></p><p>Este es un informe de ganancias "Blockbuster". Superar las estimaciones y elevar la guía confirma que la narrativa de la IA sigue intacta. Se espera una fuerte apertura alcista para NVDA y un impulso positivo para todo el sector de semiconductores (SMH).</p>'
            }
        ];
        
        let currentNewsIndex = 0;
        let imagesHidden = false; // (NUEVO) Estado global para imágenes
        
        function initInteractiveNews() {
            const listColumn = document.getElementById('news-list-column');
            const detailColumn = document.getElementById('news-detail-column');
            const detailPlaceholder = document.getElementById('news-detail-placeholder');
            const detailContent = document.getElementById('news-detail-content');
            const detailBackBtn = document.getElementById('detail-back-btn');
            const detailFocusBtn = document.getElementById('detail-focus-btn');
            const focusView = document.getElementById('focus-mode-view');
            const focusCloseBtn = document.getElementById('focus-close-btn');
            const focusPrevBtn = document.getElementById('focus-prev-btn');
            const focusNextBtn = document.getElementById('focus-next-btn');
            const hideImagesToggle = document.getElementById('hide-images-toggle'); // (NUEVO)
            const demoContainer = document.getElementById('interactive-news-demo'); // (NUEVO)

            if (!listColumn) return; 

            // 1. Renderizar la lista
            listColumn.querySelector('.flex').innerHTML = fakeNewsData.map((item, index) => `
                <div class="interactive-news-card" data-index="${index}">
                    <img src="${item.image.replace('800x450', '160x120')}" alt="${item.title}">
                    <div>
                        <h4>${item.title.substring(0, 50)}...</h4>
                        <div class="footer">
                            <span>${item.source}</span>
                            <span>${item.date}</span>
                        </div>
                    </div>
                </div>
            `).join('');

            // 2. Listeners para la lista
            listColumn.querySelectorAll('.interactive-news-card').forEach(card => {
                card.addEventListener('click', () => {
                    const index = parseInt(card.dataset.index);
                    renderDetailView(index);
                    listColumn.querySelectorAll('.interactive-news-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                    if (window.innerWidth < 768) {
                        listColumn.classList.add('hidden');
                        detailColumn.classList.remove('hidden');
                    }
                });
            });
            
            // 3. Listener para botón "Atrás" (móvil)
            detailBackBtn.addEventListener('click', () => {
                 listColumn.classList.remove('hidden');
                 detailColumn.classList.add('hidden');
                 detailPlaceholder.classList.remove('hidden');
                 detailContent.classList.add('hidden');
                 listColumn.querySelectorAll('.interactive-news-card').forEach(c => c.classList.remove('active'));
            });
            
            // 4. Listeners para Modo Focus
            detailFocusBtn.addEventListener('click', () => openFocusMode(currentNewsIndex));
            focusCloseBtn.addEventListener('click', closeFocusMode);
            focusPrevBtn.addEventListener('click', () => navigateFocus(-1));
            focusNextBtn.addEventListener('click', () => navigateFocus(1));
            
             // (NUEVO) 5. Listener para Ocultar Imágenes
             hideImagesToggle.addEventListener('change', () => {
                 imagesHidden = hideImagesToggle.checked;
                 demoContainer.classList.toggle('images-hidden', imagesHidden);
                 // Actualizar focus view si está visible
                 focusView.classList.toggle('images-hidden', imagesHidden);
             });

            // 6. Mostrar placeholder al inicio
            showDetailPlaceholder();
        }
        
        function renderDetailView(index) {
            currentNewsIndex = index;
            const item = fakeNewsData[index];
            
            document.getElementById('news-detail-placeholder').classList.add('hidden');
            document.getElementById('news-detail-content').classList.remove('hidden');
            
            document.getElementById('detail-image').src = item.image;
            document.getElementById('detail-image').alt = item.title;
            document.getElementById('detail-title').textContent = item.title;
            document.getElementById('detail-source').textContent = item.source;
            document.getElementById('detail-date').textContent = item.date;
            
            const sentimentEl = document.getElementById('detail-sentiment');
            sentimentEl.className = `news-sentiment-tag text-sm ${item.sentiment.class}`;
            sentimentEl.innerHTML = `<i data-lucide="${item.sentiment.icon}" class="w-4 h-4 mr-1"></i> ${item.sentiment.text}`;
            
            // (NUEVO) Añadir Análisis IA
            document.getElementById('detail-ai-analysis-content').innerHTML = item.aiAnalysis;
            
            document.getElementById('detail-content').innerHTML = item.content;
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        function showDetailPlaceholder() {
             document.getElementById('news-detail-placeholder').classList.remove('hidden');
             document.getElementById('news-detail-content').classList.add('hidden');
        }
        
        // (NUEVO) Función Fullscreen y Tema
        function openFocusMode(index) {
            currentNewsIndex = index;
            const focusView = document.getElementById('focus-mode-view');
            
            // Aplicar tema actual
            const currentTheme = localStorage.getItem('maverlang_theme') || 'light';
            focusView.classList.remove('dark', 'stars-theme'); // Limpiar
            if (currentTheme === 'dark') {
                focusView.classList.add('dark');
            }
            // (ELIMINADO) else if (currentTheme === 'stars') { ... }
            
            // Aplicar estado de ocultar imágenes
            focusView.classList.toggle('images-hidden', imagesHidden);

            updateFocusContent();
            focusView.classList.remove('invisible', 'opacity-0');
            focusView.classList.add('visible');
            
            // (NUEVO) Solicitar Fullscreen
            try {
                if (focusView.requestFullscreen) {
                    focusView.requestFullscreen();
                } else if (focusView.webkitRequestFullscreen) { /* Safari */
                    focusView.webkitRequestFullscreen();
                } else if (focusView.msRequestFullscreen) { /* IE11 */
                    focusView.msRequestFullscreen();
                }
            } catch(err) {
                 console.warn("No se pudo entrar en pantalla completa:", err);
            }
             // Listener para salir de fullscreen con ESC
             document.addEventListener('fullscreenchange', handleFullscreenExit);
             document.addEventListener('webkitfullscreenchange', handleFullscreenExit);
        }
        
        function closeFocusMode() {
            const focusView = document.getElementById('focus-mode-view');
            
             // (NUEVO) Salir de Fullscreen
             try {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) { /* Safari */
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) { /* IE11 */
                    document.msExitFullscreen();
                }
             } catch (err) {
                 console.warn("Error al salir de pantalla completa:", err);
             }
            
            focusView.classList.add('opacity-0');
            setTimeout(() => {
                focusView.classList.add('invisible');
                focusView.classList.remove('visible');
                focusView.classList.remove('dark', 'stars-theme'); // Limpiar clases de tema
                // focusView.style.removeProperty('--starfield-bg'); (ELIMINADO)
            }, 300);
            
            document.removeEventListener('fullscreenchange', handleFullscreenExit);
            document.removeEventListener('webkitfullscreenchange', handleFullscreenExit);
        }
        
        function handleFullscreenExit() {
             // Si el usuario presiona ESC, salimos de fullscreen
             if (!document.fullscreenElement && !document.webkitFullscreenElement) {
                 closeFocusMode(); // Llama a nuestra función de cierre
             }
         }
        
        function navigateFocus(direction) {
            const newIndex = currentNewsIndex + direction;
            if (newIndex >= 0 && newIndex < fakeNewsData.length) {
                currentNewsIndex = newIndex;
                updateFocusContent();
            }
        }
        
        function updateFocusContent() {
            const item = fakeNewsData[currentNewsIndex];
            
            // Actualizar header
            document.getElementById('focus-source-img').src = `https://placehold.co/40x40/374151/FFFFFF?text=${item.source.charAt(0)}`;
            document.getElementById('focus-source-name').textContent = item.source;
            document.getElementById('focus-date').textContent = item.date;
            
            // Actualizar contenido
            document.getElementById('focus-image').src = item.image;
            document.getElementById('focus-title').textContent = item.title;
            
            const sentimentEl = document.getElementById('focus-sentiment');
            sentimentEl.className = `news-sentiment-tag text-sm ${item.sentiment.class}`;
            sentimentEl.innerHTML = `<i data-lucide="${item.sentiment.icon}" class="w-4 h-4 mr-1"></i> ${item.sentiment.text}`;
            
            const entitiesEl = document.getElementById('focus-entities');
            entitiesEl.innerHTML = item.entities.map(e => `<span class="${e.class} text-sm">${e.text}</span>`).join('');
            
            // (NUEVO) Añadir Análisis IA a Focus
            document.getElementById('focus-ai-analysis-content').innerHTML = item.aiAnalysis;

            document.getElementById('focus-body').innerHTML = item.content;
            
            // Actualizar botones de nav
            document.getElementById('focus-prev-btn').disabled = currentNewsIndex === 0;
            document.getElementById('focus-next-btn').disabled = currentNewsIndex === fakeNewsData.length - 1;
            
            // Scroll al inicio
            document.getElementById('focus-content-container').scrollTop = 0;
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        // ==================================================================
        // == FIN: LÓGICA DEMO INTERACTIVA DE NOTICIAS ==
        // ==================================================================


        // Iniciar la aplicación
        initApp();
    </script>

</body>
</html>
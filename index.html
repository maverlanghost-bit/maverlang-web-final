<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maverlang - La Nueva Era del Análisis Financiero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- TradingView Widget Script -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    <style>
        :root {
            --bg-light: #f4f4f5; --text-light: #18181b; --border-light: #e4e4e7;
            --bg-dark: #0A0A0A; --text-dark: #f9fafb; --border-dark: #27272a;
            --accent-blue: #3b82f6;
            --accent-red: #ef4444;
            --success-color: #22c55e;
            --success-glow: rgba(34, 197, 94, 0.4);
            --warning-color: #f59e0b;
            --bg-active-theme-light: #e4e4e7;
            --bg-active-theme-dark: #27272a;
            --particle-color-1: rgba(59, 130, 246, 0.9);
            --particle-color-2: rgba(96, 165, 250, 0.7);
            --particle-color-3: rgba(255, 255, 255, 0.8);
        }
        html.dark {
            --bg-main: var(--bg-dark); --text-main: var(--text-dark); --border-main: var(--border-dark);
            --success-glow: rgba(34, 197, 94, 0.5);
        }
        html:not(.dark) { --bg-main: var(--bg-light); --text-main: var(--text-light); --border-main: var(--border-light); }

        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow-y: auto;
        }
        
        body.no-scroll { overflow: hidden; }

        /* Scroll Reveal Animation */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
            will-change: opacity, transform;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        main.hero-section { padding-bottom: 4rem; }

        .background-logo-text {
            font-size: clamp(8rem, 25vw, 22rem); font-weight: 800; letter-spacing: -0.05em;
            color: rgba(120, 120, 120, 0.05); position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); z-index: 1; pointer-events: none;
        }
        html.dark .background-logo-text { color: rgba(255, 255, 255, 0.03); }

        .chat-input-container {
            background-color: #1c1c1c; border: 1px solid #333; min-height: 88px; border-radius: 1.5rem;
        }
        html:not(.dark) .chat-input-container {
            background-color: #ffffff; border: 1px solid var(--border-light);
        }

        #typing-cursor {
            display: inline-block; width: 3px; height: 1.5em; background-color: var(--accent-blue);
            animation: blink 1s step-end infinite; vertical-align: bottom;
        }
        @keyframes blink { 50% { opacity: 0; } }

        .countdown-box, .form-container, .llm-card-small {
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-radius: 1rem;
        }
        html.dark .countdown-box, html.dark .form-container, html.dark .llm-card-small {
            background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html:not(.dark) .countdown-box, html:not(.dark) .form-container, html:not(.dark) .llm-card-small {
            background: rgba(255, 255, 255, 0.7); border: 1px solid var(--border-light);
        }

        .theme-main-btn, .theme-dropdown-btn {
            padding: 0.5rem; border-radius: 9999px;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex; align-items: center; justify-content: center;
        }
        .theme-main-btn i, .theme-dropdown-btn i { width: 1.25rem; height: 1.25rem; }
        .theme-main-btn:hover, .theme-dropdown-btn:hover { background-color: rgba(120, 120, 120, 0.1); }
        .theme-dropdown-btn.active { background-color: var(--bg-active-theme-light); color: var(--text-main); }
        html.dark .theme-dropdown-btn.active { background-color: var(--bg-active-theme-dark); }

        .countdown-number { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 600; line-height: 1; color: var(--text-main); }
        .countdown-label { font-size: 0.65rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-main); opacity: 0.6; }

        #fomo-counter { font-size: 1rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: -1rem; opacity: 0; transition: opacity 0.5s ease; }
        #fomo-counter.visible { opacity: 1; }
        #whitelist-count { display: inline-block; color: var(--accent-blue); font-weight: 700; padding: 0 0.25rem; min-width: 1em; }

        #ai-mode-menu { transition: opacity 0.2s ease, transform 0.2s ease, max-height 0.3s ease-in-out; }
        .llm-card-small { transition: border-color 0.2s ease, box-shadow 0.2s ease; cursor: pointer; }
        .llm-card-small:hover, .llm-card-small.selected { border-color: var(--accent-blue); box-shadow: 0 0 10px 0 rgba(59, 130, 246, 0.4); }

        .tutor-toggle-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .tutor-toggle-switch input { opacity: 0; width: 0; height: 0; }
        .tutor-toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4b5563; transition: .4s; border-radius: 22px; }
        .tutor-toggle-slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .tutor-toggle-slider { background-color: var(--accent-blue); }
        input:checked + .tutor-toggle-slider:before { transform: translateX(18px); }

        .testimonial-card, .modal-content, .feature-card, .news-visual-card {
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-radius: 1rem;
        }
        html.dark .testimonial-card, html.dark .modal-content, html.dark .feature-card, html.dark .news-visual-card {
            background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html:not(.dark) .testimonial-card, html:not(.dark) .modal-content, html:not(.dark) .feature-card, html:not(.dark) .news-visual-card {
            background: rgba(255, 255, 255, 0.7); border: 1px solid var(--border-light);
        }

        #testimonials-container {
            padding-left: 10rem; padding-right: 10rem;
            mask-image: linear-gradient(to right, transparent 0%, black 15%, black 85%, transparent 100%);
            -webkit-mask-image: linear-gradient(to right, transparent 0%, black 15%, black 85%, transparent 100%);
        }
        @media (max-width: 767px) { #testimonials-container { padding-left: 1rem; padding-right: 1rem; } }

        .testimonial-track { width: calc(350px * 8); animation: scroll 40s linear infinite; margin-left: 0; margin-right: 0; padding-top: 1.5rem; padding-bottom: 1.5rem; }
        .testimonial-track .testimonial-card { width: 350px; flex-shrink: 0; margin: 0 0.75rem; transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease; cursor: pointer; border: 1px solid transparent; }
        .testimonial-track .testimonial-card:hover { border-color: var(--accent-blue); box-shadow: 0 0 15px 0 rgba(59, 130, 246, 0.5); transform: scale(1.02); background-color: var(--bg-main); }
        .testimonial-track:hover { animation-play-state: paused; }
        @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }

        #whitelist-modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        #whitelist-modal .modal-content { transition: transform 0.3s ease; }

        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 12px rgba(59, 130, 246, 0.4); transform: scale(1); } 50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8); transform: scale(1.03); } }
        .animated-whitelist-btn { animation: pulse-glow 2.5s infinite ease-in-out; }

        #tv-widget-container { height: 350px; position: relative; }
        .widget-action-btn { opacity: 0.6; cursor: default; }

        /* Ajuste para el nuevo widget de TradingView para que ocupe todo el contenedor */
        .tradingview-widget-container {
            height: 100% !important;
            width: 100% !important;
        }
        .tradingview-widget-container iframe {
            height: 100% !important;
            width: 100% !important;
        }

        /* Estilos sección Aprendelo Tabs */
        #aprendelo-tabs-triggers::-webkit-scrollbar { display: none; } #aprendelo-tabs-triggers { scrollbar-width: none; }
        
        .aprendelo-tab-trigger {
            display: flex; align-items: center; gap: 1rem; padding: 1rem 1.5rem; 
            border: 1px solid var(--border-main); border-radius: 1rem; 
            background-color: var(--bg-main); transition: all 0.2s ease; cursor: pointer; margin: 0.5rem;
        }
        .aprendelo-tab-trigger:hover { border-color: var(--accent-blue); background-color: rgba(59, 130, 246, 0.05); transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); }
        html.dark .aprendelo-tab-trigger:hover { box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        .aprendelo-tab-trigger.active { border-color: var(--accent-blue); background-color: rgba(59, 130, 246, 0.25); box-shadow: 0 0 15px 0 rgba(59, 130, 246, 0.4); transform: translateY(-1px); }
        .aprendelo-tab-trigger .trigger-icon { padding: 1rem; border-radius: 0.75rem; display: inline-flex; flex-shrink: 0; }
        .aprendelo-tab-trigger[data-content-id="desafio"] .trigger-icon { background-color: rgba(239, 68, 68, 0.1); }
        .aprendelo-tab-trigger[data-content-id="cursos"] .trigger-icon { background-color: rgba(59, 130, 246, 0.1); }
        .aprendelo-tab-trigger[data-content-id="examenes"] .trigger-icon { background-color: rgba(34, 197, 94, 0.1); }
        
        #aprendelo-tab-content-area {
            transition: padding-top 0.3s ease-out, padding-bottom 0.3s ease-out, margin-top 0.3s ease-out;
            margin-top: 2.5rem; padding: 3rem 1rem; border-radius: 1rem; border: 1px solid var(--border-main);
            background: rgba(30, 30, 30, 0.5); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            opacity: 1; display: grid; grid-template-columns: 1fr; gap: 2rem; align-items: start;
        }
        html:not(.dark) #aprendelo-tab-content-area { background: rgba(255, 255, 255, 0.5); }
        @media (min-width: 768px) { #aprendelo-tab-content-area { grid-template-columns: 1fr 1fr; } #aprendelo-text-content { grid-column: span 1; } #aprendelo-visuals-container { grid-column: span 1; margin-left: auto; margin-right: auto; } }
        
        #aprendelo-text-content { transition: opacity 0.3s ease-in-out; opacity: 0; }
        #aprendelo-text-content p { font-size: 0.95rem; line-height: 1.6; }

        #aprendelo-visuals-container { position: relative; width: 100%; min-height: 350px; }
        .aprendelo-visual {
            position: absolute; top: 0; left: 0; width: 100%; max-width: 380px; margin-left: auto; margin-right: auto; border: 1px solid var(--border-main);
            border-radius: 0.75rem; background-color: var(--bg-main); opacity: 0; transition: opacity 0.3s ease-in-out; pointer-events: none; display: block;
        }
        .aprendelo-visual.active { opacity: 1; pointer-events: auto; }
        #visual-cursos.aprendelo-visual { max-width: none; border: none !important; background-color: transparent !important; padding: 0; height: auto; }

        #visual-desafio { padding: 1.5rem; display: flex; justify-content: center; align-items: center; height: 350px; }
        .learning-path { position: relative; display: flex; flex-direction: column; align-items: center; gap: 1.5rem; transform: scale(0.9); width: 100px; padding: 1rem 0; }
        .path-node { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; border: 4px solid var(--bg-main); box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 2; position: relative; }
        .path-node.completed { background-color: var(--success-color); }
        .path-node.unlocked { background-color: var(--accent-blue); animation: pulse-node 1.5s infinite; }
        .path-node.locked { background-color: #6b7280; opacity: 0.7; }
        .learning-path::before { content: ''; position: absolute; top: 30px; bottom: 30px; left: 50%; transform: translateX(-50%); width: 5px; background-color: var(--border-main); border-radius: 3px; z-index: 1; }
        @keyframes pulse-node { 0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); } 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); } }

        .faux-video-player-container {
            position: relative; width: 100%; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 0.5rem; box-shadow: 0 5px 15px rgba(0,0,0,0.2); background-color: #222;
        }
        .faux-video-player-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        #visual-examenes { padding: 1.5rem; text-align: center; }
        #visual-examenes .summary-icon { width: 64px; height: 64px; border-radius: 50%; background-color: rgba(34, 197, 94, 0.1); color: var(--success-color); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; }
        #visual-examenes h4 { font-size: 1.25rem; font-weight: 700; }
        #visual-examenes p { opacity: 0.8; }
        .faux-summary-score { font-size: 1.875rem; font-weight: 800; margin: 0.75rem 0; }
        .exam-progress-bar { width: 80%; height: 8px; background-color: var(--border-main); border-radius: 4px; margin: 1rem auto; overflow: hidden; }
        .exam-progress-fill { width: 80%; height: 100%; background-color: var(--success-color); border-radius: 4px; }
        .faux-summary-btn { width: 100%; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; margin-top: 0.5rem; transition: background-color 0.2s; }
        .faux-btn-primary { background-color: var(--accent-blue); color: white; }
        .faux-btn-primary:hover { background-color: #2563eb; }

        #portafolio-visual-card {
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-radius: 1rem; transition: all 0.3s ease; padding: 0; overflow: hidden;
            background-image: linear-gradient(to bottom right, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
        }
        html:not(.dark) #portafolio-visual-card { background-image: linear-gradient(to bottom right, rgba(0,0,0,0.02), rgba(0,0,0,0.01)); border: 1px solid var(--border-light); }
        html.dark #portafolio-visual-card { border: 1px solid rgba(255, 255, 255, 0.1); }
        #portafolio-visual-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        html.dark #portafolio-visual-card:hover { box-shadow: 0 10px 25px rgba(0,0,0,0.3); }

        .portfolio-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-main); }
        .portfolio-header h4 { font-size: 1.125rem; font-weight: 600; }
        .portfolio-header p { font-size: 0.875rem; opacity: 0.7; }
        .portfolio-table-row { display: grid; grid-template-columns: 1fr auto; gap: 1rem; padding: 1rem 1.5rem; align-items: center; border-bottom: 1px solid var(--border-main); transition: background-color 0.2s ease; }
        .portfolio-table-row:hover { background-color: rgba(120,120,120,0.05); }
        .portfolio-table-row:last-child { border-bottom: none; }
        .asset-name { font-weight: 600; font-size: 1rem; display: inline-flex; align-items: center; }
        .asset-type-long, .asset-type-short { display: inline-flex; align-items: center; gap: 0.25rem; font-size: 0.7rem; font-weight: 700; padding: 0.1rem 0.5rem; border-radius: 99px; margin-left: 0.5rem; }
        .asset-type-long { background-color: rgba(34, 197, 94, 0.1); color: var(--success-color); }
        .asset-type-short { background-color: rgba(239, 68, 68, 0.1); color: var(--accent-red); }
        .asset-pl { text-align: right; }
        .asset-pl .pl-value { font-weight: 600; font-size: 1rem; }
        .asset-pl .pl-percent { font-size: 0.8rem; }
        .pl-positive { color: var(--success-color); }
        .pl-negative { color: var(--accent-red); }
        .portfolio-summary { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; padding: 1.5rem 1.5rem; border-top: 1px solid var(--border-main); margin-top: 0; background-color: rgba(120,120,120,0.03); }
        html.dark .portfolio-summary { background-color: rgba(0,0,0,0.1); }
        .summary-item .label { font-size: 0.8rem; opacity: 0.7; margin-bottom: 0.25rem; }
        .summary-item .value { font-size: 1.25rem; font-weight: 700; }

        .nav-dropdown-menu, .theme-dropdown-menu { position: absolute; top: calc(100% + 1rem); left: 0; width: 220px; padding: 0.5rem; border-radius: 1rem; z-index: 100; transition: all 0.2s ease-out; transform-origin: top left; background-color: var(--bg-main); }
        .theme-dropdown-menu { width: auto; min-width: 50px; left: auto; right: 0; transform-origin: top right; display: flex; flex-direction: column; gap: 0.25rem; }
        html.dark .nav-dropdown-menu, html.dark .theme-dropdown-menu { border: 1px solid var(--border-dark); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        html:not(.dark) .nav-dropdown-menu, html:not(.dark) .theme-dropdown-menu { border: 1px solid var(--border-light); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .nav-dropdown-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.75rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.5rem; transition: background-color 0.2s ease; cursor: pointer; }
        .nav-dropdown-item:hover { background-color: rgba(120,120,120,0.1); }
        .nav-dropdown-item i { opacity: 0.7; }
        
        #nav-portafolio-ai-link { position: relative; overflow: visible; padding: 0.25rem 0.5rem; cursor: pointer; }
        #nav-portafolio-ai-link span { position: relative; z-index: 1; display: inline-block; animation: text-color-slow-pulse 5s ease-in-out infinite; }
        .particles-container { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
        .particle { position: absolute; bottom: 2px; left: 50%; width: 3px; height: 3px; border-radius: 50%; opacity: 0; animation: particle-fall 2.5s ease-out infinite; animation-delay: calc(var(--particle-delay) * 1s); background-color: var(--particle-color); }
        @keyframes text-color-slow-pulse { 0%, 100% { color: inherit; } 40% { color: var(--accent-blue); } 60% { color: var(--accent-blue); } }
        @keyframes particle-fall { 0% { opacity: 0; transform: translate(-50%, 0) scale(0.3); } 50% { opacity: 1; transform: translate(calc(-50% + var(--particle-x)), calc(var(--particle-y) - 5px)) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + var(--particle-x) * 1.2), calc(var(--particle-y) - 15px)) scale(0); } }

        .news-sentiment-tag { display: inline-flex; align-items: center; padding: 0.1rem 0.5rem; border-radius: 99px; font-size: 0.7rem; font-weight: 600; margin-right: 0.25rem; }
        .news-sentiment-positive { background-color: rgba(34, 197, 94, 0.1); color: var(--success-color); }
        .news-sentiment-negative { background-color: rgba(239, 68, 68, 0.1); color: var(--accent-red); }
        .news-sentiment-neutral { background-color: rgba(107, 114, 128, 0.1); color: #6b7280; }
        html.dark .news-sentiment-neutral { color: #9ca3af; }
        .news-entity-tag { display: inline-block; background-color: rgba(59, 130, 246, 0.1); color: var(--accent-blue); padding: 0.1rem 0.5rem; border-radius: 99px; font-size: 0.7rem; font-weight: 600; margin-right: 0.25rem; }
        html:not(.dark) .news-entity-tag { color: #2563eb; }

        #chat-response-container { display: none; transition: opacity 0.3s ease-in-out; opacity: 0; }
        #chat-response-container.visible { display: block; opacity: 1; }
        #thinking-indicator { display: flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 1.5rem; height: 88px; }
        .dot-flashing { width: 10px; height: 10px; border-radius: 50%; background-color: var(--accent-blue); animation: dot-flashing 1.4s infinite linear both; }
        .dot-flashing:nth-child(1) { animation-delay: 0s; }
        .dot-flashing:nth-child(2) { animation-delay: 0.2s; }
        .dot-flashing:nth-child(3) { animation-delay: 0.4s; }
        @keyframes dot-flashing { 0%, 80%, 100% { opacity: 0; transform: scale(0.8); } 40% { opacity: 1; transform: scale(1.2); } }
        #ai-response-card { display: none; background-color: var(--bg-main); border: 1px solid var(--border-main); padding: 1.5rem; border-radius: 1rem; max-width: 48rem; margin: 0 auto; text-align: left; }
        #ai-response-card .highlight { color: var(--accent-blue); font-weight: 600; }
        #ai-response-card em { font-style: italic; opacity: 0.8; }
        #response-cta-button { background-color: var(--accent-blue); color: white; margin-top: 1.5rem; display: inline-block; }

        #mobile-menu-panel { background-color: var(--bg-main); transition: opacity 0.3s ease-in-out; }
        #mobile-menu-panel .nav-link { display: block; font-size: 1.5rem; font-weight: 700; padding: 0.75rem 0; border-bottom: 1px solid var(--border-main); color: var(--text-main); transition: color 0.2s ease; }
        #mobile-menu-panel .nav-link:hover { color: var(--accent-blue); }
        #mobile-menu-panel .nav-link-sub { display: flex; align-items: center; gap: 0.75rem; font-size: 1.125rem; font-weight: 600; padding: 0.75rem 0; color: var(--text-main); opacity: 0.8; transition: color 0.2s ease; }
        #mobile-menu-panel .nav-link-sub:hover { color: var(--accent-blue); opacity: 1; }
        #mobile-menu-panel .nav-link-sub i { width: 1.25rem; height: 1.25rem; }

        #bottom-left-banner { background-color: var(--bg-main); border: 1px solid var(--border-main); transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; opacity: 0; transform: translateY(20px); }
        #bottom-left-banner.visible { opacity: 1; transform: translateY(0); }

    </style>
</head>
<body class="overflow-y-auto">

    <!-- Contenedor de la página --><div id="page-wrapper" class="overflow-x-hidden">

        <!-- Contenido Principal --><div id="main-content">

            <!-- Header con Navegación a la Derecha -->
            <header class="fixed top-0 left-0 right-0 z-50 p-4 transition-colors duration-300">
                 <div class="container mx-auto flex justify-between items-center bg-white/30 dark:bg-black/30 backdrop-blur-md p-3 rounded-full border border-white/10 shadow-sm">
                     <!-- Logo -->
                     <a href="index.html" class="text-xl font-bold tracking-wider ml-2 flex-shrink-0">MAVERLANG</a>
                     
                     <!-- Contenedor Derecha: Navegación, Botón Prioritario, Tema -->
                     <div class="flex items-center gap-4 lg:gap-6 mx-4">
                         <!-- Navegación Principal (Oculta en móvil) -->
                         <nav class="hidden md:flex items-center gap-4 lg:gap-6">
                             
                             <!-- Orden Actualizado -->
                             <a href="index.html" class="font-bold text-sm text-blue-600 transition-opacity">Inicio</a>
                             <a href="noticias.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Noticias</a>
                             <a href="mercados.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Mercados</a>
                             <!-- Portafolio AI con Animación Partículas Lentas -->
                             <a href="portafolioAI.html" id="nav-portafolio-ai-link" class="font-semibold text-sm transition-opacity relative"> 
                                 <span>Portafolio AI</span> 
                                 <div class="particles-container"></div>
                             </a>
                             <!-- Dropdown Funciones -->
                             <div class="relative" id="nav-funciones-dropdown">
                                 <button id="nav-funciones-btn" class="flex items-center gap-1 font-semibold text-sm hover:opacity-70 transition-opacity">
                                     <span>Funciones</span>
                                     <i data-lucide="chevron-down" class="w-4 h-4"></i>
                                 </button>
                                 <div id="nav-funciones-menu" class="nav-dropdown-menu invisible opacity-0 scale-95">
                                     <a href="seguimiento.html" class="nav-dropdown-item"><i data-lucide="activity" class="w-4 h-4"></i><span>Seguimiento</span></a>
                                     <a href="aprendelo.html" class="nav-dropdown-item"><i data-lucide="book-open-check" class="w-4 h-4"></i><span>Apréndelo</span></a>
                                     <a href="portafolio.html" class="nav-dropdown-item"><i data-lucide="briefcase" class="w-4 h-4"></i><span>Portafolio Virtual</span></a>
                                     <a href="chats.html" class="nav-dropdown-item"><i data-lucide="message-square" class="w-4 h-4"></i><span>Chats</span></a>
                                     <a href="mercados.html" class="nav-dropdown-item"><i data-lucide="line-chart" class="w-4 h-4"></i><span>Mercados</span></a>
                                 </div>
                             </div>

                         </nav>
                         
                         <!-- Botón Acceso Prioritario (Oculto en móvil) -->
                         <button id="header-whitelist-btn" class="bg-blue-600 text-white font-semibold rounded-full px-4 py-2 text-sm transition-transform hover:scale-105 animated-whitelist-btn whitespace-nowrap hidden md:flex">
                             Acceso Prioritario
                         </button>
    
                         <!-- Controles de Tema (Dropdown) -->
                         <div class="relative" id="theme-selector">
                             <button id="theme-main-btn" class="theme-main-btn p-1.5 rounded-full border" style="border-color: var(--border-main);">
                                 <i data-lucide="sun"></i> <!-- Ícono se actualiza con JS -->
                             </button>
                             <div id="theme-dropdown-menu" class="theme-dropdown-menu invisible opacity-0 scale-95 p-1 border" style="border-color: var(--border-main);">
                                  <button data-theme="light" title="Tema Claro" class="theme-dropdown-btn"><i data-lucide="sun"></i></button>
                                  <button data-theme="dark" title="Tema Oscuro" class="theme-dropdown-btn"><i data-lucide="moon"></i></button>
                             </div>
                         </div>

                         <!-- Botón de Menú Móvil -->
                         <button id="mobile-menu-btn" class="p-2 rounded-full md:hidden" style="border-color: var(--border-main);">
                            <i data-lucide="menu" class="w-6 h-6"></i>
                         </button>
                     </div>
                 </div>
            </header>

            <!-- Panel de Menú Móvil -->
            <div id="mobile-menu-panel" class="fixed inset-0 z-40 flex flex-col p-6 pt-24 md:hidden hidden opacity-0" style="background-color: var(--bg-main);">
                <button id="mobile-menu-close-btn" class="absolute top-7 right-7 p-2 rounded-full hover:bg-gray-500/10">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
                <nav class="flex flex-col gap-2 mb-8">
                    <a href="index.html" class="nav-link" style="border-top: 1px solid var(--border-main);">Inicio</a>
                    <a href="noticias.html" class="nav-link">Noticias</a>
                    <a href="mercados.html" class="nav-link">Mercados</a>
                    <a href="portafolioAI.html" class="nav-link">Portafolio AI</a>
                    
                    <h4 class="mt-6 mb-2 text-sm font-semibold uppercase text-gray-500">Funciones</h4>
                    <a href="seguimiento.html" class="nav-link-sub">
                        <i data-lucide="activity"></i><span>Seguimiento</span>
                    </a>
                    <a href="aprendelo.html" class="nav-link-sub">
                        <i data-lucide="book-open-check"></i><span>Apréndelo</span>
                    </a>
                    <a href="portafolio.html" class="nav-link-sub">
                        <i data-lucide="briefcase"></i><span>Portafolio Virtual</span>
                    </a>
                    <a href="chats.html" class="nav-link-sub">
                        <i data-lucide="message-square"></i><span>Chats</span>
                    </a>
                </nav>
                <div class="mt-auto">
                    <button id="mobile-whitelist-btn" class="modal-trigger-btn bg-blue-600 text-white font-semibold rounded-full w-full py-4 text-lg animated-whitelist-btn">
                        Acceso Prioritario
                    </button>
                </div>
            </div>

            <!-- Sección Hero --><main class="hero-section relative flex flex-col items-center justify-center text-center p-4 overflow-hidden">
                <div class="background-logo-text">MAVERLANG</div>

                <div class="relative z-10 pt-[18vh]">
                    <div class="z-10 mb-8 text-center max-w-3xl reveal">
                        <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight">
                            La Nueva Era del Análisis Financiero
                        </h1>
                        <p class="mt-4 text-lg md:text-xl opacity-80">
                            Nuestra IA multi-agente te dará una ventaja sin precedentes en los mercados.
                        </p>
                    </div>

                    <!-- Simulación de Chat -->
                    <div id="faux-chat-container" class="w-full max-w-3xl z-10 relative reveal">
                        <div id="chat-input-container" class="chat-input-container flex items-center p-3 transition-shadow duration-200 focus-within:shadow-md">
                            <button id="ai-mode-btn" title="Ver modos de IA" class="p-2 rounded-full hover:bg-gray-500/10 transition-colors flex-shrink-0"><i data-lucide="plus" class="w-6 h-6 text-gray-500 dark:text-gray-400"></i></button>
                            <div class="relative flex-1 px-4 text-left text-lg">
                                <div id="placeholder-container" class="absolute inset-0 flex items-center pointer-events-none transition-opacity duration-300"><span id="typing-text" class="text-gray-400"></span><span id="typing-cursor"></span></div>
                                <input type="text" id="chat-input" class="w-full h-full bg-transparent text-main focus:outline-none relative z-10" />
                            </div>
                            <button id="mic-btn" title="Hablar con IA (Demo)" class="p-2 rounded-full hover:bg-gray-500/10 transition-colors flex-shrink-0"><i data-lucide="mic" class="w-6 h-6 text-gray-500 dark:text-gray-400"></i></button>
                            <button id="send-btn" title="Enviar (Demo)" class="p-2 rounded-full bg-blue-600 text-white transition-colors flex-shrink-0"><i data-lucide="arrow-up" class="w-6 h-6"></i></button>
                        </div>

                        <!-- Menú de Modos de IA --><div id="ai-mode-menu" class="absolute bottom-full mb-2 left-0 w-72 p-2 shadow-lg rounded-2xl border origin-bottom-left scale-95 opacity-0 invisible overflow-hidden" style="background: var(--bg-main); border-color: var(--border-main); max-height: 500px;">
                            <div id="ai-menu-main-view">
                                <div class="p-2 space-y-3">
                                    <div id="tutor-toggle-container" class="modal-trigger-btn flex justify-between items-center cursor-pointer p-2 rounded-md hover:bg-gray-500/10"><span class="font-semibold text-sm">Modo Tutor</span><label class="tutor-toggle-switch"><input type="checkbox"><span class="tutor-toggle-slider"></span></label></div>
                                    <button id="llm-selector-header" class="w-full text-left flex justify-between items-center text-sm font-semibold hover:opacity-80"><span id="llm-selector-label">GPT-5 (Predeterminado)</span><i data-lucide="chevron-right" class="w-4 h-4 transition-transform"></i></button>
                                </div>
                                <hr class="my-2" style="border-color: var(--border-main);">
                                <div class="mt-2 space-y-1">
                                    <button class="modal-trigger-btn w-full text-left flex items-center space-x-3 text-sm p-2 rounded-md hover:bg-gray-500/10"><i data-lucide="users" class="w-5 h-5"></i><span>Modo Debate</span></button>
                                    <button class="modal-trigger-btn w-full text-left flex items-center space-x-3 text-sm p-2 rounded-md hover:bg-gray-500/10"><i data-lucide="zap" class="w-5 h-5"></i><span>Modo Rápido</span></button>
                                    <button class="modal-trigger-btn w-full text-left flex items-center space-x-3 text-sm p-2 rounded-md hover:bg-gray-500/10"><i data-lucide="file-text" class="w-5 h-5"></i><span>Análisis Fundamental</span></button>
                                    <button class="modal-trigger-btn w-full text-left flex items-center space-x-3 text-sm p-2 rounded-md hover:bg-gray-500/10"><i data-lucide="trending-up" class="w-5 h-5"></i><span>Análisis Técnico</span></button>
                                </div>
                            </div>
                            <div id="llm-options-view" class="hidden">
                                <button id="llm-back-btn" class="w-full text-left flex items-center space-x-2 text-sm p-2 rounded-md hover:bg-gray-500/10 mb-2">
                                    <i data-lucide="chevron-left" class="w-4 h-4"></i>
                                    <span class="font-semibold">Volver</span>
                                </button>
                                <div id="llm-options" class="mt-2 grid grid-cols-2 gap-2"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Contenedor de Respuesta del Chat -->
                    <div id="chat-response-container" class="w-full max-w-3xl z-10 relative mt-4 mb-16 px-4 mx-auto">
                        <!-- Indicador de "Pensando" -->
                        <div id="thinking-indicator" class="h-[88px] w-full" style="display: none;">
                            <div class="dot-flashing"></div>
                            <div class="dot-flashing"></div>
                            <div class="dot-flashing"></div>
                        </div>
                        <!-- Tarjeta de Respuesta -->
                        <div id="ai-response-card" class="feature-card text-center" style="display: none;">
                            <p id="ai-response-text" class="text-lg"></p> 
                            <!-- El contenido se inyectará dinámicamente -->
                            <button id="response-cta-button" class="modal-trigger-btn font-semibold rounded-full px-6 py-3 text-base transition-transform hover:scale-105 animated-whitelist-btn" style="opacity: 0; transition: opacity 0.5s;">
                                Obtener Acceso Prioritario
                            </button>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- Sección de Confianza -->
            <section id="trust-signals" class="relative z-10 w-full pt-16 pb-16 md:pb-24 reveal">
                <div class="container mx-auto max-w-screen-xl px-4">
                    <div class="text-center mb-12 max-w-3xl mx-auto">
                        <h2 class="text-3xl md:text-4xl font-bold tracking-tight">Tu Ventaja Analítica de Nivel Profesional</h2>
                        <p class="text-lg opacity-80 mt-4">Construido con tecnología en la que puedes confiar.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="text-center p-4">
                            <i data-lucide="database" class="w-10 h-10 text-blue-500 mx-auto mb-4"></i>
                            <h3 class="font-semibold text-lg mb-2">Datos en Tiempo Real</h3>
                            <p class="opacity-70 text-sm">Conectados a más de 5,000 fuentes de noticias, bolsas y reportes financieros globales.</p>
                        </div>
                        <div class="text-center p-4">
                            <i data-lucide="brain-circuit" class="w-10 h-10 text-purple-500 mx-auto mb-4"></i>
                            <h3 class="font-semibold text-lg mb-2">IA Multi-Agente</h3>
                            <p class="opacity-70 text-sm">No usamos una sola IA. Usamos un equipo de modelos (GPT-5, Gemini 2.5) que debaten para encontrar la mejor respuesta.</p>
                        </div>
                        <div class="text-center p-4">
                            <i data-lucide="shield-check" class="w-10 h-10 text-green-500 mx-auto mb-4"></i>
                            <h3 class="font-semibold text-lg mb-2">Seguridad y Privacidad</h3>
                            <p class="opacity-70 text-sm">Tus estrategias y portafolios son tuyos. Usamos encriptación de nivel bancario para proteger tus datos.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- (NUEVO) Bento Grid - El Ecosistema -->
            <section id="ecosystem" class="relative z-10 w-full pt-12 pb-16 reveal">
                <div class="container mx-auto max-w-screen-xl px-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold tracking-tight mb-4">El Ecosistema Completo</h2>
                        <p class="text-lg opacity-80">Todo lo que necesitas para invertir mejor, en un solo lugar.</p>
                    </div>
                    <div class="bento-grid grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Card 1: Grande -->
                        <div class="bento-card large md:col-span-2 bg-white/5 p-8 rounded-2xl border border-white/10 relative overflow-hidden group">
                            <div class="relative z-10">
                                <i data-lucide="trending-up" class="w-12 h-12 text-blue-500 mb-4"></i>
                                <h3 class="text-2xl font-bold mb-2">Análisis Profundo</h3>
                                <p class="opacity-80 max-w-md">Nuestra IA no solo lee noticias, entiende el contexto macroeconómico y detecta patrones ocultos en los gráficos antes que el mercado reaccione.</p>
                            </div>
                            <i data-lucide="trending-up" class="absolute -right-12 -bottom-12 w-64 h-64 text-blue-500/10 transform rotate-12 group-hover:scale-110 transition-transform duration-500"></i>
                        </div>
                        <!-- Card 2: Pequeña -->
                        <div class="bento-card bg-white/5 p-8 rounded-2xl border border-white/10 relative overflow-hidden group">
                            <div class="relative z-10">
                                <i data-lucide="zap" class="w-10 h-10 text-yellow-500 mb-4"></i>
                                <h3 class="text-xl font-bold mb-2">Velocidad Rayo</h3>
                                <p class="opacity-80 text-sm">Latencia ultra-baja para que nunca llegues tarde a una oportunidad.</p>
                            </div>
                            <i data-lucide="zap" class="absolute -right-6 -bottom-6 w-32 h-32 text-yellow-500/10 transform rotate-12 group-hover:scale-110 transition-transform duration-500"></i>
                        </div>
                        <!-- Card 3: Pequeña -->
                        <div class="bento-card bg-white/5 p-8 rounded-2xl border border-white/10 relative overflow-hidden group">
                            <div class="relative z-10">
                                <i data-lucide="globe" class="w-10 h-10 text-green-500 mb-4"></i>
                                <h3 class="text-xl font-bold mb-2">Global</h3>
                                <p class="opacity-80 text-sm">Cobertura de mercados en EE.UU., Europa, Asia y Cripto en una sola pantalla.</p>
                            </div>
                            <i data-lucide="globe" class="absolute -right-6 -bottom-6 w-32 h-32 text-green-500/10 transform rotate-12 group-hover:scale-110 transition-transform duration-500"></i>
                        </div>
                        <!-- Card 4: Grande -->
                        <div class="bento-card large md:col-span-2 bg-white/5 p-8 rounded-2xl border border-white/10 relative overflow-hidden group">
                            <div class="relative z-10">
                                <i data-lucide="lock" class="w-12 h-12 text-red-500 mb-4"></i>
                                <h3 class="text-2xl font-bold mb-2">Seguridad Institucional</h3>
                                <p class="opacity-80 max-w-md">Tus datos y estrategias están protegidos con los mismos estándares de encriptación que usan los grandes bancos de inversión internacionales.</p>
                            </div>
                            <i data-lucide="shield" class="absolute -right-12 -bottom-12 w-64 h-64 text-red-500/10 transform rotate-12 group-hover:scale-110 transition-transform duration-500"></i>
                        </div>
                    </div>
                </div>
            </section>

            <!-- (NUEVO) Comparativa "Antes vs Ahora" -->
            <section id="comparison" class="relative z-10 w-full pt-12 pb-16 reveal">
                <div class="container mx-auto max-w-screen-xl px-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold tracking-tight mb-4">Invertir Nunca Fue Tan Claro</h2>
                        <p class="text-lg opacity-80">La diferencia entre operar con ruido y operar con señal.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- The Old Way -->
                        <div class="comparison-card bad border border-red-500/20 bg-gradient-to-br from-red-500/5 to-transparent rounded-2xl p-8">
                            <h3 class="text-2xl font-bold mb-6 text-red-500 flex items-center gap-2">
                                <i data-lucide="x-circle" class="w-6 h-6"></i> La Manera Antigua
                            </h3>
                            <ul class="space-y-4">
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="x" class="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Hojas de cálculo infinitas, manuales y propensas a errores humanos.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="x" class="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Leer 50 noticias diarias y no saber cuál realmente mueve el precio.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="x" class="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Tomar decisiones impulsivas basadas en emociones, miedo (FOMO) o pánico.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="x" class="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Sentirse solo y aislado contra el mercado institucional.</span>
                                </li>
                            </ul>
                        </div>
                        <!-- The Maverlang Way -->
                        <div class="comparison-card good border border-green-500/20 bg-gradient-to-br from-green-500/5 to-transparent rounded-2xl p-8">
                            <h3 class="text-2xl font-bold mb-6 text-green-500 flex items-center gap-2">
                                <i data-lucide="check-circle-2" class="w-6 h-6"></i> Con Maverlang
                            </h3>
                            <ul class="space-y-4">
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="check" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Dashboards claros, visuales y automatizados que se actualizan solos.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="check" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Resúmenes de IA que filtran el ruido y te dan solo lo vital en segundos.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="check" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Estrategias basadas en datos puros, backtesting y probabilidades.</span>
                                </li>
                                <li class="flex items-start gap-3 opacity-80">
                                    <i data-lucide="check" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"></i>
                                    <span>Apoyo constante de una comunidad experta y asistentes inteligentes.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección de Testimonios -->
            <section id="testimonials" class="relative z-10 w-full pt-6 md:pt-8 pb-8 md:pb-12 overflow-hidden reveal" style="background-color: rgba(120, 120, 120, 0.03);"> 
                <div class="container mx-auto max-w-7xl text-center px-4">
                    <h2 class="text-3xl md:text-4xl font-bold tracking-tight mb-4">
                        Conoce a tus Analistas de IA
                    </h2>
                    
                    <p class="text-lg opacity-80 mb-12 max-w-3xl mx-auto">
                        Cada modelo tiene una "personalidad" única. Elige al analista que mejor se adapte a tu estilo de inversión.
                    </p>

                </div>
                <div id="testimonials-container" class="relative w-full overflow-hidden px-16">
                    <div class="testimonial-track flex py-4" style="margin-left: 0; margin-right: 0;">
                        <div class="testimonial-card p-6 rounded-2xl">
                            <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=WB" alt="IA de Valor" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Inversor de Valor (IA)</h3><p class="text-sm opacity-70">Filosofía: Warren Buffet</p></div>
                            </div>
                            <p class="text-main/90 italic">"Mi objetivo es encontrar 'fosos económicos' (moats). Analizo balances y reportes trimestrales para encontrar acciones subvaloradas con potencial a 10 años."</p>
                        </div>
                        <div class="testimonial-card p-6 rounded-2xl">
                            <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=EM" alt="IA Tecnológica" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Visionario Tecnológico (IA)</h3><p class="text-sm opacity-70">Filosofía: Disruptiva</p></div>
                            </div>
                            <p class="text-main/90 italic">"Busco la próxima revolución. Mi análisis se centra en patentes, innovación tecnológica y potencial de crecimiento exponencial. Pienso en el futuro."</p>
                        </div>
                        <div class="testimonial-card p-6 rounded-2xl">
                             <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=PL" alt="IA Ágil" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Gestor Ágil (IA)</h3><p class="text-sm opacity-70">Filosofía: Peter Lynch</p></div>
                            </div>
                            <p class="text-main/90 italic">"'Invierte en lo que conoces'. Analizo el sentimiento del consumidor y productos del día a día para encontrar las 'tenbaggers' que otros ignoran."</p>
                        </div>
                        <div class="testimonial-card p-6 rounded-2xl">
                            <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=RD" alt="IA Macro" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Analista Macro (IA)</h3><p class="text-sm opacity-70">Filosofía: Ray Dalio</p></div>
                            </div>
                            <p class="text-main/90 italic">"Entiendo el panorama general. Analizo ciclos económicos, tasas de interés y geopolítica para construir portafolios 'All-Weather' (Todo Clima)."</p>
                        </div>
                        <!-- Duplicados para el scroll infinito -->
                        <div class="testimonial-card p-6 rounded-2xl">
                            <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=WB" alt="IA de Valor" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Inversor de Valor (IA)</h3><p class="text-sm opacity-70">Filosofía: Warren Buffet</p></div>
                            </div>
                            <p class="text-main/90 italic">"Mi objetivo es encontrar 'fosos económicos' (moats). Analizo balances y reportes trimestrales para encontrar acciones subvaloradas con potencial a 10 años."</p>
                        </div>
                        <div class="testimonial-card p-6 rounded-2xl">
                            <div class="flex items-center mb-4">
                                <img src="https://placehold.co/48x48/e0e0e0/333?text=EM" alt="IA Tecnológica" class="w-12 h-12 rounded-full mr-4 border-2" style="border-color: var(--border-main);">
                                <div><h3 class="font-semibold">El Visionario Tecnológico (IA)</h3><p class="text-sm opacity-70">Filosofía: Disruptiva</p></div>
                            </div>
                            <p class="text-main/90 italic">"Busco la próxima revolución. Mi análisis se centra en patentes, innovación tecnológica y potencial de crecimiento exponencial. Pienso en el futuro."</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PASO 1: Apréndelo -->
            <section id="aprendelo" class="relative z-10 w-full pt-14 md:pt-16 pb-16 md:pb-24 reveal">
                <div class="container mx-auto max-w-screen-xl px-4">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                         <span class="text-blue-500 font-bold uppercase tracking-wider text-base">Paso 1: Domina los Conceptos</span>
                         <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">
                             Aprende a Invertir Jugando
                         </h2>
                         <p class="text-xl opacity-80">
                             Nuestra plataforma gamificada convierte la educación financiera en un desafío adictivo. Avanza por niveles, gana XP y domina el mercado.
                         </p>
                    </div>
                    
                    <div id="aprendelo-tabs-triggers" class="flex flex-wrap justify-center">
                        <button class="aprendelo-tab-trigger active" data-content-id="desafio">
                            <div class="trigger-icon"><i data-lucide="flame" class="w-7 h-7 text-red-500"></i></div>
                            <div><h3 class="text-lg font-semibold">Desafío Diario</h3><p class="text-sm opacity-70">Aprende con lecciones rápidas y rachas.</p></div>
                        </button>
                        <button class="aprendelo-tab-trigger" data-content-id="cursos">
                            <div class="trigger-icon"><i data-lucide="book-open-check" class="w-7 h-7 text-blue-500"></i></div>
                            <div><h3 class="text-lg font-semibold">Cursos con IA</h3><p class="text-sm opacity-70">Clases magistrales con un tutor IA.</p></div>
                        </button>
                        <button class="aprendelo-tab-trigger" data-content-id="examenes">
                            <div class="trigger-icon"><i data-lucide="file-check-2" class="w-7 h-7 text-green-500"></i></div>
                            <div><h3 class="text-lg font-semibold">Misiones Prácticas</h3><p class="text-sm opacity-70">Pon a prueba tu habilidad con exámenes reales.</p></div>
                        </button>
                    </div>
    
                    <div id="aprendelo-tab-content-area" class="feature-card">
                        <div id="aprendelo-text-content">
                            <!-- El contenido se inyectará con JS -->
                        </div>
                        <div id="aprendelo-visuals-container">
                            <!-- Visual: Desafío (Default) -->
                            <div id="visual-desafio" class="aprendelo-visual active">
                                <div class="learning-path"><div class="path-node completed"><i data-lucide="check" class="w-6 h-6"></i></div><div class="path-node unlocked"><i data-lucide="play" class="w-6 h-6"></i></div><div class="path-node locked"><i data-lucide="lock" class="w-6 h-6"></i></div><div class="path-node locked"><i data-lucide="lock" class="w-6 h-6"></i></div></div>
                            </div>
                            <!-- Visual: Cursos -->
                            <div id="visual-cursos" class="aprendelo-visual">
                                <div class="faux-video-player-container">
                                    <iframe src="https://www.youtube.com/embed/g_v11kWG8fE?si=sF8LgUf8pQJ-8aFv&amp;controls=0&amp;autoplay=1&amp;mute=1&amp;loop=1&amp;playlist=g_v11kWG8fE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture;" allowfullscreen></iframe>
                                </div>
                            </div>
                            <!-- Visual: Exámenes -->
                            <div id="visual-examenes" class="aprendelo-visual">
                                <div class="summary-icon"><i data-lucide="award" class="w-8 h-8"></i></div>
                                <h4>¡Misión Completada!</h4>
                                <p>Análisis Fundamental Nivel 1</p>
                                <div class="faux-summary-score text-green-500">92%</div>
                                <div class="exam-progress-bar"><div class="exam-progress-fill" style="width: 92%;"></div></div>
                                <button class="faux-summary-btn faux-btn-primary mt-4">Ver Certificado</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


            <!-- PASO 2: Sección Portafolio -->
            <section id="portafolio" class="relative z-10 w-full pt-4 md:pt-6 pb-16 md:pb-24 reveal">
                <div class="container mx-auto max-w-screen-2xl px-4 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <!-- Columna Izquierda: Visual del Portafolio --><div class="mt-8 md:mt-0 md:order-2">
                        <div id="portafolio-visual-card" class="shadow-lg">
                            <!-- Cabecera -->
                            <div class="portfolio-header">
                                <h4>Mi Portafolio de Pruebas</h4>
                                <p>Fondos Disponibles: $82,500.00</p>
                            </div>

                            <!-- Fila 1: Long (Ganancia) -->
                            <div class="portfolio-table-row">
                                <div>
                                    <span class="asset-name">
                                        AAPL
                                        <span class="asset-type-long">
                                            <i data-lucide="trending-up" class="w-3 h-3"></i>
                                            LARGO
                                        </span>
                                    </span>
                                    <p class="text-sm opacity-70 mt-1">10.0 Unidades @ $180.00</p>
                                </div>
                                <div class="asset-pl">
                                    <div class="pl-value pl-positive">+$450.00</div>
                                    <div class="pl-percent pl-positive">(+25.00%)</div>
                                </div>
                            </div>

                            <!-- Fila 2: Short (Pérdida) -->
                            <div class="portfolio-table-row">
                                <div>
                                    <span class="asset-name">
                                        BTC/USD
                                        <span class="asset-type-short">
                                            <i data-lucide="trending-down" class="w-3 h-3"></i>
                                            CORTO
                                        </span>
                                    </span>
                                    <p class="text-sm opacity-70 mt-1">0.05 Unidades @ $60,000</p>
                                </div>
                                <div class="asset-pl">
                                    <div class="pl-value pl-negative">-$150.00</div>
                                    <div class="pl-percent pl-negative">(-5.00%)</div>
                                </div>
                            </div>

                            <!-- Fila 3: Long (Pérdida) -->
                            <div class="portfolio-table-row">
                                <div>
                                     <span class="asset-name">
                                        SQM
                                        <span class="asset-type-long">
                                            <i data-lucide="trending-up" class="w-3 h-3"></i>
                                            LARGO
                                        </span>
                                    </span>
                                    <p class="text-sm opacity-70 mt-1">50.0 Unidades @ $70.00</p>
                                </div>
                                <div class="asset-pl">
                                    <div class="pl-value pl-negative">-$250.00</div>
                                    <div class="pl-percent pl-negative">(-7.14%)</div>
                                </div>
                            </div>

                            <!-- Resumen/Footer -->
                            <div class="portfolio-summary">
                                <div class="summary-item">
                                    <div class="label">Total Invertido</div>
                                    <div class="value">$8,550.00</div>
                                </div>
                                <div class="summary-item text-right md:text-left">
                                    <div class="label">G/P Total</div>
                                    <div class="value pl-positive">+$50.00</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Columna Derecha: Texto de Marketing -->
                    <div class="md:order-1">
                        <span class="text-green-500 font-bold uppercase tracking-wider text-base">Paso 2: Practica sin Riesgo</span>
                        <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">
                            Prueba tus Estrategias en un Entorno Real
                        </h2>
                        <p class="text-xl opacity-80 mb-8">
                            Te damos <strong>$100,000 virtuales</strong> para que operes con precios de mercado en vivo. Aprende a construir un portafolio, prueba ideas y domina el mercado sin arriesgar tu capital.
                        </p>
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <i data-lucide="trending-up" class="w-7 h-7 text-green-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Opera en Largo (Long)</h3><p class="opacity-70 text-base">Compra acciones o criptos y gana si el precio sube.</p></div>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="trending-down" class="w-7 h-7 text-red-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Domina el Corto (Short)</h3><p class="opacity-70 text-base">Aprende a "vender en corto" y gana si el precio baja. Una función avanzada que debes dominar.</p></div>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="layers" class="w-7 h-7 text-blue-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Acciones y Criptomonedas</h3><p class="opacity-70 text-base">Crea portafolios diversificados. Analizamos y simulamos todos los activos por ti.</p></div>
                            </li>
                             <li class="flex items-start">
                                <i data-lucide="folder-kanban" class="w-7 h-7 text-purple-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Múltiples Portafolios</h3><p class="opacity-70 text-base">Crea diferentes simulaciones para probar estrategias de largo plazo, trading o por sector.</p></div>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- PASO 3: Sección Noticias -->
            <section id="noticias" class="relative z-10 w-full pt-14 md:pt-16 pb-16 md:pb-24 reveal" style="background-color: rgba(120, 120, 120, 0.03);">
                 <div class="container mx-auto max-w-screen-2xl px-4 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                     <!-- Columna Izquierda: Visual Mockup -->
                     <div class="mt-8 md:mt-0 md:order-2">
                          <div class="news-visual-card p-4 rounded-2xl shadow-lg relative overflow-hidden">
                             <div class="absolute inset-0 bg-gradient-to-br from-blue-500/10 to-transparent dark:from-blue-900/20 dark:to-transparent opacity-50 -z-10"></div>
                             <h3 class="font-semibold mb-3 text-lg px-2 pt-1">Feed de Noticias Inteligente</h3>
                             <!-- Mockup de Tarjetas de Noticias -->
                             <div class="space-y-3 max-h-[400px] overflow-hidden relative">
                                  <div class="p-3 rounded-lg border flex flex-col gap-1.5" style="border-color: var(--border-main); background-color: var(--bg-main);">
                                     <h4 class="font-semibold text-sm leading-tight">Apple anuncia nuevo evento para Septiembre, se esperan iPhones.</h4>
                                     <div class="flex flex-wrap items-center gap-2 text-xs opacity-80">
                                         <span>Bloomberg</span> | <span>Hace 2h</span>
                                         <span class="news-sentiment-tag news-sentiment-positive"><i data-lucide="trending-up" class="w-3 h-3 mr-1"></i>Positivo</span>
                                         <span class="news-entity-tag">AAPL</span>
                                     </div>
                                 </div>
                                  <div class="p-3 rounded-lg border flex flex-col gap-1.5" style="border-color: var(--border-main); background-color: var(--bg-main);">
                                     <h4 class="font-semibold text-sm leading-tight">Reguladores europeos investigan App Store por posibles prácticas anticompetitivas.</h4>
                                     <div class="flex flex-wrap items-center gap-2 text-xs opacity-80">
                                         <span>Reuters</span> | <span>Hace 5h</span>
                                          <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-1"></i>Negativo</span>
                                          <span class="news-entity-tag">AAPL</span>
                                         <span class="news-entity-tag">EU</span>
                                     </div>
                                 </div>
                                  <div class="p-3 rounded-lg border flex flex-col gap-1.5" style="border-color: var(--border-main); background-color: var(--bg-main);">
                                     <h4 class="font-semibold text-sm leading-tight">Flujo de ETFs de Bitcoin muestra salidas netas por tercer día consecutivo.</h4>
                                     <div class="flex flex-wrap items-center gap-2 text-xs opacity-80">
                                         <span>CoinDesk</span> | <span>Hace 1h</span>
                                         <span class="news-sentiment-tag news-sentiment-negative"><i data-lucide="trending-down" class="w-3 h-3 mr-1"></i>Negativo</span>
                                          <span class="news-entity-tag">BTC</span>
                                         <span class="news-entity-tag">ETF</span>
                                     </div>
                                 </div>
                                  <!-- Fade out effect at the bottom -->
                                 <div class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-[var(--bg-secondary)] to-transparent"></div>
                             </div>
                             <p class="text-xs text-center mt-3 opacity-60">Visualización simplificada</de>
                         </div>
                     </div>
                     <!-- Columna Derecha: Texto de Marketing -->
                     <div class="md:order-1">
                         <span class="text-indigo-500 font-bold uppercase tracking-wider text-base">Paso 3: Infórmate en Tiempo Real</span>
                         <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">
                             El Mercado Habla. Nosotros Traducimos.
                         </h2>
                         <p class="text-xl opacity-80 mb-8">
                             No te pierdas ningún movimiento. Nuestro motor de noticias agrega y analiza información de fuentes clave <strong class="text-indigo-400">en tiempo real</strong>, dándote la ventaja que necesitas.
                         </p>
                         <ul class="space-y-4">
                             <li class="flex items-start">
                                 <i data-lucide="zap" class="w-7 h-7 text-indigo-500 mr-3 flex-shrink-0 mt-1"></i>
                                 <div><h3 class="font-semibold text-lg">Actualizaciones en Vivo</h3><p class="opacity-70 text-base">Recibe noticias cruciales de Marketaux, Finnhub y más, apenas se publican.</p></div>
                             </li>
                             <li class="flex items-start">
                                 <i data-lucide="scan-face" class="w-7 h-7 text-teal-500 mr-3 flex-shrink-0 mt-1"></i>
                                 <div><h3 class="font-semibold text-lg">Análisis de Sentimiento IA</h3><p class="opacity-70 text-base">Nuestra IA evalúa el impacto potencial (positivo, negativo, neutral) de cada noticia.</p></div>
                             </li>
                              <li class="flex items-start">
                                 <i data-lucide="tags" class="w-7 h-7 text-rose-500 mr-3 flex-shrink-0 mt-1"></i>
                                 <div><h3 class="font-semibold text-lg">Detección de Entidades</h3><p class="opacity-70 text-base">Identifica automáticamente las empresas, acciones y criptos mencionadas.</p></div>
                             </li>
                         </ul>
                     </div>
                 </div>
            </section>

            <!-- PASO 4: Sección Features/Seguimiento -->
            <section id="features" class="relative z-10 w-full pt-14 md:pt-16 pb-16 md:pb-24 reveal">
                <div class="container mx-auto max-w-screen-2xl px-4 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div>
                        <span class="text-blue-500 font-bold uppercase tracking-wider text-base">Paso 4: Opera con Superpoderes</span>
                        <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">
                            Tu Analista de IA, 24/7
                        </h2>
                        <p class="text-xl opacity-80 mb-8">
                            Define tus activos (acciones, criptos, y más) y deja que nuestra IA "Sentinel" los vigile por ti, segundo a segundo.
                        </p>
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <i data-lucide="newspaper" class="w-7 h-7 text-blue-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Escaneo de 5,000+ Fuentes</h3><p class="opacity-70 text-base">Monitoreamos las noticias más importantes en tiempo real.</p></div>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="smile-plus" class="w-7 h-7 text-green-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Análisis de Sentimiento</h3><p class="opacity-70 text-base">Te notificamos si una noticia es positiva o negativa para tu activo.</p></div>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="bell-ring" class="w-7 h-7 text-red-500 mr-3 flex-shrink-0 mt-1"></i>
                                <div><h3 class="font-semibold text-lg">Alertas Personalizadas</h3><p class="opacity-70 text-base">Recibe notificaciones por Email, WhatsApp, o App cuando un precio se mueve o una noticia impacta tu portafolio.</p></div>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-8 md:mt-0">
                        <div class="feature-card p-4 rounded-2xl shadow-lg" style="height: 450px;"> <!-- Aumenté un poco la altura para este widget -->
                            <!-- Widget Lazy Loaded Container -->
                            <div id="tv-widget-container" style="height: 100%; width: 100%;">
                                <div id="tv-widget-placeholder" class="w-full h-full flex items-center justify-center text-gray-500 flex-col gap-2">
                                    <div class="dot-flashing bg-gray-400"></div>
                                    <p class="text-sm opacity-70">Cargando Symbol Overview...</p>
                                </div>
                                <!-- El script inyectará el widget aquí -->
                            </div>
                            
                            <!-- Botones de control eliminados/ocultos ya que el widget tiene sus propios controles -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- (NUEVO) FAQ Section -->
            <section id="faq" class="relative z-10 w-full pt-12 pb-16 reveal">
                <div class="container mx-auto max-w-3xl px-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold tracking-tight mb-4">Preguntas Frecuentes</h2>
                        <p class="text-lg opacity-80">Resolvemos tus dudas antes de empezar.</p>
                    </div>
                    <div class="space-y-4">
                        <details class="faq-item group bg-white/5 border border-white/10 rounded-xl overflow-hidden transition-all duration-300">
                            <summary class="flex justify-between items-center p-6 cursor-pointer list-none">
                                <span class="font-semibold text-lg">¿Es dinero real?</span>
                                <span class="transition-transform group-open:rotate-180">
                                    <i data-lucide="chevron-down" class="w-5 h-5"></i>
                                </span>
                            </summary>
                            <div class="px-6 pb-6 opacity-80 leading-relaxed border-t border-white/5 pt-4">
                                <p>No en el Portafolio Virtual. Te damos $100,000 de dinero ficticio para que practiques sin riesgo. Sin embargo, los datos y precios que ves son reales y en vivo del mercado global.</p>
                            </div>
                        </details>
                        <details class="faq-item group bg-white/5 border border-white/10 rounded-xl overflow-hidden transition-all duration-300">
                            <summary class="flex justify-between items-center p-6 cursor-pointer list-none">
                                <span class="font-semibold text-lg">¿Qué activos puedo analizar?</span>
                                <span class="transition-transform group-open:rotate-180">
                                    <i data-lucide="chevron-down" class="w-5 h-5"></i>
                                </span>
                            </summary>
                            <div class="px-6 pb-6 opacity-80 leading-relaxed border-t border-white/5 pt-4">
                                <p>Cubrimos Acciones de EE.UU. (NYSE, NASDAQ), principales índices globales, las criptomonedas más importantes (BTC, ETH, SOL), Commodities como Oro y Petróleo, y pares de Forex principales.</p>
                            </div>
                        </details>
                        <details class="faq-item group bg-white/5 border border-white/10 rounded-xl overflow-hidden transition-all duration-300">
                            <summary class="flex justify-between items-center p-6 cursor-pointer list-none">
                                <span class="font-semibold text-lg">¿Cómo funciona la IA Sentinel?</span>
                                <span class="transition-transform group-open:rotate-180">
                                    <i data-lucide="chevron-down" class="w-5 h-5"></i>
                                </span>
                            </summary>
                            <div class="px-6 pb-6 opacity-80 leading-relaxed border-t border-white/5 pt-4">
                                <p>Sentinel monitorea miles de fuentes de noticias financieras 24/7. Utiliza modelos de lenguaje avanzados (LLMs) para leer, entender el sentimiento (positivo/negativo) y resumir el impacto, alertándote solo cuando detecta información crítica.</p>
                            </div>
                        </details>
                         <details class="faq-item group bg-white/5 border border-white/10 rounded-xl overflow-hidden transition-all duration-300">
                            <summary class="flex justify-between items-center p-6 cursor-pointer list-none">
                                <span class="font-semibold text-lg">¿Es seguro?</span>
                                <span class="transition-transform group-open:rotate-180">
                                    <i data-lucide="chevron-down" class="w-5 h-5"></i>
                                </span>
                            </summary>
                            <div class="px-6 pb-6 opacity-80 leading-relaxed border-t border-white/5 pt-4">
                                <p>Absolutamente. Tu privacidad es nuestra prioridad. No compartimos tus datos de trading con terceros y utilizamos encriptación de grado bancario para proteger todas tus estrategias y configuraciones personales.</p>
                            </div>
                        </details>
                    </div>
                </div>
            </section>

        </div> <!-- Fin de #main-content -->

        <!-- Footer -->
        <footer class="relative z-10 w-full border-t" style="border-color: var(--border-main); background-color: var(--bg-main);">
            <div class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16">
                
                <!-- Sección Superior: Logo y Tagline -->
                <div class="mb-12 text-center md:text-left">
                    <div class="text-xl font-bold tracking-wider inline-block">MAVERLANG</div>
                    <p class="mt-2 text-md opacity-80 max-w-lg mx-auto md:mx-0">
                        Potenciando decisiones financieras con inteligencia artificial avanzada.
                    </p>
                </div>

                <!-- Sección Media: Enlaces (MODIFICADA) -->
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-8 mb-12">
                    <!-- Col 1: Navegación (MODIFICADA) -->
                    <div>
                        <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Navegación</h3>
                        <nav class="flex flex-col gap-3">
                            <a href="index.html" class="text-sm opacity-70 hover:opacity-100 hover:text-blue-500 transition-all">Inicio</a>
                            <a href="noticias.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Noticias</a>
                            <a href="mercados.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Mercados</a>
                            <a href="aprendelo.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Apréndelo</a>
                        </nav>
                    </div>
                    <!-- Col 2: Plataforma (NUEVA) -->
                    <div>
                        <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Plataforma</h3>
                        <nav class="flex flex-col gap-3">
                            <a href="portafolioAI.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio AI</a>
                            <a href="seguimiento.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Seguimiento</a>
                            <a href="portafolio.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio Virtual</a>
                            <a href="chats.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Chats</a>
                        </nav>
                    </div>
                    <!-- Col 3: Compañía (Sin cambios) -->
                    <div>
                        <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Compañía</h3>
                        <nav class="flex flex-col gap-3">
                            <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Sobre Nosotros</a>
                            <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Blog</a>
                            <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Contacto</a>
                        </nav>
                    </div>
                    <!-- Col 4: Legal (Sin cambios) -->
                    <div>
                        <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Legal</h3>
                        <nav class="flex flex-col gap-3">
                            <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Términos de Servicio</a>
                            <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Política de Privacidad</a>
                        </nav>
                    </div>
                </div>

                <!-- Sección Inferior: Copyright y Redes Sociales (MODIFICADA) -->
                <div class="border-t pt-8 flex flex-col md:flex-row justify-between items-center gap-6" style="border-color: var(--border-main);">
                    <p class="text-sm opacity-70 text-center md:text-left">
                        &copy; 2025 Maverlang. Todos los derechos reservados.
                    </p>
                    <div class="flex gap-6">
                        <a href="#" aria-label="LinkedIn" class="opacity-70 hover:opacity-100 hover:text-blue-500 transition-all">
                            <i data-lucide="linkedin" class="w-6 h-6"></i>
                        </a>
                        <a href="#" aria-label="Instagram" class="opacity-70 hover:opacity-100 hover:text-pink-500 transition-all">
                            <i data-lucide="instagram" class="w-6 h-6"></i>
                        </a>
                        <a href="#" aria-label="X (Twitter)" class="opacity-70 hover:opacity-100 transition-all">
                            <!-- SVG para X -->
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                              <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.06l3.51 4.639L12.6.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="Facebook" class="opacity-70 hover:opacity-100 hover:text-blue-600 transition-all">
                            <i data-lucide="facebook" class="w-6 h-6"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Fin Footer -->

    </div> <!-- Fin de #page-wrapper -->

    <!-- Modal de Whitelist --><div id="whitelist-modal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 opacity-0 invisible">
        <div class="modal-content w-full max-w-md rounded-2xl p-8 text-center scale-95">
            <button id="close-modal-btn" class="absolute top-4 right-4 p-2 rounded-full hover:bg-gray-500/10"><i data-lucide="x"></i></button>
            <i data-lucide="rocket" class="w-12 h-12 mx-auto text-blue-500 mb-4"></i>
            <h2 class="text-2xl font-bold">Únete al Acceso Prioritario</h2>
            <p class="mt-2 text-main/70">Sé el primero en saber cuándo lanzamos y obtén un <span class="font-bold text-blue-500">20% de descuento</span> en tu suscripción.</p>
            <div id="fomo-counter" class="text-base font-semibold">
               ¡Únete a <span id="whitelist-count">...</span> analistas en la lista!
            </div>
            <div id="modal-countdown-container" class="flex items-center justify-center gap-3 md:gap-4 my-6">
                <div class="countdown-box rounded-2xl w-20 h-20 flex flex-col items-center justify-center"><span id="modal-days" class="countdown-number">00</span><span class="countdown-label">Días</span></div>
                <div class="countdown-box rounded-2xl w-20 h-20 flex flex-col items-center justify-center"><span id="modal-hours" class="countdown-number">00</span><span class="countdown-label">Horas</span></div>
                <div class="countdown-box rounded-2xl w-20 h-20 flex flex-col items-center justify-center"><span id="modal-minutes" class="countdown-number">00</span><span class="countdown-label">Minutos</span></div>
                <div class="countdown-box rounded-2xl w-20 h-20 flex flex-col items-center justify-center"><span id="modal-seconds" class="countdown-number">00</span><span class="countdown-label">Segundos</span></div>
            </div>
            <form id="whitelist-form-modal">
                <div class="flex items-center p-2 rounded-full border" style="border-color: var(--border-main);"><input type="email" id="email-input-modal" placeholder="Tu correo electrónico" required class="w-full bg-transparent px-4 py-2 text-main placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none"><button type="submit" id="submit-btn-modal" class="bg-blue-600 text-white font-semibold px-6 py-2 rounded-full flex-shrink-0 hover:bg-blue-700 transition-colors" disabled>Iniciando...</button></div>
                <p id="form-message-modal" class="mt-3 text-sm h-5"></p>
            </form>
        </div>
    </div>

    <!-- Banner Fijo Inferior Izquierdo (Pop-up 2) -->
    <div id="bottom-left-banner" class="fixed bottom-4 left-4 z-40 w-full max-w-sm p-4 rounded-lg shadow-lg hidden" style="background-color: var(--bg-main); border: 1px solid var(--border-main);">
        <div class="flex items-start gap-3">
            <div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-full">
                <i data-lucide="rocket" class="w-6 h-6 text-blue-500"></i>
            </div>
            <div class="flex-1">
                <h4 class="font-semibold">Acceso Prioritario</h4>
                <p class="text-sm opacity-80">Obtén un 20% de descuento en el lanzamiento.</p>
                <button id="banner-register-btn" class="mt-2 text-sm font-semibold text-blue-500 hover:text-blue-400">Registrar ahora</button>
            </div>
            <button id="banner-close-btn" class="p-1 rounded-full hover:bg-gray-500/10">
                <i data-lucide="x" class="w-4 h-4 opacity-70"></i>
            </button>
        </div>
    </div>


    <!-- Scripts de la Aplicación -->
    <script type="module">
        // Importaciones de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Variables Globales
        let db, auth;
        let userId = null;
        let isAuthReady = false;
        let whitelistCol;
        let isClickOutsideListenerAdded = false; 
        let tvWidgetLoaded = false; // (NUEVO) Para Lazy Load

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(
            typeof __firebase_config !== 'undefined' ? __firebase_config : '{}'
        );

        let modalShown = false; 

        // --- Funciones del Modal ---
        const openModal = (e) => {
            if (e) e.preventDefault();
            if (e.currentTarget && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') {
                return; 
            }
            const modal = document.getElementById('whitelist-modal');
            if (!modal || !modal.classList.contains('invisible')) return;
            
            modalShown = true; 
            
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.remove('invisible', 'opacity-0');
            modalContent.classList.remove('scale-95');
        };

        const closeModal = () => {
            const modal = document.getElementById('whitelist-modal');
            if (!modal) return;
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => modal.classList.add('invisible'), 300);
        };

        // --- Contenido de Marketing para "Apréndelo" ---
        const aprendeloContentData = {
            desafio: `<h3 class="text-2xl font-bold mb-3">Tu Camino al Dominio Financiero</h3><p class="mt-2 opacity-80 leading-relaxed">Sigue un camino claro, nivel a nivel, inspirado en Duolingo. Completa lecciones diarias sobre análisis técnico, macroeconomía, valoración de empresas y más. Mantén tu racha de aprendizaje activa y desbloquea contenido avanzado. ¡Convierte el aprendizaje en un hábito con nuestro sistema gamificado!</p><h4 class="font-semibold mt-4 mb-2">Rutas Populares:</h4><ul class="list-disc list-inside text-sm opacity-70 space-y-1"><li>Fundamentos para Inversión a Largo Plazo</li><li>Ruta del Trader Técnico</li><li>Análisis Macroeconómico Global</li></ul>`,
            cursos: `<h3 class="text-2xl font-bold mb-3">Cursos Inteligentes con IA</h3><p class="mt-2 opacity-80 leading-relaxed">Nuestros cursos (ej: "Introducción a ETFs", "Valoración Avanzada con Flujos de Caja", "Psicología del Trading") cobran vida con IA. Accede a videos de alta calidad directamente en nuestra plataforma. Aunque el asistente de IA no está visible aquí, en la plataforma real te acompañará para resolver dudas, hacer preguntas relevantes y pausar el video en puntos clave para validar tu comprensión. ¡Nunca más te sentirás perdido en una clase!</p>`,
            examenes: `<h3 class="text-2xl font-bold mb-3">Misiones: Pon a Prueba tu Habilidad</h3><p class="mt-2 opacity-80 leading-relaxed">Olvida los tests aburridos. Enfrenta "Misiones" gamificadas (ej: "Identifica 3 patrones 'Hombro-Cabeza-Hombro' en gráficos reales", "Calcula el Valor Intrínseco de 5 empresas del IPSA", "Sobrevive a una simulación de crash bursátil"). Compite contra el tiempo, gestiona tus 'vidas', gana puntos por precisión y desbloquea niveles de dificultad y recompensas exclusivas.</p>`,
            progreso: `<h3 class="text-2xl font-bold mb-3">Tu Sala de Trofeos Financieros</h3><p class="mt-2 opacity-80 leading-relaxed">Cada logro cuenta. Visualiza tu avance general y por área temática (Técnico, Fundamental, Macro). Colecciona insignias únicas por <strong class="text-yellow-500">completar Rutas de aprendizaje, mantener rachas de desafíos semanales, alcanzar puntajes 'Maestro' en misiones</strong> y dominar conceptos específicos. ¡Tu perfil de progreso es el reflejo de tu dedicación y habilidad!</p>`
        };

        // --- Inicialización General ---
        async function initApp() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            } else {
                console.warn("Lucide no está listo, reintentando...");
                setTimeout(initApp, 100);
                return;
            }

            initTheme(); 
            await initFirebase();

            initWhitelistModal();
            initFauxChatAndLLM(); 
            initWhitelistForms();
            initChatInputBehavior();
            initCountdown();
            initTypingAnimation();
            initHeaderScrollBehavior(); 
            initNavigation(); 
            initAprendeloTabs();
            generateParticlesSlow(); 
            initMobileMenu(); 
            initPopups(); 
            initScrollReveal(); // (NUEVO) Scroll Reveal
            initLazyLoadWidgets(); // (NUEVO) Lazy Load TV Widget

            if (isAuthReady) {
                 console.log("Firebase listo, iniciando listener de whitelist.");
                 listenToWhitelistCount();
            } else {
                 console.warn("La autenticación de Firebase falló o no está lista. El listener de whitelist no se iniciará.");
            }
        }

        // (NUEVO) Función para Scroll Reveal
        function initScrollReveal() {
            const reveals = document.querySelectorAll('.reveal');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                        observer.unobserve(entry.target); // Solo animar una vez
                    }
                });
            }, { threshold: 0.15 }); // 15% visible para activar

            reveals.forEach(r => observer.observe(r));
        }
        
        // (NUEVO) Función para Lazy Load de Widgets
        function initLazyLoadWidgets() {
            const widgetContainer = document.getElementById('tv-widget-container');
            if (!widgetContainer) return;

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && !tvWidgetLoaded) {
                        console.log("Widget container visible. Loading TradingView...");
                        const currentTheme = localStorage.getItem('maverlang_theme') || 'light';
                        loadTradingViewWidget(currentTheme === 'dark' ? 'dark' : 'light');
                        tvWidgetLoaded = true;
                        observer.unobserve(entry.target);
                    }
                });
            }, { rootMargin: '200px' }); // Cargar 200px antes de llegar

            observer.observe(widgetContainer);
        }


        // --- Inicialización de Firebase ---
        async function initFirebase() {
             if (!firebaseConfig.apiKey || firebaseConfig.apiKey === "TU_API_KEY") {
                console.warn("Firebase no está configurado.");
                isAuthReady = false;
                return;
            }
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                setLogLevel('debug');
                // CORRECCIÓN: Ruta de colección ajustada
                whitelistCol = collection(db, 'artifacts', appId, 'public', 'data', 'whitelist');

                await new Promise((resolve, reject) => {
                    const unsubscribe = onAuthStateChanged(auth, async (user) => {
                        unsubscribe();
                        if (user) {
                            userId = user.uid;
                            isAuthReady = true;
                            updateWhitelistButtonState(true); // (NUEVO) Habilitar botón
                            console.log("Usuario ya autenticado:", userId);
                            resolve();
                        } else {
                            try {
                                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                    await signInWithCustomToken(auth, __initial_auth_token);
                                } else {
                                    await signInAnonymously(auth);
                                }
                                if (auth.currentUser) {
                                    userId = auth.currentUser.uid;
                                    isAuthReady = true;
                                    updateWhitelistButtonState(true); // (NUEVO) Habilitar botón
                                    console.log("Autenticación exitosa:", userId);
                                    resolve();
                                } else {
                                     isAuthReady = false;
                                     updateWhitelistButtonState(false, "Error de Conexión");
                                     reject(new Error("Fallo en la autenticación silenciosa."));
                                }
                            } catch (authError) {
                                isAuthReady = false;
                                updateWhitelistButtonState(false, "Error de Conexión");
                                reject(authError);
                            }
                        }
                    }, (error) => {
                        isAuthReady = false;
                        updateWhitelistButtonState(false, "Error de Conexión");
                        reject(error);
                    });
                });

            } catch (e) {
                console.error("Error crítico al inicializar Firebase:", e.message);
                isAuthReady = false;
                updateWhitelistButtonState(false, "Error de Configuración");
            }
        }
        
        // (NUEVO) Función para gestionar el estado del botón de Whitelist
        function updateWhitelistButtonState(isReady, errorMessage = "Iniciando...") {
            const submitBtn = document.getElementById('submit-btn-modal');
            if (!submitBtn) return;
            
            if (isReady) {
                submitBtn.disabled = false;
                submitBtn.textContent = "Anotarme";
                submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                submitBtn.disabled = true;
                submitBtn.textContent = errorMessage;
                submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        // --- Widget de TradingView (ACTUALIZADO: Symbol Overview) ---
        
         function loadTradingViewWidget(theme) {
             const container = document.getElementById('tv-widget-container');
             if (!container) return;
             
             // Limpiar contenedor (importante para cambiar de tema)
             container.innerHTML = '';
             
             // Crear la estructura contenedora requerida por el embed script
             const widgetContainerDiv = document.createElement('div');
             widgetContainerDiv.className = 'tradingview-widget-container';
             widgetContainerDiv.style.width = '100%';
             widgetContainerDiv.style.height = '100%';
             
             const widgetDiv = document.createElement('div');
             widgetDiv.className = 'tradingview-widget-container__widget';
             widgetDiv.style.height = 'calc(100% - 32px)'; // Ajuste para el copyright
             widgetDiv.style.width = '100%';
             
             const copyrightDiv = document.createElement('div');
             copyrightDiv.className = 'tradingview-widget-copyright';
             copyrightDiv.innerHTML = '<a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text"></span></a>';

             // Configuración JSON proporcionada
             const scriptConfig = {
                 "lineWidth": 2,
                 "lineType": 0,
                 "chartType": "area",
                 "fontColor": theme === 'dark' ? "rgba(255, 255, 255, 0.7)" : "rgb(106, 109, 120)", // Adaptado al tema
                 "gridLineColor": theme === 'dark' ? "rgba(255, 255, 255, 0.06)" : "rgba(46, 46, 46, 0.06)", // Adaptado al tema
                 "volumeUpColor": "rgba(34, 171, 148, 0.5)",
                 "volumeDownColor": "rgba(247, 82, 95, 0.5)",
                 "backgroundColor": theme === 'dark' ? "#1e1e1e" : "#ffffff", // Fondo adaptable si isTransparent falla o carga lento
                 "widgetFontColor": theme === 'dark' ? "#fcfcfc" : "#0F0F0F", // Adaptado al tema
                 "upColor": "#22ab94",
                 "downColor": "#f7525f",
                 "borderUpColor": "#22ab94",
                 "borderDownColor": "#f7525f",
                 "wickUpColor": "#22ab94",
                 "wickDownColor": "#f7525f",
                 "colorTheme": theme, // Dinámico
                 "isTransparent": true,
                 "locale": "en", // Mantenido en inglés según tu código, puedes cambiar a 'es'
                 "chartOnly": false,
                 "scalePosition": "right",
                 "scaleMode": "Normal",
                 "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",
                 "valuesTracking": "1",
                 "changeMode": "price-and-percent",
                 "symbols": [
                     [
                         "Apple",
                         "NASDAQ:AAPL|1D"
                     ],
                     [
                         "Google",
                         "NASDAQ:GOOGL|1D"
                     ],
                     [
                         "Microsoft",
                         "NASDAQ:MSFT|1D"
                     ]
                 ],
                 "dateRanges": [
                     "1d|1",
                     "1m|30",
                     "3m|60",
                     "12m|1D",
                     "60m|1W",
                     "all|1M"
                 ],
                 "fontSize": "10",
                 "headerFontSize": "medium",
                 "autosize": true,
                 "width": "100%",
                 "height": "100%",
                 "noTimeScale": false,
                 "hideDateRanges": false,
                 "hideMarketStatus": false,
                 "hideSymbolLogo": false
             };

             // Crear el script embed dinámicamente
             const script = document.createElement('script');
             script.type = 'text/javascript';
             script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js';
             script.async = true;
             script.innerHTML = JSON.stringify(scriptConfig);

             // Ensamblar
             widgetContainerDiv.appendChild(widgetDiv);
             widgetContainerDiv.appendChild(copyrightDiv);
             widgetContainerDiv.appendChild(script);
             container.appendChild(widgetContainerDiv);
         }


        // --- Manejo de Temas ---
        function initTheme() {
            const themeMainBtn = document.getElementById('theme-main-btn');
            const themeDropdownMenu = document.getElementById('theme-dropdown-menu');
            const themeDropdownBtns = themeDropdownMenu.querySelectorAll('.theme-dropdown-btn');

            if (!themeMainBtn || !themeDropdownMenu) return;

            const currentTheme = localStorage.getItem('maverlang_theme') || 'light';
            applyTheme(currentTheme, true); 

             themeMainBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                 const isVisible = !themeDropdownMenu.classList.contains('invisible');
                 if (isVisible) {
                     themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible');
                 } else {
                     document.getElementById('nav-funciones-menu')?.classList.add('opacity-0', 'scale-95', 'invisible');
                     document.getElementById('mobile-menu-panel')?.classList.add('opacity-0', 'hidden'); 
                     themeDropdownMenu.classList.remove('opacity-0', 'scale-95', 'invisible');
                 }
            });

            themeDropdownBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    applyTheme(btn.dataset.theme);
                    themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible');
                });
            });
        }

        function applyTheme(theme, isInitialLoad = false) {
            const html = document.documentElement;
            const themeMainBtn = document.getElementById('theme-main-btn'); 
            let tvTheme;
            let iconName = 'sun'; 

            html.classList.remove('dark'); 

            if (theme === 'dark') {
                html.classList.add('dark');
                tvTheme = 'dark';
                iconName = 'moon';
            } else { 
                tvTheme = 'light';
                iconName = 'sun';
            }

            if (!isInitialLoad) {
                localStorage.setItem('maverlang_theme', theme);
            }

            if (themeMainBtn) { 
                const newIconHTML = `<i data-lucide="${iconName}"></i>`;
                themeMainBtn.innerHTML = newIconHTML; 
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons(); 
                }
            }

            document.querySelectorAll('.theme-dropdown-btn').forEach(b => b.classList.remove('active'));
            const activeButton = document.querySelector(`.theme-dropdown-btn[data-theme="${theme}"]`);
            if (activeButton) activeButton.classList.add('active');

            // Recargar widget SOLO si ya fue cargado previamente (lazy loaded)
            if (tvWidgetLoaded) {
                loadTradingViewWidget(tvTheme); 
            }
            
            updateHeaderBackground(); 
        }

        // Lógica de Pop-ups (Timer y Banner)
        function initPopups() {
            const banner = document.getElementById('bottom-left-banner');
            const closeBannerBtn = document.getElementById('banner-close-btn');
            const registerBannerBtn = document.getElementById('banner-register-btn');

            if (banner && closeBannerBtn && registerBannerBtn) {
                setTimeout(() => {
                    banner.classList.remove('hidden');
                    setTimeout(() => banner.classList.add('visible'), 50); 
                }, 2500);

                closeBannerBtn.addEventListener('click', () => {
                    banner.classList.remove('visible');
                    setTimeout(() => banner.classList.add('hidden'), 500);
                });

                registerBannerBtn.addEventListener('click', (e) => {
                    openModal(e);
                    banner.classList.remove('visible');
                    setTimeout(() => banner.classList.add('hidden'), 500);
                });
            }

            setTimeout(() => {
                if (!modalShown) {
                    openModal();
                }
            }, 10000); 
        }

        // --- Lógica de Whitelist y Modal ---
        function initWhitelistModal() {
            const modal = document.getElementById('whitelist-modal');
            if (!modal) return;
            const closeModalBtn = document.getElementById('close-modal-btn');
            const triggerButtons = document.querySelectorAll('.modal-trigger-btn, #header-whitelist-btn, #response-cta-button, #banner-register-btn, #mobile-whitelist-btn'); 
            
            triggerButtons.forEach(btn => {
                if (btn.dataset.modalListenerAttached === 'true') return; 
                
                btn.addEventListener('click', (e) => {
                     if (e.currentTarget.tagName === 'A' && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') {
                         return; 
                     }
                     openModal(e);
                });
                btn.dataset.modalListenerAttached = 'true'; 
            });
            
            if (closeModalBtn && closeModalBtn.dataset.modalListenerAttached !== 'true') {
                 closeModalBtn.addEventListener('click', closeModal);
                 closeModalBtn.dataset.modalListenerAttached = 'true';
            }
            if (modal.dataset.modalListenerAttached !== 'true') {
                 modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
                 modal.dataset.modalListenerAttached = 'true';
            }
        }


        // --- Listener de Whitelist Count ---
        function listenToWhitelistCount() {
             if (!db || !whitelistCol || !isAuthReady) {
                const fomoCounterEl = document.getElementById('fomo-counter');
                 const countEl = document.getElementById('whitelist-count');
                 if(fomoCounterEl && countEl) { countEl.textContent = '...'; }
                return;
            }
            const fomoCounterEl = document.getElementById('fomo-counter');
            const countEl = document.getElementById('whitelist-count');
            if (!fomoCounterEl || !countEl) return; 
            try {
                const unsub = onSnapshot(whitelistCol, (snapshot) => {
                    const count = snapshot.size;
                    countEl.textContent = count > 0 ? count.toLocaleString('es') : '0';
                    fomoCounterEl.classList.add('visible');
                }, (error) => {
                    fomoCounterEl.classList.add('visible');
                    countEl.textContent = 'Error';
                });
            } catch (error) {
                fomoCounterEl.classList.add('visible');
                countEl.textContent = 'Error';
            }
        }

        function initWhitelistForms() {
             const modalForm = document.getElementById('whitelist-form-modal');
            if (modalForm) modalForm.addEventListener('submit', (e) => handleWhitelistSubmit(e));
        }

        async function handleWhitelistSubmit(e) {
             e.preventDefault();
            if (!db || !whitelistCol || !isAuthReady || !auth.currentUser) { setMessage('Error: Sistema no listo.', 'error'); return; }

            const emailInput = document.getElementById('email-input-modal');
            const submitBtn = document.getElementById('submit-btn-modal');
            const email = emailInput.value.trim();
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { setMessage('Correo inválido.', 'error'); return; }
            const originalBtnText = submitBtn.textContent;
            submitBtn.disabled = true; submitBtn.textContent = 'Enviando...'; setMessage('', 'clear');
            try {
                const q = query(whitelistCol, where("email", "==", email));
                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) { throw new Error('Este correo ya está registrado.'); }
                await addDoc(whitelistCol, {
                    email: email,
                    timestamp: serverTimestamp(),
                    source: 'modal',
                });
                setMessage('¡Gracias! Estás en la lista.', 'success'); emailInput.value = '';
                setTimeout(closeModal, 2000);
            } catch (error) {
                console.error("Error al registrar en whitelist:", error);
                setMessage(error.message || 'Error al registrar.', 'error');
            } finally {
                submitBtn.disabled = false; submitBtn.textContent = originalBtnText;
            }
        }

        function setMessage(message, type) {
             const messageEl = document.getElementById('form-message-modal');
             if (!messageEl) return;
             messageEl.textContent = message;
             messageEl.style.color = type === 'success' ? 'var(--success-color)' : (type === 'error' ? 'var(--accent-red)' : 'inherit');
        }

        // --- Funciones de UI/Animación ---
        function initCountdown() {
            // Fecha actualizada: 10 de Diciembre de 2025
            const targetDate = new Date('2025-12-10T00:00:00').getTime();
            const ids = ['modal'];
            const labels = ['days', 'hours', 'minutes', 'seconds'];
            const elements = {};
            ids.forEach(id => { elements[id] = {}; labels.forEach(l => elements[id][l] = document.getElementById(`${id}-${l}`)); });
            const interval = setInterval(() => {
                const distance = targetDate - new Date().getTime();
                if (distance < 0) {
                    clearInterval(interval);
                    ids.forEach(id => { const cont = document.getElementById(`${id}-countdown-container`); if(cont) cont.innerHTML = '<p class="text-xl font-bold text-blue-500">¡Lanzamiento iniciado!</p>'; });
                    return;
                }
                const d = Math.floor(distance / 864e5), h = Math.floor((distance % 864e5) / 36e5), m = Math.floor((distance % 36e5) / 6e4), s = Math.floor((distance % 6e4) / 1e3);
                const times = { days: d, hours: h, minutes: m, seconds: s };
                ids.forEach(id => { labels.forEach(l => { if(elements[id] && elements[id][l]) elements[id][l].textContent = String(times[l]).padStart(2, '0'); }); });
            }, 1000);
        }
        
        // (NUEVO) Efecto de Typewriter para el chat
        function typeWriterEffect(element, text, speed = 30) {
            let i = 0;
            element.innerHTML = ""; // Limpiar
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    // Mostrar botón CTA al terminar
                    const btn = document.getElementById('response-cta-button');
                    if(btn) btn.style.opacity = '1';
                }
            }
            type();
        }

        function initTypingAnimation() {
            const el = document.getElementById('typing-text'); if(!el) return;
            const q = ["Análisis fundamental de SQM", "¿Impacto del cobre en el IPSA?", "Noticias clave para COPEC", "Pronóstico técnico de BTC/USD"];
            let qi = 0, ci = 0, del = false, t;
            const type = () => { clearTimeout(t); const cq = q[qi]; let ts = del ? 50 : 100; if (del) { el.textContent = cq.substring(0, ci-1); ci--; } else { el.textContent = cq.substring(0, ci+1); ci++; } if (!del && ci === cq.length) { ts = 2000; del = true; } else if (del && ci === 0) { del = false; qi=(qi+1)%q.length; ts = 500; } if(el.isConnected) t=setTimeout(type, ts); }; type();
        }

        function initChatInputBehavior() {
            const chatInput = document.getElementById('chat-input');
            const placeholder = document.getElementById('placeholder-container');
            if (!chatInput || !placeholder) return;
            chatInput.addEventListener('input', () => { placeholder.style.opacity = chatInput.value.length > 0 ? '0' : '1'; });
        }

        // Lógica del Chat Demo (MEJORADA con Typewriter)
        function initFauxChatAndLLM() {
            const aiModeBtn = document.getElementById('ai-mode-btn'); const aiModeMenu = document.getElementById('ai-mode-menu'); const mainView = document.getElementById('ai-menu-main-view'); const llmView = document.getElementById('llm-options-view'); const llmH = document.getElementById('llm-selector-header'); const llmBackButton = document.getElementById('llm-back-btn'); const llmOptsContainer = document.getElementById('llm-options'); const llmLabel = document.getElementById('llm-selector-label'); const tutorCont = document.getElementById('tutor-toggle-container');
            
            const chatInput = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');
            const micBtn = document.getElementById('mic-btn'); 
            const chatInputContainer = document.getElementById('chat-input-container');
            const chatResponseContainer = document.getElementById('chat-response-container');
            const thinkingIndicator = document.getElementById('thinking-indicator');
            const aiResponseCard = document.getElementById('ai-response-card');
            const aiResponseText = document.getElementById('ai-response-text'); // (NUEVO)
            const responseCtaButton = document.getElementById('response-cta-button');

            if (!aiModeBtn || !aiModeMenu || !chatInput || !sendBtn || !aiResponseText) { 
                 return; 
            }
            
            // --- Lógica del Menú AI (sin cambios) ---
            if (tutorCont) { const check = tutorCont.querySelector('input'); tutorCont.addEventListener('click', (e) => { if (!e.target.closest('.tutor-toggle-switch')) check.checked = !check.checked; }); }
            const llms = [{ id:'gpt-5', name:'GPT-5' }, { id:'grok-4', name:'Grok 4' }, { id:'gemini-2.5-pro', name:'Gemini 2.5 Pro' }, { id:'claude-sonnet', name:'Claude 4.5 Sonnet' }];
            llmOptsContainer.innerHTML = llms.map(l => `<div class="llm-card-small rounded-lg p-2 text-center" data-llm-id="${l.id}"><p class="font-semibold text-xs">${l.name}</p></div>`).join('');
            const localCloseMenu = () => { aiModeMenu.classList.add('opacity-0','scale-95'); setTimeout(() => { aiModeMenu.classList.add('invisible'); mainView.classList.remove('hidden'); llmView.classList.add('hidden'); }, 200); };
            aiModeBtn.addEventListener('click', (e) => { e.stopPropagation(); e.preventDefault(); aiModeMenu.classList.contains('invisible') ? aiModeMenu.classList.remove('invisible','opacity-0','scale-95') : localCloseMenu(); });
            document.addEventListener('click', () => { if (!aiModeMenu.classList.contains('invisible')) localCloseMenu(); }); 
            llmH.addEventListener('click', (e) => { e.stopPropagation(); mainView.classList.add('hidden'); llmView.classList.remove('hidden'); lucide.createIcons(); });
            llmBackButton.addEventListener('click', (e) => { e.stopPropagation(); llmView.classList.add('hidden'); mainView.classList.remove('hidden'); });
            llmOptsContainer.querySelectorAll('.llm-card-small').forEach(c => { c.addEventListener('click', (e) => { e.stopPropagation(); const id = c.dataset.llmId; const sel = llms.find(l => l.id === id); localStorage.setItem('selectedLLM', id); llmOptsContainer.querySelectorAll('.llm-card-small').forEach(x => x.classList.remove('selected')); c.classList.add('selected'); llmLabel.textContent = sel.name; localCloseMenu(); }); });
            document.querySelectorAll('#ai-menu-main-view .modal-trigger-btn').forEach(btn => { if (btn.dataset.modalListenerAttached !== 'true') { btn.addEventListener('click', (e) => { e.preventDefault(); localCloseMenu(); }); btn.dataset.modalListenerAttached = 'true'; } });

            // --- Lógica de la Demo de Chat ---
            const triggerChatDemo = (e) => {
                e.preventDefault();
                if (chatInput.value.trim() === '') {
                    openModal(e);
                    return;
                }
                
                chatInputContainer.style.display = 'none';
                chatResponseContainer.style.display = 'block';
                thinkingIndicator.style.display = 'flex';
                aiResponseCard.style.display = 'none';
                
                setTimeout(() => {
                    thinkingIndicator.style.display = 'none';
                    aiResponseCard.style.display = 'block';
                    chatResponseContainer.classList.add('visible'); 
                    
                    // (NUEVO) Iniciar efecto typewriter
                    const responseHTML = `Análisis rápido de <span class="highlight">AAPL</span>: Sentimiento actual: <span class="highlight">Positivo (7.2/10)</span>. Se detectan 3 noticias de alto impacto en las últimas 2h. <em>Análisis completo, alertas 24/7 y modelos predictivos están disponibles para usuarios registrados.</em>`;
                    aiResponseText.innerHTML = responseHTML;
                    aiResponseText.style.opacity = 0;
                    
                    // Animación simple de entrada de texto
                    setTimeout(() => {
                        aiResponseText.style.transition = "opacity 1s";
                        aiResponseText.style.opacity = 1;
                        setTimeout(() => {
                            responseCtaButton.style.opacity = '1';
                        }, 800);
                    }, 100);

                }, 1500);
            };

            sendBtn.addEventListener('click', triggerChatDemo);
            chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    triggerChatDemo(e);
                }
            });
            
            micBtn.addEventListener('click', openModal);
            responseCtaButton.addEventListener('click', openModal);
        }


        function updateHeaderBackground() {
            const header = document.querySelector('header');
            if (!header) return;
            const headerContent = header.firstElementChild;
            if (!headerContent) return; 

            const threshold = 50;
            const scrolled = window.scrollY > threshold;
            const isDark = document.documentElement.classList.contains('dark'); 
            
            const bgColor = scrolled 
                ? (isDark ? 'rgba(10,10,10,0.8)' : 'rgba(255,255,255,0.8)') 
                : (isDark ? 'rgba(0,0,0,0.3)' : 'rgba(255,255,255,0.3)');
                
            headerContent.style.backgroundColor = bgColor;
        }


        function initHeaderScrollBehavior() {
            window.addEventListener('scroll', updateHeaderBackground, { passive: true });
            updateHeaderBackground(); 
        }


        // --- Lógica de Navegación Dropdown ---
        function initNavigation() {
            const funcionesBtn = document.getElementById('nav-funciones-btn');
            const funcionesMenu = document.getElementById('nav-funciones-menu');

            if (funcionesBtn && funcionesMenu) {
                const toggleFuncionesDropdown = (e) => {
                    e.stopPropagation();
                    const isVisible = !funcionesMenu.classList.contains('invisible');
                    if (isVisible) {
                        funcionesMenu.classList.add('opacity-0', 'scale-95', 'invisible');
                    } else {
                        document.getElementById('theme-dropdown-menu')?.classList.add('opacity-0', 'scale-95', 'invisible');
                        document.getElementById('mobile-menu-panel')?.classList.add('opacity-0', 'hidden'); 
                        document.body.classList.remove('no-scroll'); // Asegurar scroll
                        funcionesMenu.classList.remove('opacity-0', 'scale-95', 'invisible');
                    }
                };
                 if (funcionesBtn.dataset.navListenerAttached !== 'true') {
                     funcionesBtn.addEventListener('click', toggleFuncionesDropdown);
                     funcionesBtn.dataset.navListenerAttached = 'true';
                 }
            }

            if (!isClickOutsideListenerAdded) { 
                 document.addEventListener('click', (e) => {
                    const themeDropdown = document.getElementById('theme-dropdown-menu');
                    const themeButton = document.getElementById('theme-main-btn');
                    const funcionesDropdown = document.getElementById('nav-funciones-menu');
                    const funcionesButton = document.getElementById('nav-funciones-btn');
                    const mobileMenu = document.getElementById('mobile-menu-panel'); 
                    const mobileButton = document.getElementById('mobile-menu-btn'); 

                    if (themeDropdown && !themeDropdown.classList.contains('invisible') && themeButton && !themeButton.contains(e.target) && !themeDropdown.contains(e.target)) {
                        themeDropdown.classList.add('opacity-0', 'scale-95', 'invisible');
                    }
                     if (funcionesDropdown && !funcionesDropdown.classList.contains('invisible') && funcionesButton && !funcionesButton.contains(e.target) && !funcionesDropdown.contains(e.target)) {
                        funcionesDropdown.classList.add('opacity-0', 'scale-95', 'invisible');
                    }
                     if (mobileMenu && !mobileMenu.classList.contains('hidden') && mobileButton && !mobileButton.contains(e.target) && !mobileMenu.contains(e.target)) {
                        mobileMenu.classList.add('opacity-0');
                        setTimeout(() => {
                            mobileMenu.classList.add('hidden');
                            document.body.classList.remove('no-scroll'); // (NUEVO) Desbloquear scroll
                        }, 300);
                    }
                });
                isClickOutsideListenerAdded = true; 
            }

            if (funcionesMenu) {
                funcionesMenu.querySelectorAll('a').forEach(item => {
                     if (item.dataset.navItemListener !== 'true') {
                         item.addEventListener('click', (e) => { 
                             if (!item.href || item.href.endsWith('#') || item.classList.contains('modal-trigger-btn')) {
                                funcionesMenu.classList.add('opacity-0', 'scale-95', 'invisible');
                             }
                         });
                         item.dataset.navItemListener = 'true';
                     }
                });
            }
        }

        // (NUEVO) Lógica para Menú Móvil con Body Scroll Lock
        function initMobileMenu() {
            const menuBtn = document.getElementById('mobile-menu-btn');
            const closeBtn = document.getElementById('mobile-menu-close-btn');
            const panel = document.getElementById('mobile-menu-panel');
            const links = panel.querySelectorAll('a');

            if (!menuBtn || !closeBtn || !panel) return;

            const openMenu = () => {
                panel.classList.remove('hidden');
                setTimeout(() => panel.classList.remove('opacity-0'), 10); 
                document.body.classList.add('no-scroll'); // (NUEVO) Bloquear
            };

            const closeMenu = () => {
                panel.classList.add('opacity-0');
                setTimeout(() => {
                    panel.classList.add('hidden');
                    document.body.classList.remove('no-scroll'); // (NUEVO) Desbloquear
                }, 300);
            };

            menuBtn.addEventListener('click', openMenu);
            closeBtn.addEventListener('click', closeMenu);
            
            links.forEach(link => {
                link.addEventListener('click', () => {
                    if (link.href && !link.href.endsWith('#') && !link.classList.contains('modal-trigger-btn')) {
                        return;
                    }
                    closeMenu();
                });
            });
        }
        
        // --- Lógica para "Apréndelo" Tabs ---
        function initAprendeloTabs() {
            const triggersContainer = document.getElementById('aprendelo-tabs-triggers');
            const contentArea = document.getElementById('aprendelo-tab-content-area');
            const textContentEl = document.getElementById('aprendelo-text-content');
            const visualsContainer = document.getElementById('aprendelo-visuals-container');

            if (!triggersContainer || !contentArea || !textContentEl || !visualsContainer) return;

            const triggers = triggersContainer.querySelectorAll('.aprendelo-tab-trigger');
            if (triggers.length === 0) return; 
            
            let isAnimating = false;
            const ANIMATION_DURATION = 300;

            const switchTab = (triggerToActivate) => {
                if (isAnimating || triggerToActivate.classList.contains('active')) return;
                isAnimating = true;

                const currentActiveTrigger = triggersContainer.querySelector('.aprendelo-tab-trigger.active');
                const currentActiveVisual = visualsContainer.querySelector('.aprendelo-visual.active');
                const contentId = triggerToActivate.dataset.contentId;
                const newContentHtml = aprendeloContentData[contentId] || '<p>Contenido no encontrado.</p>';
                const newVisual = document.getElementById(`visual-${contentId}`);

                if (currentActiveTrigger) currentActiveTrigger.classList.remove('active');
                if (currentActiveVisual) currentActiveVisual.classList.remove('active');
                textContentEl.style.opacity = '0';

                setTimeout(() => {
                    textContentEl.innerHTML = newContentHtml;
                    triggerToActivate.classList.add('active');
                    if (newVisual) newVisual.classList.add('active');
                    textContentEl.style.opacity = '1';
                    isAnimating = false;
                }, ANIMATION_DURATION);
            };

            triggers.forEach(trigger => {
                 if (trigger.dataset.tabListener !== 'true') {
                     trigger.addEventListener('click', () => switchTab(trigger));
                     trigger.dataset.tabListener = 'true';
                 }
            });

             const defaultTrigger = triggersContainer.querySelector('.aprendelo-tab-trigger[data-content-id="desafio"]');
             if (defaultTrigger) {
                 const defaultContentId = defaultTrigger.dataset.contentId;
                 const defaultVisual = document.getElementById(`visual-${defaultContentId}`);
                 defaultTrigger.classList.add('active');
                 textContentEl.innerHTML = aprendeloContentData[defaultContentId];
                 textContentEl.style.opacity = '1';
                 if (defaultVisual) defaultVisual.classList.add('active');
             }
        }
        
       // --- Animación Partículas Portafolio AI ---
        function generateParticlesSlow() {
            const container = document.querySelector('#nav-portafolio-ai-link .particles-container');
            if (!container) return;

            const particleCount = 8; 
            const colors = ['var(--particle-color-1)', 'var(--particle-color-2)', 'var(--particle-color-3)'];
            const totalAnimationCycle = 5; 
            const particleAnimationDuration = 2.5; 
            const baseStartDelay = 2.1; 

            container.innerHTML = ''; 

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                const randomDelayOffset = Math.random() * 0.4; 
                const particleStartDelay = baseStartDelay + randomDelayOffset; 
                const relativeDelayCSS = particleStartDelay / totalAnimationCycle; 

                particle.style.setProperty('--particle-delay', relativeDelayCSS.toFixed(3)); 
                particle.style.setProperty('--particle-x', `${Math.random() * 20 - 10}px`); 
                particle.style.setProperty('--particle-y', `${Math.random() * -4 - 2}px`); 
                particle.style.setProperty('--particle-color', colors[Math.floor(Math.random() * colors.length)]);
                
                 particle.style.animationDuration = `${particleAnimationDuration}s`; 
                 particle.style.animationIterationCount = 'infinite'; 

                container.appendChild(particle);
            }
        }

        // Iniciar la aplicación
        initApp();

    </script>
</body>
</html>

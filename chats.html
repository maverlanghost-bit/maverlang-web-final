<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maverlang - Chats | Tu Red de Inversi칩n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

<style>
        /* --- ESTILOS BASE --- */
        :root {
            --bg-light: #f4f4f5; --text-light: #18181b; --border-light: #e4e4e7;
            --bg-dark: #0A0A0A; --text-dark: #f9fafb; --border-dark: #27272a;
            --accent-blue: #3b82f6;
            --accent-blue-rgb: 59, 130, 246;
            --accent-red: #ef4444;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-purple-rgb: 139, 92, 246;
            --bg-active-theme-light: #e4e4e7;
            --bg-active-theme-dark: #27272a;
            --particle-color-1: rgba(59, 130, 246, 0.9);
            --particle-color-2: rgba(96, 165, 250, 0.7);
            --particle-color-3: rgba(255, 255, 255, 0.8);
            
            /* Color de acento para esta p치gina (Morado) */
            --accent-color: var(--accent-purple); 
            --accent-color-rgb: var(--accent-purple-rgb);
        }
        html.dark {
            --bg-main: var(--bg-dark); --text-main: var(--text-dark); --border-main: var(--border-dark);
        }
        html:not(.dark) {
            --bg-main: var(--bg-light); --text-main: var(--text-light); --border-main: var(--border-light);
        }

        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow-y: auto;
        }
        
        /* Bloqueo de Scroll */
        body.no-scroll { overflow: hidden; }

        /* Animaciones Scroll Reveal */
        .reveal {
            opacity: 0; transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
            will-change: opacity, transform;
        }
        .reveal.active { opacity: 1; transform: translateY(0); }

        section.hero-section {
            padding-bottom: 5rem;
            position: relative;
            z-index: 10;
        }

        .background-logo-text {
            font-size: clamp(8rem, 25vw, 22rem); font-weight: 800; letter-spacing: -0.05em;
            color: rgba(120, 120, 120, 0.05); position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); z-index: 1; pointer-events: none;
        }
        html.dark .background-logo-text { color: rgba(var(--accent-color-rgb), 0.03); }
        html:not(.dark) .background-logo-text { color: rgba(var(--accent-color-rgb), 0.05); }

        .countdown-box, .form-container, .modal-content, .feature-card {
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 1rem;
        }
        html.dark .countdown-box, html.dark .form-container, html.dark .modal-content, html.dark .feature-card {
            background: rgba(30, 30, 30, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html:not(.dark) .countdown-box, html:not(.dark) .form-container, html:not(.dark) .modal-content, html:not(.dark) .feature-card {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--border-light);
        }

        .theme-main-btn, .theme-dropdown-btn {
            padding: 0.5rem;
            border-radius: 9999px;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex; align-items: center; justify-content: center;
        }
        .theme-main-btn i, .theme-dropdown-btn i { width: 1.25rem; height: 1.25rem; }
        .theme-main-btn:hover, .theme-dropdown-btn:hover { background-color: rgba(120, 120, 120, 0.1); }
        .theme-dropdown-btn.active { background-color: var(--bg-active-theme-light); color: var(--text-main); }
        html.dark .theme-dropdown-btn.active { background-color: var(--bg-active-theme-dark); }

        .countdown-number { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 600; line-height: 1; color: var(--text-main); }
        .countdown-label { font-size: 0.65rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-main); opacity: 0.6; }

        /* FOMO Counter REMOVIDO */

        #whitelist-modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        #whitelist-modal .modal-content { transition: transform 0.3s ease; }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 12px rgba(var(--accent-color-rgb), 0.4); transform: scale(1); }
            50% { box-shadow: 0 0 20px rgba(var(--accent-color-rgb), 0.8); transform: scale(1.03); }
        }
        .animated-whitelist-btn { 
            animation: pulse-glow 2.5s infinite ease-in-out; 
            background-color: var(--accent-color); 
        }
        #header-whitelist-btn {
            background-color: var(--accent-blue); 
            animation: none;
            box-shadow: none;
        }
         #header-whitelist-btn:hover { background-color: #2563eb; }

        .nav-dropdown-menu, .theme-dropdown-menu { position: absolute; top: calc(100% + 1rem); left: 0; width: 220px; padding: 0.5rem; border-radius: 1rem; z-index: 100; transition: all 0.2s ease-out; transform-origin: top left; background-color: var(--bg-main); }
        .theme-dropdown-menu { width: auto; min-width: 50px; left: auto; right: 0; transform-origin: top right; display: flex; flex-direction: column; gap: 0.25rem; }
        html.dark .nav-dropdown-menu, html.dark .theme-dropdown-menu { border: 1px solid var(--border-dark); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        html:not(.dark) .nav-dropdown-menu, html:not(.dark) .theme-dropdown-menu { border: 1px solid var(--border-light); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .nav-dropdown-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.75rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.5rem; transition: background-color 0.2s ease; cursor: pointer; }
        .nav-dropdown-item:hover { background-color: rgba(120,120,120,0.1); }
        .nav-dropdown-item i { opacity: 0.7; }
        .nav-dropdown-item.active { 
            color: var(--accent-color); 
            font-weight: 600; 
            background-color: rgba(var(--accent-color-rgb), 0.1);
        } 

        #nav-portafolio-ai-link { position: relative; overflow: visible; padding: 0.25rem 0.5rem; cursor: pointer; }
        #nav-portafolio-ai-link span { position: relative; z-index: 1; display: inline-block; animation: text-color-slow-pulse 5s ease-in-out infinite; }
        .particles-container { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
        .particle { position: absolute; bottom: 2px; left: 50%; width: 3px; height: 3px; border-radius: 50%; opacity: 0; animation: particle-fall 2.5s ease-out infinite; animation-delay: calc(var(--particle-delay) * 1s); background-color: var(--particle-color); }
        @keyframes text-color-slow-pulse { 0%, 100% { color: inherit; } 40% { color: var(--accent-blue); } 60% { color: var(--accent-blue); } }
        @keyframes particle-fall { 0% { opacity: 0; transform: translate(-50%, 0) scale(0.3); } 50% { opacity: 1; transform: translate(calc(-50% + var(--particle-x)), calc(var(--particle-y) - 5px)) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + var(--particle-x) * 1.2), calc(var(--particle-y) - 15px)) scale(0); } }

        /* --- Chat Mockup Styles --- */
        .chat-mockup-container {
            max-width: 810px; width: 100%; height: 600px; 
            border: 1px solid var(--border-main); background-color: var(--bg-main);
            border-radius: 1rem; padding: 1rem; display: flex; flex-direction: column;
            overflow: hidden; box-shadow: 0 20px 40px -15px rgba(0,0,0,0.15);
        }
        html.dark .chat-mockup-container { box-shadow: 0 20px 40px -15px rgba(0,0,0,0.3); }

        .chat-mockup-header {
            display: flex; align-items: center; padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-main); flex-shrink: 0;
        }
        .chat-mockup-header .group-icon {
            width: 38px; height: 38px; border-radius: 50%;
            background-color: var(--accent-color); color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 600; font-size: 1rem; margin-right: 0.75rem;
        }
        .chat-mockup-header h4 { font-weight: 600; font-size: 1.125rem; }
        .chat-mockup-header p { font-size: 0.875rem; opacity: 0.7; }

        .chat-mockup-messages {
            flex-grow: 1; overflow-y: hidden; display: flex; flex-direction: column;
            gap: 0.5rem; padding: 1.25rem 0.25rem;
        }

        .message-bubble {
            display: flex; align-items: flex-start; gap: 0.75rem; max-width: 85%;
            opacity: 0; transform: translateY(10px); transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .message-bubble .avatar {
            width: 40px; height: 40px; border-radius: 50%; flex-shrink: 0;
            font-weight: 600; font-size: 0.875rem; color: white;
            display: flex; align-items: center; justify-content: center; margin-top: 0.25rem; 
        }
        .message-bubble .avatar.is-ai { background-color: var(--accent-blue); border: 2px solid rgba(255,255,255,0.5); }

        .message-main-content { display: flex; flex-direction: column; align-items: flex-start; width: 100%; }
        .sender-name { font-size: 0.875rem; font-weight: 600; opacity: 0.8; margin-left: 0.75rem; margin-bottom: 0.25rem; }
        
        .message-bubble .content { padding: 0.75rem 1.2rem; border-radius: 1.25rem; width: fit-content; }
        .message-bubble .content p { font-size: 1rem; line-height: 1.5; }
        .message-bubble .content .mention {
            background-color: rgba(var(--accent-color-rgb), 0.2); color: var(--accent-color);
            font-weight: 600; padding: 0.1rem 0.25rem; border-radius: 0.25rem;
        }
        .message-bubble .content .mention.is-ai { background-color: rgba(var(--accent-blue-rgb), 0.2); color: var(--accent-blue); }

        .message-bubble.is-me { align-self: flex-end; flex-direction: row-reverse; }
        .message-bubble.is-me .message-main-content { align-items: flex-end; }
        .message-bubble.is-me .sender-name { margin-left: 0; margin-right: 0.75rem; color: var(--accent-blue); }
        .message-bubble.is-me .content {
            background-color: rgba(var(--accent-blue-rgb), 0.1); color: var(--text-main);
            border: 1px solid var(--accent-blue); border-bottom-right-radius: 0.5rem;
        }
        
        .message-bubble.is-other { align-self: flex-start; }
        .message-bubble.is-other .content {
            background-color: var(--border-light); color: var(--text-main); border-bottom-left-radius: 0.5rem;
        }
        html.dark .message-bubble.is-other .content { background-color: var(--border-dark); }

        .message-bubble .portfolio-share {
            border: 1px solid var(--border-main); border-radius: 0.75rem; padding: 0.875rem; 
            background-color: var(--bg-main); margin-top: 0.5rem; display: flex; align-items: center;
            gap: 0.75rem; max-width: 280px; 
        }
        .message-bubble.is-me .portfolio-share { border-color: var(--accent-blue); background-color: rgba(var(--accent-blue-rgb), 0.1); }
        .portfolio-share .icon {
            width: 38px; height: 38px; border-radius: 0.5rem;
            background-color: rgba(var(--success-color), 0.1); color: var(--success-color);
            display: flex; align-items: center; justify-content: center; flex-shrink: 0; 
        }
        
        .reactions-container {
            display: flex; gap: 0.25rem; margin-top: 0.5rem; opacity: 0;
            transform: translateY(5px); transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .message-bubble.is-other .reactions-container, .message-bubble.is-me .reactions-container { align-self: flex-end; }

        .reaction-chip {
            font-size: 0.75rem; padding: 0.1rem 0.5rem; border-radius: 99px;
            background-color: rgba(var(--accent-color-rgb), 0.1); border: 1px solid rgba(var(--accent-color-rgb), 0.2);
        }
        
        .typing-indicator {
            display: flex; gap: 4px; padding: 8px 12px; align-items: center;
            background: var(--border-light); border-radius: 1rem; width: fit-content;
        }
        html.dark .typing-indicator { background: var(--border-dark); }
        .typing-dot {
            width: 6px; height: 6px; background: var(--text-main); border-radius: 50%; opacity: 0.5;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 100% { transform: scale(0.8); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; } }

        .chat-mockup-input {
            margin-top: auto; flex-shrink: 0; font-size: 0.875rem; padding: 0.75rem 1rem;
            border-radius: 0.5rem; background-color: var(--bg-main); border: 1px solid var(--border-main);
            opacity: 0.6; display: flex; justify-content: space-between; align-items: center;
        }

        /* Feature Grid */
        .feature-grid-card { display: flex; flex-direction: column; gap: 1rem; padding: 1.5rem; height: 100%; transition: transform 0.2s ease; }
        .feature-grid-card:hover { transform: translateY(-5px); }
        .feature-grid-card .icon {
            width: 48px; height: 48px; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center;
            background-color: rgba(var(--accent-color-rgb), 0.1); color: var(--accent-color);
        }
        .mockup-ranking-list { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 1rem; }
        .mockup-ranking-item {
            display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0.75rem;
            border-radius: 0.5rem; background-color: var(--bg-main); border: 1px solid var(--border-main);
        }
        .mockup-ranking-item .name { display: flex; align-items: center; gap: 0.75rem; font-weight: 600; }
        .mockup-ranking-item .perf { font-weight: 700; }
        
        .mockup-mention-list { margin-top: 1rem; padding: 0.5rem; border: 1px solid var(--border-main); border-radius: 0.5rem; }
        .mockup-mention-item { padding: 0.5rem 0.75rem; border-radius: 0.375rem; font-weight: 500; font-size: 0.875rem; }
        .mockup-mention-item.active { background-color: rgba(var(--accent-color-rgb), 0.1); color: var(--accent-color); }
        
        .mockup-group-list { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; margin-top: 1rem; }
        .mockup-group-item { padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border-main); text-align: center; font-weight: 600; font-size: 0.875rem; }
        .mockup-group-item .icon { width: 32px; height: 32px; border-radius: 50%; margin: 0 auto 0.5rem auto; display: flex; align-items: center; justify-content: center; color: white; }

        /* Testimonials */
        #testimonials-container { padding-left: 10rem; padding-right: 10rem; mask-image: linear-gradient(to right, transparent 0%, black 15%, black 85%, transparent 100%); -webkit-mask-image: linear-gradient(to right, transparent 0%, black 15%, black 85%, transparent 100%); }
        .testimonial-track { display: flex; width: calc(350px * 16); animation: scroll 80s linear infinite; padding: 1.5rem 0; }
        .testimonial-card { width: 350px; flex-shrink: 0; margin: 0 0.75rem; padding: 1.5rem; border-radius: 1rem; }
        .testimonial-track:hover { animation-play-state: paused; }
        @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        
        /* Mobile Fixes */
        @media (max-width: 767px) {
            h1 { font-size: 3rem !important; line-height: 1.1 !important; } 
            h2 { font-size: 2.25rem !important; line-height: 1.1 !important; }
            #testimonials-container { padding-left: 1rem; padding-right: 1rem; }
            .testimonial-card { width: 300px; }
            .testimonial-track { width: calc(324px * 16); }
        }

        /* Men칰 M칩vil */
        #mobile-menu-panel { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-main); z-index: 100; transform: translateX(100%); transition: transform 0.3s ease-in-out; display: flex; flex-direction: column; padding: 1.5rem; padding-top: 5rem; }
        #mobile-menu-panel.open { transform: translateX(0); }
        .mobile-nav-link { font-size: 1.5rem; font-weight: 600; padding: 0.75rem 1rem; border-radius: 0.5rem; transition: background-color 0.2s ease; }
        .mobile-nav-link:hover { background-color: rgba(120, 120, 120, 0.1); }
        .mobile-nav-link.active { color: var(--accent-purple); }

</style>
</head>
<body class="overflow-y-auto">
    <div id="page-wrapper" class="overflow-x-hidden">
        <div id="main-content">

            <header class="fixed top-0 left-0 right-0 z-[60] p-4 transition-colors duration-300">
                 <div class="container mx-auto flex justify-between items-center bg-white/30 dark:bg-black/30 backdrop-blur-md p-3 rounded-full border border-white/10 shadow-sm">
                     <a href="index.html" class="text-xl font-bold tracking-wider ml-2 flex-shrink-0">MAVERLANG</a>
                     <div class="flex items-center gap-4 lg:gap-6 mx-4">
                         <nav class="hidden md:flex items-center gap-4 lg:gap-6">
                             <a href="index.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Inicio</a> 
                             <a href="noticias.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Noticias</a> 
                             <a href="mercados.html" class="font-semibold text-sm hover:opacity-70 transition-opacity">Mercados</a> 
                             <a href="portafolioAI.html" id="nav-portafolio-ai-link" class="font-semibold text-sm transition-opacity relative"> 
                                 <span>Portafolio AI</span> <div class="particles-container"></div>
                             </a>
                             <div class="relative" id="nav-funciones-dropdown">
                                 <button id="nav-funciones-btn" class="flex items-center gap-1 font-semibold text-sm hover:opacity-70 transition-opacity">
                                     <span>Funciones</span> <i data-lucide="chevron-down" class="w-4 h-4"></i>
                                 </button>
                                 <div id="nav-funciones-menu" class="nav-dropdown-menu invisible opacity-0 scale-95">
                                     <a href="seguimiento.html" class="nav-dropdown-item"><i data-lucide="activity" class="w-4 h-4"></i><span>Seguimiento</span></a> 
                                     <a href="aprendelo.html" class="nav-dropdown-item"><i data-lucide="book-open-check" class="w-4 h-4"></i><span>Apr칠ndelo</span></a> 
                                     <a href="portafolio.html" class="nav-dropdown-item"><i data-lucide="briefcase" class="w-4 h-4"></i><span>Portafolio Virtual</span></a> 
                                     <a href="chats.html" class="nav-dropdown-item active"><i data-lucide="message-square" class="w-4 h-4"></i><span>Chats</span></a> 
                                     <a href="mercados.html" class="nav-dropdown-item"><i data-lucide="line-chart" class="w-4 h-4"></i><span>Mercados</span></a> 
                                 </div>
                             </div>
                         </nav>
                         <button id="header-whitelist-btn" class="bg-blue-600 text-white font-semibold rounded-full px-4 py-2 text-sm transition-transform hover:scale-105 animated-whitelist-btn whitespace-nowrap hidden md:block">
                             Acceso Prioritario
                         </button>
                         <div class="relative" id="theme-selector">
                             <button id="theme-main-btn" class="theme-main-btn p-1.5 rounded-full border" style="border-color: var(--border-main);"><i data-lucide="sun"></i></button>
                             <div id="theme-dropdown-menu" class="theme-dropdown-menu invisible opacity-0 scale-95 p-1 border" style="border-color: var(--border-main);">
                                  <button data-theme="light" title="Tema Claro" class="theme-dropdown-btn"><i data-lucide="sun"></i></button>
                                  <button data-theme="dark" title="Tema Oscuro" class="theme-dropdown-btn"><i data-lucide="moon"></i></button>
                             </div>
                         </div>
                         <button id="mobile-menu-btn" class="p-1.5 rounded-full border md:hidden" style="border-color: var(--border-main);">
                             <i data-lucide="menu" class="w-6 h-6"></i>
                         </button>
                     </div>
                 </div>
            </header>

            <div id="mobile-menu-panel" class="z-[55]">
                <button id="mobile-menu-close-btn" class="absolute top-7 right-7 p-2 rounded-full hover:bg-gray-500/10">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
                <nav class="flex flex-col gap-2">
                    <a href="index.html" class="mobile-nav-link">Inicio</a>
                    <a href="noticias.html" class="mobile-nav-link">Noticias</a>
                    <a href="mercados.html" class="mobile-nav-link">Mercados</a>
                    <a href="portafolioAI.html" class="mobile-nav-link">Portafolio AI</a>
                    <hr class="my-2" style="border-color: var(--border-main);" />
                    <a href="seguimiento.html" class="mobile-nav-link">Seguimiento</a>
                    <a href="aprendelo.html" class="mobile-nav-link">Apr칠ndelo</a>
                    <a href="portafolio.html" class="mobile-nav-link">Portafolio Virtual</a>
                    <a href="chats.html" class="mobile-nav-link active">Chats</a>
                </nav>
                <div class="mt-auto pt-6">
                    <button id="mobile-whitelist-btn" class="modal-trigger-btn w-full bg-blue-600 text-white font-semibold rounded-full px-6 py-4 text-lg transition-transform hover:scale-105 whitespace-nowrap">
                        Acceso Prioritario
                    </button>
                </div>
            </div>

            <main class="relative z-10">

                <section class="hero-section relative flex flex-col items-center justify-center text-center p-4 overflow-hidden">
                    <div class="background-logo-text opacity-50">CHAT</div>
                    <div class="relative z-10 pt-[18vh] container mx-auto max-w-screen-xl px-4">
                        <div class="z-10 text-center max-w-4xl mx-auto reveal">
                            <span class="font-bold uppercase tracking-wider text-base" style="color: var(--accent-color);">Inteligencia Colectiva</span>
                            <h1 class="text-6xl md:text-7xl lg:text-8xl font-extrabold tracking-tight mt-2">
                                Invierte en Comunidad.
                            </h1>
                             <h2 class="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600" style="color: var(--accent-color);">
                                Crece con Nosotros.
                             </h2>
                            <p class="mt-6 text-xl md:text-2xl opacity-80 max-w-3xl mx-auto">
                                칔nete a grupos de chat exclusivos, comparte estrategias, consulta a la IA y reacciona a los movimientos del mercado junto a otros inversores.
                            </p>
                        </div>
                        
                        <div class="mt-16 flex justify-center reveal">
                            <div class="chat-mockup-container feature-card">
                                <div class="chat-mockup-header">
                                    <div class="group-icon">AT</div>
                                    <div><h4>An치lisis T칠cnico</h4><p>4 Miembros: Juan, Mar칤a, Carlos, @T칰</p></div>
                                </div>
                                <div class="chat-mockup-messages">
                                    <!-- Mensajes generados din치micamente por JS -->
                                </div>
                                <div class="chat-mockup-input">
                                    <span>Escribe un mensaje...</span><i data-lucide="send" class="w-5 h-5 opacity-50"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="relative z-10 w-full pt-16 md:pt-24 pb-16 md:pb-24 reveal" style="background-color: rgba(var(--accent-color-rgb), 0.03);">
                    <div class="container mx-auto max-w-screen-xl px-4">
                        <div class="text-center mb-16">
                             <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">Herramientas de Colaboraci칩n</h2>
                             <p class="text-xl opacity-80 max-w-3xl mx-auto">M치s que un chat. Es tu centro de operaciones grupal.</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            
                            <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="trophy" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">Compite y Compara</h3>
                                <p class="opacity-80">Comparte tu portafolio y compite en el Ranking de Rentabilidad semanal.</p>
                                <div class="flex-grow"></div>
                                <div class="mockup-ranking-list">
                                    <div class="mockup-ranking-item"><div class="name"><span>游볞</span><span>@T칰</span></div><div class="perf" style="color: var(--success-color);">+15.2%</div></div>
                                    <div class="mockup-ranking-item"><div class="name"><span>游볟</span><span>@Juan</span></div><div class="perf" style="color: var(--success-color);">+11.8%</div></div>
                                </div>
                            </div>

                            <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="at-sign" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">Comunicaci칩n Fluida</h3>
                                <p class="opacity-80">Menciona (@) miembros y reacciona con emojis a los mensajes.</p>
                                <div class="flex-grow"></div>
                                <div class="flex gap-4">
                                    <div class="w-1/2"><div class="mockup-mention-list"><div class="mockup-mention-item active">@Juan</div><div class="mockup-mention-item">@Mar칤a</div></div></div>
                                    <div class="w-1/2"><div class="flex flex-wrap gap-2 mt-3"><span class="reaction-chip text-lg p-2">游녨</span><span class="reaction-chip text-lg p-2">游댠</span><span class="reaction-chip text-lg p-2">游</span></div></div>
                                </div>
                            </div>
                            
                            <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="brain-circuit" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">IA Integrada</h3>
                                <p class="opacity-80">Llama a la IA con <span class="mention is-ai">@IA</span> para datos r치pidos sin salir del chat.</p>
                                <div class="flex-grow"></div>
                                <div class="p-4 rounded-lg border" style="border-color: var(--border-main); background-color: var(--bg-main); margin-top: 1rem;">
                                    <p class="text-sm font-semibold">T칰: <span class="mention is-ai">@IA</span> 쯉oporte de $BTC?</p>
                                    <p class="text-sm opacity-80 mt-2"><strong style="color: var(--accent-blue);">IA:</strong> El soporte clave est치 en $58,500.</p>
                                </div>
                            </div>

                             <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="users" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">Grupos Privados</h3>
                                <p class="opacity-80">Crea grupos por invitaci칩n o 칰nete a canales p칰blicos tem치ticos.</p>
                                <div class="flex-grow"></div>
                                <div class="mockup-group-list">
                                    <div class="mockup-group-item"><div class="icon" style="background-color: #ef4444;"><i data-lucide="lock" class="w-5 h-5"></i></div>Amigos</div>
                                    <div class="mockup-group-item"><div class="icon" style="background-color: #f59e0b;"><i data-lucide="bitcoin" class="w-5 h-5"></i></div>Cripto</div>
                                </div>
                            </div>

                            <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="link" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">Todo Conectado</h3>
                                <p class="opacity-80">Comparte an치lisis de Sentinel o gr치ficos directamente en la conversaci칩n.</p>
                                <div class="flex-grow"></div>
                                <div class="p-4 rounded-lg border" style="border-color: var(--border-main); background-color: var(--bg-main); margin-top: 1rem;">
                                    <p class="text-sm font-semibold text-red-500">ALERTA SENTINEL</p>
                                    <p class="text-sm font-semibold mt-1">Impacto Negativo en $MSFT.</p>
                                </div>
                            </div>
                            
                            <div class="feature-card feature-grid-card">
                                <div class="icon"><i data-lucide="message-square-reply" class="w-7 h-7"></i></div>
                                <h3 class="text-2xl font-bold">Hilos</h3>
                                <p class="opacity-80">Responde en hilos para mantener el orden en debates profundos.</p>
                                <div class="flex-grow"></div>
                                <div class="p-3 rounded-lg border mt-4" style="border-color: var(--border-main);"><p class="text-sm opacity-70">3 respuestas en el hilo...</p></div>
                            </div>

                        </div>
                    </div>
                </section>

                <!-- Secci칩n de Testimonios -->
                <section id="social-proof" class="relative z-10 w-full pt-8 md:pt-12 pb-8 md:pb-12 overflow-hidden reveal" style="background-color: rgba(var(--accent-color-rgb), 0.03);">
                       <div class="container mx-auto max-w-screen-xl px-4">
                         <div class="text-center mb-16 max-w-3xl mx-auto">
                             <h2 class="text-4xl md:text-5xl font-bold tracking-tight mt-2 mb-4">Invierte Solo. Analiza en Conjunto.</h2>
                             <p class="text-lg opacity-80">As칤 es como nuestros miembros beta est치n usando los Chats.</p>
                         </div>
                     </div>
                     <div id="testimonials-container" class="relative w-full overflow-hidden">
                         <div class="testimonial-track flex">
                             <div class="testimonial-card">
                                 <div class="flex items-center mb-3"><img src="https://placehold.co/48x48/6366f1/white?text=JS" class="avatar mr-3"><div><h4>Juan S.</h4><p class="title">Trader</p></div></div>
                                 <p class="quote">"Validar mi tesis sobre $TSLA en el grupo 'Acciones USA' me dio una perspectiva nueva."</p>
                             </div>
                             <div class="testimonial-card">
                                 <div class="flex items-center mb-3"><img src="https://placehold.co/48x48/ec4899/white?text=MF" class="avatar mr-3"><div><h4>Maria F.</h4><p class="title">Principiante</p></div></div>
                                 <p class="quote">"Estar en el grupo 'Principiantes Chile' me ayud칩 a aprender 10x m치s r치pido."</p>
                             </div>
                              <div class="testimonial-card">
                                 <div class="flex items-center mb-3"><img src="https://placehold.co/48x48/f59e0b/white?text=RC" class="avatar mr-3"><div><h4>Ricardo C.</h4><p class="title">Cripto</p></div></div>
                                 <p class="quote">"El ranking semanal es mi motivaci칩n. La competencia es amistosa y muy educativa."</p>
                             </div>
                              <div class="testimonial-card">
                                 <div class="flex items-center mb-3"><img src="https://placehold.co/48x48/10b981/white?text=LV" class="avatar mr-3"><div><h4>Laura V.</h4><p class="title">Analista</p></div></div>
                                 <p class="quote">"Compartir an치lisis de Sentinel en el chat ahorra tiempo y genera debate real."</p>
                             </div>
                             <!-- Duplicados -->
                             <div class="testimonial-card">
                                 <div class="flex items-center mb-3"><img src="https://placehold.co/48x48/6366f1/white?text=JS" class="avatar mr-3"><div><h4>Juan S.</h4><p class="title">Trader</p></div></div>
                                 <p class="quote">"Validar mi tesis sobre $TSLA en el grupo 'Acciones USA' me dio una perspectiva nueva."</p>
                             </div>
                         </div>
                     </div>
                 </section>

                 <section id="final-cta" class="relative z-10 w-full pt-16 md:pt-24 pb-20 md:pb-32 text-center reveal">
                    <div class="container mx-auto max-w-3xl px-4">
                        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">Construye tu Red de Inversi칩n</h2>
                        <p class="mt-4 text-lg md:text-xl opacity-80">No vuelvas a tomar una decisi칩n a ciegas. 칔nete a la lista de acceso prioritario.</p>
                        <button id="footer-whitelist-btn" class="modal-trigger-btn mt-10 text-white font-semibold rounded-full px-8 py-4 text-lg transition-transform hover:scale-105 animated-whitelist-btn whitespace-nowrap">Unirse a los Chats</button>
                    </div>
                </section>

            </main>

            <footer class="relative z-10 w-full border-t" style="border-color: var(--border-main); background-color: var(--bg-main);">
                <div class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16">
                    <div class="mb-12 text-center md:text-left">
                        <div class="text-xl font-bold tracking-wider inline-block">MAVERLANG</div>
                        <p class="mt-2 text-md opacity-80 max-w-lg mx-auto md:mx-0">Potenciando decisiones financieras con inteligencia artificial avanzada.</p>
                    </div>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-8 mb-12">
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Navegaci칩n</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="index.html" class="text-sm opacity-70 hover:opacity-100 hover:text-blue-500 transition-all">Inicio</a>
                                <a href="noticias.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Noticias</a>
                                <a href="mercados.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Mercados</a>
                                <a href="aprendelo.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Apr칠ndelo</a>
                            </nav>
                        </div>
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Plataforma</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="portafolioAI.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio AI</a>
                                <a href="seguimiento.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Seguimiento</a>
                                <a href="portafolio.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Portafolio Virtual</a>
                                <a href="chats.html" class="text-sm opacity-70 hover:opacity-100 transition-all">Chats</a>
                            </nav>
                        </div>
                         <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Compa침칤a</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Sobre Nosotros</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Blog</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Contacto</a>
                            </nav>
                        </div>
                        <div>
                            <h3 class="font-semibold uppercase tracking-wider text-sm mb-4">Legal</h3>
                            <nav class="flex flex-col gap-3">
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">T칠rminos de Servicio</a>
                                <a href="#" class="text-sm opacity-70 hover:opacity-100 transition-all">Pol칤tica de Privacidad</a>
                            </nav>
                        </div>
                    </div>
                    <div class="border-t pt-8 flex flex-col md:flex-row justify-between items-center gap-6" style="border-color: var(--border-main);">
                        <p class="text-sm opacity-70 text-center md:text-left">&copy; 2025 Maverlang. Todos los derechos reservados.</p>
                         <div class="flex gap-6">
                            <a href="#" class="opacity-70 hover:opacity-100 hover:text-blue-500 transition-all"><i data-lucide="linkedin" class="w-6 h-6"></i></a>
                            <a href="#" class="opacity-70 hover:opacity-100 hover:text-pink-500 transition-all"><i data-lucide="instagram" class="w-6 h-6"></i></a>
                            <a href="#" class="opacity-70 hover:opacity-100 transition-all"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 16 16"><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.06l3.51 4.639L12.6.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/></svg></a>
                            <a href="#" class="opacity-70 hover:opacity-100 hover:text-blue-600 transition-all"><i data-lucide="facebook" class="w-6 h-6"></i></a>
                        </div>
                    </div>
                </div>
            </footer>

        </div>
    </div>

    <!-- Modal de Whitelist -->
    <div id="whitelist-modal" class="fixed inset-0 bg-black/60 z-[101] flex items-center justify-center p-4 opacity-0 invisible">
        <div class="modal-content w-full max-w-md rounded-2xl p-8 text-center scale-95">
            <button id="close-modal-btn" class="absolute top-4 right-4 p-2 rounded-full hover:bg-gray-500/10"><i data-lucide="x"></i></button>
            <i data-lucide="rocket" class="w-12 h-12 mx-auto text-blue-500 mb-4"></i>
            <h2 class="text-2xl font-bold">칔nete al Acceso Prioritario</h2>
            <p class="mt-2 text-main/70">S칠 el primero en saber cu치ndo lanzamos y obt칠n un <span class="font-bold text-blue-500">20% de descuento</span>.</p>
            <!-- CONTADOR DE ANALISTAS ELIMINADO -->
            <div id="modal-countdown-container" class="flex items-center justify-center gap-3 md:gap-4 my-6">
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-days" class="countdown-number">00</span><span class="countdown-label">D칤as</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-hours" class="countdown-number">00</span><span class="countdown-label">Horas</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-minutes" class="countdown-number">00</span><span class="countdown-label">Minutos</span></div>
                <div class="countdown-box w-20 h-20 flex flex-col items-center justify-center"><span id="modal-seconds" class="countdown-number">00</span><span class="countdown-label">Segundos</span></div>
            </div>
            <form id="whitelist-form-modal">
                <div class="flex items-center p-2 rounded-full border" style="border-color: var(--border-main);"><input type="email" id="email-input-modal" placeholder="Tu correo electr칩nico" required class="w-full bg-transparent px-4 py-2 text-main placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none"><button type="submit" id="submit-btn-modal" class="bg-blue-600 text-white font-semibold px-6 py-2 rounded-full flex-shrink-0 hover:bg-blue-700 transition-colors" disabled>Iniciando...</button></div>
                <p id="form-message-modal" class="mt-3 text-sm h-5"></p>
            </form>
        </div>
    </div>
    
    <!-- Toast de Notificaci칩n -->
    <div id="toast-notification"><i data-lucide="info" class="w-5 h-5 text-blue-500"></i><span id="toast-message">Mensaje</span></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        let db, auth;
        let userId = null;
        let isAuthReady = false;
        let whitelistCol;
        let isClickOutsideListenerAdded = false;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');

        // --- Funciones del Modal ---
        const openModal = (e) => {
            if (e && e.preventDefault) e.preventDefault();
            if (e && e.currentTarget && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') return;
            const modal = document.getElementById('whitelist-modal');
            if (!modal || !modal.classList.contains('invisible')) return;
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.remove('invisible', 'opacity-0');
            modalContent.classList.remove('scale-95');
        };
        const closeModal = () => {
             const modal = document.getElementById('whitelist-modal');
            if (!modal) return;
            const modalContent = modal.querySelector('.modal-content');
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => modal.classList.add('invisible'), 300);
        };
        
        // --- Inicializaci칩n ---
        async function initApp() {
            if (typeof lucide !== 'undefined') { lucide.createIcons(); }
            else { setTimeout(initApp, 100); return; }

            initTheme();
            await initFirebase();
            initWhitelistModal();
            initWhitelistForms();
            initCountdown();
            initHeaderScrollBehavior();
            initNavigation();
            generateParticlesSlow();
            initMobileMenu();
            
            // Nuevas funciones
            initScrollReveal();
            // initDeepLinking(); // Removed if unused
            // initAprendeloTabs(); // Removed duplicate call
            initChallengePathInteraction();
            initChatMockupAnimation();
            
            // Removed listener call for whitelist count
        }

        // --- Firebase ---
        async function initFirebase() {
             if (!firebaseConfig.apiKey || firebaseConfig.apiKey === "TU_API_KEY") { isAuthReady = false; return; }
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app); auth = getAuth(app); setLogLevel('debug');
                // CORRECCI칍N: Ruta de colecci칩n estricta
                whitelistCol = collection(db, 'artifacts', appId, 'public', 'data', 'whitelist');
                await new Promise((resolve, reject) => {
                    const unsubscribe = onAuthStateChanged(auth, async (user) => {
                        unsubscribe();
                        if (user) { userId = user.uid; isAuthReady = true; updateWhitelistButton(true); resolve(); }
                        else {
                            try {
                                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) { await signInWithCustomToken(auth, __initial_auth_token); } else { await signInAnonymously(auth); }
                                if (auth.currentUser) { userId = auth.currentUser.uid; isAuthReady = true; updateWhitelistButton(true); resolve(); } else { isAuthReady = false; updateWhitelistButton(false); reject(new Error("Fallo en auth silenciosa.")); }
                            } catch (authError) { isAuthReady = false; updateWhitelistButton(false); reject(authError); }
                        }
                    }, (error) => { isAuthReady = false; updateWhitelistButton(false); reject(error); });
                });
            } catch (e) { isAuthReady = false; updateWhitelistButton(false); }
        }
        
        function updateWhitelistButton(ready) {
            const btn = document.getElementById('submit-btn-modal');
            if(btn) { btn.disabled = !ready; btn.textContent = ready ? "Anotarme" : "Conectando..."; if(ready) btn.classList.remove('opacity-50', 'cursor-not-allowed'); }
        }

        // --- Temas ---
        function initTheme() {
            const themeMainBtn = document.getElementById('theme-main-btn');
            const themeDropdownMenu = document.getElementById('theme-dropdown-menu');
            const themeDropdownBtns = themeDropdownMenu ? themeDropdownMenu.querySelectorAll('.theme-dropdown-btn') : [];
            if (!themeMainBtn || !themeDropdownMenu) return;
            const currentTheme = localStorage.getItem('maverlang_theme') || 'light';
            applyTheme(currentTheme, true); 
            themeMainBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const isVisible = !themeDropdownMenu.classList.contains('invisible');
                document.querySelectorAll('.nav-dropdown-menu').forEach(m => m?.classList.add('opacity-0', 'scale-95', 'invisible'));
                if (isVisible) { themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible'); }
                else { themeDropdownMenu.classList.remove('opacity-0', 'scale-95', 'invisible'); }
            });
            themeDropdownBtns.forEach(btn => {
                btn.addEventListener('click', () => { applyTheme(btn.dataset.theme); themeDropdownMenu.classList.add('opacity-0', 'scale-95', 'invisible'); });
            });
        }

        function applyTheme(theme, isInitialLoad = false) {
             const html = document.documentElement;
            const themeMainBtn = document.getElementById('theme-main-btn');
            let iconName = 'sun';
            html.classList.remove('dark');
            if (theme === 'dark') { html.classList.add('dark'); iconName = 'moon'; }
            
            if (!isInitialLoad) localStorage.setItem('maverlang_theme', theme);
            if (themeMainBtn) { themeMainBtn.innerHTML = `<i data-lucide="${iconName}"></i>`; if (typeof lucide !== 'undefined') lucide.createIcons(); }
            document.querySelectorAll('.theme-dropdown-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.theme-dropdown-btn[data-theme="${theme}"]`)?.classList.add('active');
            updateHeaderBackground();
        }

        // --- Scroll Reveal ---
        function initScrollReveal() {
            const reveals = document.querySelectorAll('.reveal');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            
            document.querySelector('#aprendelo-tabs-nav')?.classList.add('reveal');
            document.querySelector('#aprendelo-main-content')?.classList.add('reveal');
            document.querySelector('#final-cta')?.classList.add('reveal');

            reveals.forEach(r => observer.observe(r));
            document.querySelectorAll('.reveal').forEach(r => observer.observe(r));
        }
        

        // --- Interactividad Mockups ---
        function initChallengePathInteraction() {
            const nodes = document.querySelectorAll('.level-node-mockup');
            const toast = document.getElementById('toast-notification');
            let toastMsg = toast ? toast.querySelector('#toast-message') : document.getElementById('toast-message');
            
            if (!toastMsg && toast) {
                 const span = document.createElement('span');
                 span.id = 'toast-message';
                 toast.appendChild(span);
                 toastMsg = span;
            }

            let toastTimeout;

            nodes.forEach(node => {
                node.addEventListener('click', () => {
                    const status = node.dataset.status;
                    const levelName = node.dataset.level || "Nivel";
                    
                    if (toastMsg) {
                         toastMsg.textContent = `${levelName} - ${status}`;
                         toast.classList.add('visible');
                         
                         if (toastTimeout) clearTimeout(toastTimeout);
                         toastTimeout = setTimeout(() => {
                             toast.classList.remove('visible');
                         }, 3000);
                    }
                });
            });
        }
        
        // --- Men칰 M칩vil ---
        function initMobileMenu() {
            const menuBtn = document.getElementById('mobile-menu-btn');
            const panel = document.getElementById('mobile-menu-panel');
            let closeBtn = document.getElementById('mobile-menu-close-btn');
            
            if (!closeBtn && panel) {
                closeBtn = document.createElement('button');
                closeBtn.innerHTML = '<i data-lucide="x" class="w-8 h-8"></i>';
                closeBtn.className = "absolute top-6 right-6 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800";
                panel.prepend(closeBtn);
                lucide.createIcons();
            }
            
            if (!menuBtn || !panel) return;

            const toggleMenu = (show) => {
                if (show) {
                    panel.classList.remove('hidden');
                    setTimeout(() => panel.classList.add('open'), 10);
                    document.body.classList.add('no-scroll');
                } else {
                    panel.classList.remove('open');
                    setTimeout(() => panel.classList.add('hidden'), 300);
                    document.body.classList.remove('no-scroll');
                }
            };

            menuBtn.addEventListener('click', () => toggleMenu(true));
            if (closeBtn) closeBtn.addEventListener('click', () => toggleMenu(false));
            
            panel.querySelectorAll('a, button').forEach(el => {
                el.addEventListener('click', () => toggleMenu(false));
            });
        }
        
        // --- Utilidades Generales ---
        function updateHeaderBackground() { 
            const header = document.querySelector('header'); if (!header) return; 
            const headerContent = header.firstElementChild; if (!headerContent) return; 
            const threshold = 50; 
            const scrolled = window.scrollY > threshold; 
            const isDark = document.documentElement.classList.contains('dark'); 
            const bgColor = scrolled ? (isDark ? 'rgba(10,10,10,0.8)' : 'rgba(255,255,255,0.8)') : (isDark ? 'rgba(0,0,0,0.3)' : 'rgba(255,255,255,0.3)'); 
            headerContent.style.backgroundColor = bgColor; 
        }
        function initHeaderScrollBehavior() { window.addEventListener('scroll', updateHeaderBackground, { passive: true }); updateHeaderBackground(); }
        function initNavigation() { 
            const funcionesBtn = document.getElementById('nav-funciones-btn');
            const funcionesMenu = document.getElementById('nav-funciones-menu');

            if (funcionesBtn && funcionesMenu) {
                const toggleFuncionesDropdown = (e) => {
                    e.stopPropagation();
                    const isVisible = !funcionesMenu.classList.contains('invisible');
                    if (isVisible) {
                        funcionesMenu.classList.add('opacity-0', 'scale-95', 'invisible');
                    } else {
                        document.getElementById('theme-dropdown-menu')?.classList.add('opacity-0', 'scale-95', 'invisible');
                        document.getElementById('mobile-menu-panel')?.classList.remove('open'); 
                        funcionesMenu.classList.remove('opacity-0', 'scale-95', 'invisible');
                    }
                };
                 if (funcionesBtn.dataset.navListenerAttached !== 'true') {
                     funcionesBtn.addEventListener('click', toggleFuncionesDropdown);
                     funcionesBtn.dataset.navListenerAttached = 'true';
                 }
            }
            
             if (!isClickOutsideListenerAdded) {
                document.addEventListener('click', (e) => {
                    const themeDropdown = document.getElementById('theme-dropdown-menu');
                    const themeButton = document.getElementById('theme-main-btn');
                    const funcionesDropdown = document.getElementById('nav-funciones-menu');
                    const funcionesButton = document.getElementById('nav-funciones-btn');

                    if (themeDropdown && !themeDropdown.classList.contains('invisible') && themeButton && !themeButton.contains(e.target) && !themeDropdown.contains(e.target)) {
                        themeDropdown.classList.add('opacity-0', 'scale-95', 'invisible');
                    }
                     if (funcionesDropdown && !funcionesDropdown.classList.contains('invisible') && funcionesButton && !funcionesButton.contains(e.target) && !funcionesDropdown.contains(e.target)) {
                        funcionesDropdown.classList.add('opacity-0', 'scale-95', 'invisible');
                    }
                });
                isClickOutsideListenerAdded = true;
            }
        }
        
        function generateParticlesSlow() { const container = document.querySelector('#nav-portafolio-ai-link .particles-container'); if (!container) return; const particleCount = 6; const colors = ['var(--particle-color-1)', 'var(--particle-color-2)', 'var(--particle-color-3)']; const totalDuration = 5; const particleAnimationDuration = 2.5; container.innerHTML = ''; for (let i = 0; i < particleCount; i++) { const particle = document.createElement('div'); particle.classList.add('particle'); const baseStartPercentage = 0.45; const randomOffsetPercentage = Math.random() * 0.1; const startDelay = (baseStartPercentage + randomOffsetPercentage); particle.style.setProperty('--particle-delay', startDelay.toFixed(2)); particle.style.setProperty('--particle-x', `${Math.random() * 30 - 15}px`); particle.style.setProperty('--particle-y', `${Math.random() * -5 - 3}px`); particle.style.setProperty('--particle-color', colors[Math.floor(Math.random() * colors.length)]); particle.style.animationDuration = `${particleAnimationDuration}s`; particle.style.animationDelay = `${startDelay * totalDuration}s`; container.appendChild(particle); } }
        function initWhitelistModal() {
             const modal = document.getElementById('whitelist-modal'); if (!modal) return;
             const closeModalBtn = document.getElementById('close-modal-btn');
             const triggerButtons = document.querySelectorAll('#header-whitelist-btn, .animated-whitelist-btn, .modal-trigger-btn, #mobile-whitelist-btn');
             triggerButtons.forEach(btn => { 
                if (btn.dataset.modalListenerAttached !== 'true') { 
                    btn.addEventListener('click', (e) => {
                        if (e.currentTarget.tagName === 'A' && e.currentTarget.href && !e.currentTarget.href.endsWith('#') && e.currentTarget.target !== '_blank') return;
                        openModal(e);
                    }); 
                    btn.dataset.modalListenerAttached = 'true'; 
                } 
             });
             if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
             if (modal) modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
        }
        
        function initWhitelistForms() { const f = document.getElementById('whitelist-form-modal'); if(f) f.addEventListener('submit', handleWhitelistSubmit); }

        async function handleWhitelistSubmit(e) {
             e.preventDefault(); if (!db || !isAuthReady) return;
             const emailInput = document.getElementById('email-input-modal');
             const submitBtn = document.getElementById('submit-btn-modal');
             if (!emailInput) return;
             const email = emailInput.value;
             
             const originalBtnText = submitBtn ? submitBtn.textContent : 'Anotarme';
             if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Enviando...'; }
             
             const messageEl = document.getElementById('form-message-modal');
             if(messageEl) messageEl.textContent = '';

             try {
                 const q = query(whitelistCol, where("email", "==", email)); 
                 const querySnapshot = await getDocs(q); 
                 if (!querySnapshot.empty) { throw new Error('Correo ya registrado.'); }
                 
                 await addDoc(whitelistCol, { email: email, timestamp: serverTimestamp(), source: 'chats' }); 
                 
                 if(messageEl) {
                     messageEl.textContent = '춰Gracias! Est치s en la lista.';
                     messageEl.style.color = 'var(--success-color)';
                 }
                 emailInput.value = ''; 
                 setTimeout(closeModal, 2000);
             } catch (err) { 
                 console.error(err);
                 if(messageEl) {
                     messageEl.textContent = err.message || 'Error al registrar.';
                     messageEl.style.color = 'var(--accent-red)';
                 }
             } finally {
                 if (submitBtn) {
                     submitBtn.disabled = false;
                     submitBtn.textContent = originalBtnText;
                 }
             }
        }

        // --- Countdown (10 Dic 2025) ---
        function initCountdown() {
            const targetDate = new Date('2025-12-10T00:00:00').getTime();
            const ids = ['modal']; const labels = ['days', 'hours', 'minutes', 'seconds']; const elements = {};
            ids.forEach(id => { elements[id] = {}; labels.forEach(l => elements[id][l] = document.getElementById(`${id}-${l}`)); });
            const interval = setInterval(() => {
                const distance = targetDate - new Date().getTime(); if (distance < 0) { clearInterval(interval); return; }
                const d=Math.floor(distance/864e5), h=Math.floor((distance%864e5)/36e5), m=Math.floor((distance%36e5)/6e4), s=Math.floor((distance%6e4)/1000);
                const times = { days: d, hours: h, minutes: m, seconds: s };
                ids.forEach(id => { labels.forEach(l => { if(elements[id] && elements[id][l]) elements[id][l].textContent = String(times[l]).padStart(2, '0'); }); });
            }, 1000);
        }
        
        // --- Chat Mockup Animation (NUEVO & M츼S R츼PIDO) ---
        function initChatMockupAnimation() {
            const container = document.querySelector('.chat-mockup-messages');
            if (!container) return;
            
            const messages = [
                { type: 'other', name: 'Mar칤a', avatar: 'M', avatarColor: '#d946ef', text: 'Ojo con <span class="mention">$NVDA</span>, el an치lisis de Sentinel me marc칩 "Positivo" por la noticia de Blackwell.', reaction: '游댠 1' },
                { type: 'me', name: 'T칰', avatar: 'T', avatarColor: '#3b82f6', text: '<span class="mention">@Mar칤a</span>, buena vista. Acabo de compartir mi portafolio "Tech". Miren el %.', share: { title: 'Portafolio "Tech"', desc: 'Compartido por @T칰' } },
                { type: 'other', name: 'Juan', avatar: 'J', avatarColor: '#f59e0b', text: 'Wow, tu portafolio va +15% en 7 d칤as. 游볞<br>Oigan, <span class="mention is-ai">@IA</span> 쮺u치l es el soporte clave para $BTC?' },
                { type: 'other', name: 'IA de Maverlang', avatar: '<i data-lucide="brain-circuit" class="w-5 h-5"></i>', avatarClass: 'is-ai', text: 'El soporte clave para $BTC est치 en <span class="mention">$58,500</span>. Se observa debilidad en el volumen de compra.' }
            ];
            
            container.innerHTML = ''; // Limpiar

            // Reducidos tiempos en un 25% aprox
            let delay = 375; 
            
            messages.forEach((msg, index) => {
                // Crear elementos
                const bubble = document.createElement('div');
                bubble.className = `message-bubble is-${msg.type}`;
                
                // Avatar
                const avatar = document.createElement('div');
                avatar.className = `avatar ${msg.avatarClass || ''}`;
                avatar.style.backgroundColor = msg.avatarClass ? '' : msg.avatarColor;
                avatar.innerHTML = msg.avatar;
                
                // Content Wrapper
                const mainContent = document.createElement('div');
                mainContent.className = 'message-main-content';
                
                // Name
                const name = document.createElement('p');
                name.className = 'sender-name';
                if(msg.type === 'me' || msg.avatarClass === 'is-ai') name.style.color = 'var(--accent-blue)';
                name.textContent = msg.name;
                
                // Text Content
                const textDiv = document.createElement('div');
                textDiv.className = 'content';
                if(msg.text) textDiv.innerHTML = `<p>${msg.text}</p>`;
                
                // Portfolio Share (si existe)
                if (msg.share) {
                    const shareDiv = document.createElement('div');
                    shareDiv.className = 'portfolio-share';
                    shareDiv.innerHTML = `<div class="icon"><i data-lucide="briefcase" class="w-5 h-5"></i></div><div class="text"><h5>${msg.share.title}</h5><p>${msg.share.desc}</p></div>`;
                    textDiv.appendChild(shareDiv);
                }

                mainContent.appendChild(name);
                mainContent.appendChild(textDiv);
                
                // Reaction (si existe)
                let reactionDiv;
                if (msg.reaction) {
                    reactionDiv = document.createElement('div');
                    reactionDiv.className = 'reactions-container';
                    reactionDiv.innerHTML = `<div class="reaction-chip">${msg.reaction}</div>`;
                    mainContent.appendChild(reactionDiv);
                }

                bubble.appendChild(avatar);
                bubble.appendChild(mainContent);
                container.appendChild(bubble);
                
                if (typeof lucide !== 'undefined') lucide.createIcons();
                
                // Animaci칩n de aparici칩n
                setTimeout(() => {
                    bubble.style.opacity = '1';
                    bubble.style.transform = 'translateY(0)';
                    
                    if (reactionDiv) {
                        let reactionDelay = 750; // Reducido de 1000
                        setTimeout(() => {
                            reactionDiv.style.opacity = '1';
                            reactionDiv.style.transform = 'translateY(0)';
                        }, reactionDelay);
                    }
                }, delay);

                // Tiempos de espera para el siguiente mensaje (Reducidos ~25%)
                if (index === 0) delay += 1875; // Antes 2500
                else if (index === 1) delay += 1500; // Antes 2000
                else if (index === 2) delay += 1125; // Antes 1500
                else delay += 2250; // Antes 3000
            });
        }


        // Funciones vac칤as de placeholder
        function initTypingAnimation() { /* No aplica aqu칤 */ }
        function initChatInputBehavior() { /* No aplica aqu칤 */ }
        function initFauxChatAndLLM() { /* No aplica aqu칤 */ }
        function initAprendeloTabs() {}

        // Iniciar la aplicaci칩n
        initApp();
    </script>

</body>
</html>
